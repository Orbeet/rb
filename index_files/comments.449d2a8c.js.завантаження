(()=>{"use strict";var __webpack_modules__={99715:(e,t,i)=>{i.d(t,{Icon24CheckCircleOff:()=>o});var o=(0,i(28178).makeIcon)("Icon24CheckCircleOff","check_circle_off_24","0 0 24 24",'<symbol xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" id="check_circle_off_24"><path fill="currentColor" d="M12 0c6.629 0 12 5.373 12 12 0 6.629-5.373 12-12 12-6.629 0-12-5.373-12-12C0 5.371 5.373 0 12 0m0 1.5C6.2 1.5 1.5 6.2 1.5 12S6.2 22.5 12 22.5 22.5 17.8 22.5 12 17.8 1.5 12 1.5" /></symbol>',24,24,!1,void 0)},90839:(e,t,i)=>{i.d(t,{Icon24CheckCircleOn:()=>o});var o=(0,i(28178).makeIcon)("Icon24CheckCircleOn","check_circle_on_24","0 0 24 24",'<symbol xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" id="check_circle_on_24"><path fill="currentColor" fill-rule="evenodd" d="M12 24c6.627 0 12-5.373 12-12S18.627 0 12 0 0 5.373 0 12s5.373 12 12 12m6.207-14.793a1 1 0 0 0-1.414-1.414L10 14.586l-2.793-2.793a1 1 0 0 0-1.414 1.414l3.5 3.5a1 1 0 0 0 1.414 0z" clip-rule="evenodd" /></symbol>',24,24,!1,void 0)},11099:(e,t,i)=>{Object.defineProperty(t,"classNames",{enumerable:!0,get:function(){return _}});var o=i(74185);function _(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];var _=[];return t.forEach((function(e){if(e)switch(void 0===e?"undefined":o._(e)){case"string":_.push(e);break;case"object":Object.keys(e).forEach((function(t){e[t]&&_.push(t)}));break;default:_.push("".concat(e))}})),_.join(" ")}},28807:(e,t,i)=>{i.d(t,{default:()=>o});const o={cell:"MenuSettings-module__cell--bJQy4",beforeIcon:"MenuSettings-module__beforeIcon--SmnKX"}},41547:(e,t,i)=>{i.d(t,{BaseSexEnumNames:()=>o});const o={UNKNOWN:0,FEMALE:1,MALE:2}},85566:(e,t,i)=>{i.d(t,{FriendsFriendStatusStatusEnumNames:()=>o});const o={NOT_A_FRIEND:0,OUTCOMING_REQUEST:1,INCOMING_REQUEST:2,IS_FRIEND:3}},74838:(e,t,i)=>{function o(){return{icon:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16"><path fill="#fff" d="m6.55 5.05 4.77 2.64a.35.35 0 0 1 0 .62l-4.77 2.64a.37.37 0 0 1-.5-.13.34.34 0 0 1-.05-.17v-5.3A.36.36 0 0 1 6.37 5c.06 0 .12.02.18.05Z"/></svg>',name:"play_marusia_foreground_16"}}i.d(t,{getIcon16PlayMarusiaForeground:()=>o})},18384:(e,t,i)=>{function o(){return{icon:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16"><path fill="#fff" d="M5 7.4c0-.84 0-1.26.16-1.58a1.5 1.5 0 0 1 .66-.66C6.14 5 6.56 5 7.4 5h1.2c.84 0 1.26 0 1.58.16a1.5 1.5 0 0 1 .66.66c.16.32.16.74.16 1.58v1.2c0 .84 0 1.26-.16 1.58a1.5 1.5 0 0 1-.66.66c-.32.16-.74.16-1.58.16H7.4c-.84 0-1.26 0-1.58-.16a1.5 1.5 0 0 1-.66-.66C5 9.86 5 9.44 5 8.6V7.4Z"/></svg>',name:"stop_marusia_foreground_16"}}i.d(t,{getIcon16StopMarusiaForeground:()=>o})},1435:(e,t,i)=>{i.d(t,{SITPOSTING_APP_ID:()=>o});const o=7644481},36656:(e,t,i)=>{function o(e,t,i,o){const _=t?"article.php":"al_articles.php";ajax.post(_,{act:"tts",article_owner_id:e.owner_id,article_id:e.id,hash:e.tts_hash,support_streaming:i?1:0},{onDone:e=>{o(e)}})}i.d(t,{loadArticle:()=>o})},26511:(e,t,i)=>{i(59397),i(12941),i(57030)},34322:(e,t,i)=>{i.d(t,{ArticleTts:()=>c});var o=i(410),_=i(57935),s=i(92594),r=i(11147),a=i(47299),n=i(41780),l=i(45722),d=i(36656);class c{static load(e,t,i,o){this.loadingArticleRawId=e.raw_id,(0,d.loadArticle)(e,t,i,(e=>{this.loadingArticleRawId=null,o(e)}))}static getAudio(e,t,i){const o=[],s=JSON.stringify({articleTts:!0,articleId:e,articleOwnerId:t,externalStream:!0});return o[_.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_ID]=`${t}${e}`,o[_.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_OWNER_ID]=t,o[_.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_URL]=i.url,o[_.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_TITLE]=i.title,o[_.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_PERFORMER]=i.artist,o[_.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_DURATION]=i.duration,o[_.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_AUTHOR_LINK]="",o[_.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_LYRICS]=0,o[_.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_FLAGS]=0,o[_.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_CONTEXT]="",o[_.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_EXTRA]=s,o[_.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_HASHES]="",o[_.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_COVER_URL]="",o[_.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_ADS]={},o[_.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_SUBTITLE]="",o[_.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_MAIN_ARTISTS]="",o[_.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_FEAT_ARTISTS]="",o[_.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_ALBUM]=!1,o[_.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_TRACK_CODE]="",o[_.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_RESTRICTION]=0,o[_.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_ALBUM_PART]=0,o[_.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_ACCESS_KEY]="",o[_.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_CHART_INFO_INDEX]=!1,o}static play(e,t,i,_){this.onArticleTtsExpire=_,this.statsHandlersInitialized||(this._audioPlayer().subscribe(r.AudioPlayerEventType.PLAY,(()=>{if(this.isAnyArticleInPlayer()){const e=this._audioPlayer().getCurrentProgress()>0?o.ArticleTtsActionType.CONTINUE:o.ArticleTtsActionType.START;this.sendStats(e)}})),this._audioPlayer().subscribe(r.AudioPlayerEventType.PAUSE,(()=>{this.isAnyArticleInPlayer()&&this.sendStats(o.ArticleTtsActionType.PAUSE)})),this._audioPlayer().subscribe(r.AudioPlayerEventType.ENDED,(()=>{if(this.isAnyArticleInPlayer()){var e,t,i;let _=this._audioPlayer();if((null==(e=_._impl)?void 0:e._hlsError)||(null==(i=_._impl)||null==(t=i._currentAudioEl)?void 0:t.error)){_._impl&&(_._impl._hlsError=void 0);const e=(0,l.getAudioExtra)(_.getCurrentAudio());_.deleteCurrentPlaylist(),c.retryCount<3&&(c.retryCount+=1,setTimeout((()=>{var t;null==(t=this.onArticleTtsExpire)||t.call(this,e)}),c.RETRY_TIMEOUT))}this.sendStats(o.ArticleTtsActionType.P100)}})),this.statsHandlersInitialized=!0);const s=this.getAudio(e,t,i),a=this._audioPlayer().getPlaylist(n.AudioPlaylist.TYPE_ARTICLE_TTS,t,e);a.mergeWith({list:[s]}),this._audioPlayer().play(s,a)}static _audioPlayer(){return window.getAudioPlayer()}static _audioExtra(){const e=this._audioPlayer().getCurrentAudio();var t;return null!=(t=(0,l.getAudioExtra)(e))?t:{}}static isLoadingArticle(e){return this.loadingArticleRawId===e.raw_id}static isArticleInPlayer(e){return e.owner_id===this._audioExtra().articleOwnerId&&e.id===this._audioExtra().articleId}static isAnyArticleInPlayer(){return(0,s.isArticleTts)(this._audioPlayer().getCurrentAudio())}static sendStats(e){var t;const{articleId:i,articleOwnerId:_}=this._audioExtra();var s;o.articleTtsActionStatController.logEvent({action:e,nav_screen:"article_read",article_id:i,owner_id:_,audio_length:null!=(s=null==(t=(0,a.audioTupleToAudioObject)(this._audioPlayer().getCurrentAudio()))?void 0:t.duration)?s:0,speed:Math.round(100*AudioPlayer.podcastGetPlaybackRate()),volume:Math.round(100*this._audioPlayer().getVolume())})}}c.statsHandlersInitialized=!1,c.retryCount=0,c.RETRY_TIMEOUT=1e3},32953:(e,t,i)=>{i.d(t,{default:()=>d});var o=i(40378),_=i(70784),s=i(4865),r=i(18953),a=i(62246);const n="page_header_cont",l="onboarding";class d{initOnboardingBG(){if(!window.onboardingBG){let e='\n<div id="onboarding_layout">\n  <svg id="onboarding_bg_header" width="100%" height="49px">\n    <rect id="onboarding_bg_rect" class="GroupOnboardingBg" x="0" y="0" width="100%" height="100%" fill-opacity="0.8" fill="#000"></rect>\n  </svg>\n  <svg id="onboarding_bg" width="100%" height="100%">\n  <defs>\n    <mask id="mask" x="0" y="0" width="100%" height="100%">\n      <rect x="0" y="0" width="100%" height="100%" fill="#fff"></rect>\n      <rect id="onboarding_bg_clip" class="GroupOnboardingBgClip" x="0" y="0" width="0" height="0" fill="#000" rx="8" ry="8"></rect>\n    </mask>\n  </defs>\n  <rect id="onboarding_bg_rect" class="GroupOnboardingBg" x="0" y="42" width="100%" height="100%" mask="url(#mask)" fill-opacity="0.8"></rect>\n  </svg>\n</div>\n      ',t=(0,o.se)(e);(0,o.domInsertBefore)(t,window.layerBG),window.onboardingBGHeader=(0,o.ge)("onboarding_bg_header"),window.onboardingBG=(0,o.ge)("onboarding_bg"),window.onboardingBGRect=(0,o.ge)("onboarding_bg_rect"),window.onboardingBGClip=(0,o.ge)("onboarding_bg_clip"),window.cur.destroy.push((()=>{(0,o.hide)(window.onboardingBG),(0,o.hide)(window.onboardingBGHeader),(0,o.removeClass)((0,o.ge)(n),l),this.hideDarkness=!0,this.hideTT(),delete window.onboardingBG,delete window.onboardingBGHeader,delete window.onboardingBGRect,delete window.onboardingBGClip,this.opts.onBGClick&&(0,_.removeEvent)(window.onboardingBG,"click",this.opts.onBGClick)}))}this.opts.onBGClick&&(0,_.addEvent)(window.onboardingBG,"click",this.opts.onBGClick)}showTT(){const[,e]=(0,o.getXY)(this.el);this.tt=new a.ElementTooltip(this.el,this.ttParams),this.opts.highlight&&(this.addDarkness(),this.addHighlight()),this.tt.show();const t=this.tt.getContent();(0,r.isElementInViewport)(this.el)&&(0,r.isElementInViewport)(t)||(0,s.scrollToY)(e-42-this.ttParams.scrollOffset)}hideTT(){this.tt&&(this.tt.destroy(),this.removeDarkens(),this.hideDarkness&&((0,_.removeEvent)(window,"scroll"),(0,_.removeEvent)(window,"resize")),this.opts.onBGClick&&window.onboardingBG&&(0,_.removeEvent)(window.onboardingBG,"click",this.opts.onBGClick),this.opts.onHide&&this.opts.onHide())}addHighlight(){window.onboardingBGClip&&(this.highlightElement(),(0,_.addEvent)(window,"scroll",this.onScrollTT.bind(this)),(0,_.addEvent)(window,"resize",this.onResizeTT.bind(this)))}highlightElement(){let e=this.el.offsetWidth,t=this.el.offsetHeight,i=(0,o.getXY)(this.el);(0,o.attr)(window.onboardingBGClip,"width",e+this.border[1]+this.border[3]),(0,o.attr)(window.onboardingBGClip,"height",t+this.border[0]+this.border[2]),(0,o.attr)(window.onboardingBGClip,"x",i[0]-this.border[1]),(0,o.attr)(window.onboardingBGClip,"y",i[1]-this.border[0])}onResizeTT(){this.setDartToFullWidth(),this.highlightElement()}onScrollTT(){let e=this.getPageHeight();window.onboardingBG.height!=e&&this.setDartToFullHeight()}setDartToFullHeight(){(0,o.attr)(window.onboardingBG,"height",this.getPageHeight())}setDartToFullWidth(){(0,o.attr)(window.onboardingBG,"width",this.getPageWidth()),(0,o.attr)(window.onboardingBGHeader,"width",this.getPageWidth())}addDarkness(){(0,o.isVisible)(window.onboardingBG)||(this.setDartToFullHeight(),this.setDartToFullWidth(),(0,o.show)(window.onboardingBG),(0,o.isVisible)(window.onboardingBGHeader)||((0,o.show)(window.onboardingBGHeader),(0,o.addClass)((0,o.ge)(n),l)))}removeDarkens(){this.hideDarkness&&((0,o.hide)(window.onboardingBG),(0,o.hide)(window.onboardingBGHeader),(0,o.removeClass)((0,o.ge)(n),l))}ttOnHide(){this.hideTT()}show(){setTimeout(this.showTT.bind(this),1e3)}getPageWidth(){const e=document.documentElement,t=document.body;return Math.max(t.scrollWidth,e.scrollWidth,t.offsetWidth,e.offsetWidth,t.clientWidth,e.clientWidth)}getPageHeight(){const e=document.documentElement,t=document.body;return Math.max(t.scrollHeight,e.scrollHeight,t.offsetHeight,e.offsetHeight,t.clientHeight,e.clientHeight)}constructor(e,t,i={}){this.el=e,this.text=t,this.hideDarkness=!0,this.oldColor=!1;var o;let _={autoShow:!1,noAutoHideOnWindowClick:null==(o=i.noAutoHideOnWindowClick)||o,content:t instanceof HTMLElement?t:`${t}`,cls:`feature_intro_tt tutorial_tip_tt ${(()=>{var e;const t=null!=(e=i.class)?e:"";return i.tooltipWhite?t:t+" feature_intro_blue_tt"})()}`,appendToParent:!0,onHide:this.ttOnHide.bind(this),scrollOffset:i.scrollOffset||0,align:i.align||a.ElementTooltip.ALIGN_CENTER};i.side&&(_.forceSide=i.side),i.offset&&(_.offset=i.offset),i.width&&(_.width=i.width),i.shift&&(_.centerShift=i.shift),i.border?this.border=i.border:this.border=[10,10,10,10],i.ttOnHide&&(_.onHide=i.ttOnHide),i.withCloseButton&&(_.withCloseButton=i.withCloseButton,_.onCloseButtonClick=i.onCloseButtonClick),i.align&&(_.align=i.align),this.ttParams=_,this.opts=i,this.initOnboardingBG()}}},18953:(e,t,i)=>{function o(e){const t=e.getBoundingClientRect();return t.top>=0&&t.left>=0&&t.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&t.right<=(window.innerWidth||document.documentElement.clientWidth)}i.d(t,{isElementInViewport:()=>o})},37046:(e,t,i)=>{i.d(t,{UiScroll:()=>d});var o=i(77908),_=i(64639),s=i(39715),r=i(40378),a=i(70784),n=i(1106),l=i(48070);class d{init(){if(this.options.stopScrollPropagation&&this.fixBlocker(),!this.inited){if(!this.el.container.scrollWidth||this.disabled)return;this.fixSize(!0),this.options.autoresize&&this.startResizeListening(),this.options.global||cur.destroy.push(this.destroy.bind(this)),this.inited=!0}return this.update(!0),this.api}addEvent(e,t,i,o){return this.removeEvents.push([e,t,i]),(0,a.addEvent)(e,t,i,void 0,void 0,o?{passive:!0}:void 0),i}destroy(){if(this.disabled=!0,this.fixSize(),this.animation&&this.animation.stop(),this.moreTimeout&&clearTimeout(this.moreTimeout),this.dragstopHandler&&(0,a.removeEvent)(document,"mouseup contextmenu",this.dragstopHandler),this.dragHandler&&(0,a.removeEvent)(document,"mousemove",this.dragHandler),(0,s.each)(this.removeEvents,(function(e,t){a.removeEvent.apply(null,t)})),this.el.overflow.parentNode==this.el.container){const e=(0,r.cf)();for(;this.el.content.firstChild;)e.appendChild(this.el.content.firstChild);this.el.container.appendChild(e)}return(0,r.removeData)(this.el.container,"ui-scroll"),this.el.container.className=this.el.container.className.replace(/\bui_scroll_.+?\b/g," "),(0,s.each)(this.removeElements,(function(e,t){(0,r.re)(t)})),this.el.container.scrollTop=this.api.data.scrollTop,delete this.el.container.__uiScroll__,this.api}updateAbove(e){if((0,s.isFunction)(e)){this.animation&&this.animation.stop();const t=this.el.outer.scrollHeight-this.el.outer.scrollTop-this.el.overflow.offsetHeight;e(),this.el.outer.scrollTop=this.el.outer.scrollHeight-this.el.overflow.offsetHeight-t}return this.api}updateBelow(e){if((0,s.isFunction)(e)){this.animation&&this.animation.stop();const t=this.options.preserveEdgeBelow&&this.api.data.scrollBottom<=this.options.preserveEdgeBelowThreshold;e(),t&&this.scrollBottom(!1)}return this.api}fixBlocker(){o.browser.chrome&&!this.options.noForceReFlow&&this.forceReFlow(),this.el.blocker.scrollTop=this.blockerScrollTop}forceReFlow(){this.el.blocker.style.display="inline-block",this.el.blocker.offsetHeight,this.el.blocker.style.display=""}fixSize(e){this.options.native||(e&&null==this.fixSizeDefault&&(this.fixSizeDefault=this.el.container.style.width),(0,r.setStyle)(this.el.container,"width",e?(0,r.getSize)(this.el.container,!0)[0]||this.fixSizeDefault||"":this.fixSizeDefault||""))}emitEvent(e){this.disabled||this.inited&&this.emitter.emitEvent(e,[this.api])}static scrollEventDelta(e){let t=0;const i=void 0!==e.deltaMode?e.deltaMode:"MozMousePixelScroll"==e.type?0:1;return"wheel"==e.type?t=e.deltaY:void 0!==e.wheelDeltaX&&void 0!==e.wheelDeltaY?(t=1/40*-e.wheelDeltaY,o.browser.mac&&o.browser.opera&&(t*=.1)):void 0!==e.wheelDelta?t=1/40*-e.wheelDelta:e.detail&&2===e.axis&&(t=e.detail),t*(1==i?15:2==i?450:1)}isScrollEventUnused(e){return d.scrollEventDelta(e)>0?!this.api.data.scrollBottom:!this.api.data.scrollTop}resize(e){if(!e&&this.options.preserveEdgeBelow){const t=this.options.preserveEdgeBelow&&this.api.data.scrollBottom<=this.options.preserveEdgeBelowThreshold;this.update(!0)&&(this.emitEvent("resize"),t&&this.scrollBottom(),this.options.stopScrollPropagation&&!e&&this.fixBlocker())}else this.update(!0)&&(this.options.stopScrollPropagation&&!e&&this.fixBlocker(),this.emitEvent("resize"))}disable(e){return this.disabled=!!e,e?(this.animation&&this.animation.stop(),this.fixSize()):(this.fixSize(!0),this.options.stopScrollPropagation&&this.fixBlocker(),this.update(!0)),(0,r.toggleClass)(this.el.container,"ui_scroll_disabled",this.disabled),this.api}dragstart(e){if(!(this.disabled||this.dragging||this.options.native))return e||(e=window.event),this.dragging=!0,this.animation&&this.animation.stop(),this.options.reversed&&(this.noMore=!0),(0,a.addEvent)(document,"mouseup contextmenu",this.dragstartHandler=this.dragstop.bind(this)),(0,a.addEvent)(document,"mousemove",this.dragHandler=this.drag.bind(this)),this.dragScroll=this.options.reversed?this.api.data.scrollBottom:this.api.data.scrollTop,this.dragY=e.screenY,(0,a.cancelEvent)(e),this.emitEvent("dragstart"),this.api}dragstop(e){if(!this.disabled&&this.dragging&&!this.options.native){if(e||(e=window.event),this.dragging=!1,this.dragstopHandler&&(0,a.removeEvent)(document,"mouseup contextmenu",this.dragstopHandler),this.dragHandler&&(0,a.removeEvent)(document,"mousemove",this.dragHandler),(0,r.setStyle)(document.body,"cursor",""),(0,r.removeClass)(this.el.container,"ui_scroll_dragging"),this.dragged)this.noMore&&(this.noMore=!1,this.more());else{this.options.reversed&&(this.noMore=!0);const t=(e.pageY-(0,r.getXY)(this.el.barOuter)[1]-this.barInnerHeight/2)*(Math.max(this.options.minContentHeight,this.api.data.scrollHeight)-this.api.data.viewportHeight)/(this.barOuterHeight-this.barInnerHeight);this.scrollTop(!1,t,0,function(){this.noMore&&(this.noMore=!1,this.more())}.bind(this))}return this.dragged=!1,e&&"contextmenu"!==e.type&&(0,a.cancelEvent)(e),this.emitEvent("dragstop"),this.api}}drag(e){if(this.disabled||!this.dragging||this.options.native)return;e||(e=window.event);const t=(e.screenY-this.dragY)*(this.api.data.scrollHeight/this.el.barOuter.scrollHeight);return this.el.outer.scrollTop=this.options.reversed?this.el.outer.scrollHeight-this.el.overflow.offsetHeight-this.dragScroll+t:this.dragScroll+t,this.dragged||(this.dragged=!0,(0,r.setStyle)(document.body,"cursor","pointer"),(0,r.addClass)(this.el.container,"ui_scroll_dragging")),(0,a.cancelEvent)(e),this.emitEvent("drag"),this.api}scroll(e,t,i){return this.animation&&this.animation.stop(),this.el.outer.scrollTop==e&&this.update(!0),t?(t="number"!=typeof t||!isFinite(t)||t%1?300:Math.abs(t),this.animation=new n.Fx.Base({scrollTop:this.el.outer.scrollTop},{transition:n.Fx.Transitions.easeOutCubic,onStep:function(e){this.el.outer.scrollTop=e.scrollTop}.bind(this),duration:t,onComplete:(0,s.isFunction)(i)?i.pbind(this.api):void 0}).start({scrollTop:this.el.outer.scrollTop},{scrollTop:e})):(this.el.outer.scrollTop=e,(0,s.isFunction)(i)&&i(this.api)),this.api}scrollTop(e,t,i,o){if(e&&this.options.stopScrollPropagation&&this.fixBlocker(),!this.disabled&&!this.dragging)return this.scroll((0,s.intval)(t),i,o)}scrollBottom(e,t,i,o){if(e&&this.options.stopScrollPropagation&&this.fixBlocker(),!this.disabled&&!this.dragging)return this.scroll(this.el.outer.scrollHeight-this.el.overflow.offsetHeight-(0,s.intval)(t),i,o)}scrollBy(e,t,i){if(!this.disabled&&!this.dragging)return this.scroll(this.el.outer.scrollTop+(0,s.intval)(e),t,i)}scrollIntoView(e,t,i,o){if(e&&this.options.stopScrollPropagation&&this.fixBlocker(),(t=(0,l.getScrollElement)(t))&&t.compareDocumentPosition&&t.compareDocumentPosition(this.el.content)&Node.DOCUMENT_POSITION_CONTAINS){const e=(0,r.getXY)(t)[1],_=(0,r.getXY)(this.el.overflow)[1],a=(0,r.getSize)(t)[1];if(e<=_&&e+a>=_+this.api.data.viewportHeight||e>=_&&e+a<=_+this.api.data.viewportHeight)(0,s.isFunction)(o)&&(i?setTimeout(o.bind(this.api),0):o(this.api));else if(a>this.api.data.viewportHeight||e<_)this.scrollTop(!1,e-_+this.api.data.scrollTop-(this.options.shadows?(0,r.getSize)(this.el.shadowTop)[1]:0),i,o);else{const t=this.options.shadows?(0,r.getSize)(this.el.shadowBottom)[1]:0;this.scrollTop(!1,e-_+this.api.data.scrollTop+a-this.api.data.viewportHeight+t,i,o)}}return this.api}update(e){let t,i;this.el.container&&!this.el.container.updateScroll&&(this.el.container.updateScroll=this.update.bind(this,!1));const o=this.el.outer.scrollTop;if(this.inited&&!this.disabled&&(e&&(t=this.el.inner.offsetHeight,this.api.data.viewportHeight!==(this.api.data.viewportHeight=this.el.overflow.offsetHeight)||this.api.data.scrollHeight!==t)||this.api.data.scrollTop!==o)){if(e&&(this.api.data.scrollHeight=t),this.api.data.scrollTop=Math.max(0,Math.min(this.api.data.scrollHeight-this.api.data.viewportHeight,Math.max(0,o))),this.api.data.scrollBottom=Math.max(0,this.api.data.scrollHeight-this.api.data.scrollTop-this.api.data.viewportHeight),!this.options.native){if(t=Math.max(this.options.minContentHeight,this.api.data.scrollHeight),i=t<=this.api.data.viewportHeight,!i){const i=this.el.barOuter.offsetHeight;(e||this.barOuterHeight!==i)&&(this.barOuterHeight=i,this.barInnerHeight=Math.max(this.options.barMinHeight,this.barOuterHeight*this.api.data.viewportHeight/t),this.el.barInner.style.height=this.barInnerHeight+"px"),(0,l.nextFrame)((()=>{const e=(this.barOuterHeight-this.barInnerHeight)*this.api.data.scrollTop/(t-this.api.data.viewportHeight);this.el.barInner.style.transform=`translateY(${e}px)`}))}this.options.shadows&&(this.shadowTop!=(this.api.data.scrollTop&&!i)&&(0,r.toggleClass)(this.el.container,"ui_scroll_shadow_top_visible",this.shadowTop=this.api.data.scrollTop&&!i),this.shadowBottom!=(this.api.data.scrollBottom&&!i)&&(0,r.toggleClass)(this.el.container,"ui_scroll_shadow_bottom_visible",this.shadowBottom=this.api.data.scrollBottom&&!i)),this.unnecessary!==i&&((0,r.toggleClass)(this.el.container,"ui_scroll_unnecessary",i),this.unnecessary=i,this.options.stopScrollPropagation&&this.fixBlocker(),i&&this.barInnerHeight&&this.barOuterHeight&&(0,l.nextFrame)(function(e){this.el.barInner.style.height=100*this.barInnerHeight/this.barOuterHeight+"%";const i=(this.barOuterHeight-this.barInnerHeight)*this.api.data.scrollTop/(t-this.api.data.viewportHeight)*100/this.barInnerHeight;this.el.barInner.style.transform=`translateY(${i}%)`}.bind(this)))}return this.emitEvent("update"),(!this.options.reversed||o>=0)&&this.more(),!0}return!1}more(){const e=this.options.reversed?this.api.data.scrollTop:this.api.data.scrollBottom,t=null!==this.options.onmoreThreshold?this.options.onmoreThreshold:2*this.api.data.viewportHeight;!this.noMore&&e<=t&&this.emitEvent("more")}constructor(e,t){if(!(e=(0,l.getScrollElement)(e)))throw new Error("uiScroll container is undefined");e.__uiScroll__&&e.__uiScroll__.destroy(),this.options=(0,s.extend)({global:!1,native:!1,theme:"default",reversed:!1,autoresize:!0,preserveEdgeBelow:!1,barMinHeight:30,preserveEdgeBelowThreshold:20,stopScrollPropagation:!0,stopScrollPropagationAlways:!1,minContentHeight:0,onmoreThreshold:null,hidden:!1,shadows:!1,scrollElements:[],onresize:null,onscroll:null,onscrollstart:null,onscrollstop:null,ondrag:null,ondragstart:null,ondragstop:null,onupdate:null,onmore:null,noForceReFlow:!1},t),this.options.native&&(this.options.shadows=!1),o.browser.mobile&&(this.options.stopScrollPropagation=!1),(0,_.isArray)(this.options.scrollElements)||(this.options.scrollElements=[]),this.removeEvents=[],this.removeElements=[],this.dragging=!1,this.dragged=!1,this.released=!0,this.noMore=!1,this.dragY=null,this.dragScroll=null,this.shadowTop=!1,this.shadowBottom=!1,this.unnecessary=!1,this.disabled=!1,this.stopped=!0,this.stoppedTimeout=null,this.fixSizeDefault=null,this.animation=null,this.barOuterHeight=null,this.barInnerHeight=null,this.currentFrame=null,this.blockerScrollTop=500,this.emitter=new EventEmitter,(0,s.isFunction)(this.options.onresize)&&this.emitter.addListener("resize",this.options.onresize),(0,s.isFunction)(this.options.onscroll)&&this.emitter.addListener("scroll",this.options.onscroll),(0,s.isFunction)(this.options.onscrollstart)&&this.emitter.addListener("scrollstart",this.options.onscrollstart),(0,s.isFunction)(this.options.onscrollstop)&&this.emitter.addListener("scrollstop",this.options.onscrollstop),(0,s.isFunction)(this.options.ondrag)&&this.emitter.addListener("drag",this.options.ondrag),(0,s.isFunction)(this.options.ondragstart)&&this.emitter.addListener("dragstart",this.options.ondragstart),(0,s.isFunction)(this.options.ondragstop)&&this.emitter.addListener("dragstop",this.options.ondragstop),(0,s.isFunction)(this.options.onupdate)&&this.emitter.addListener("update",this.options.onupdate),(0,s.isFunction)(this.options.onmore)&&this.emitter.addListener("more",this.options.onmore),this.el={container:e,overflow:(0,r.ce)("div",{className:"ui_scroll_overflow"}),outer:(0,r.ce)("div",{className:"ui_scroll_outer"},{margin:this.options.stopScrollPropagation?this.blockerScrollTop+"px 0":void 0}),inner:(0,r.ce)("div",{className:"ui_scroll_inner tt_noappend"}),shadowTop:(0,r.ce)("div",{className:"ui_scroll_shadow_top"}),shadowBottom:(0,r.ce)("div",{className:"ui_scroll_shadow_bottom"}),content:(0,r.ce)("div",{className:"ui_scroll_content clear_fix"}),barContainer:(0,r.ce)("div",{className:"ui_scroll_bar_container"}),barOuter:(0,r.ce)("div",{className:"ui_scroll_bar_outer"}),barInner:(0,r.ce)("div",{className:"ui_scroll_bar_inner"})},(0,r.data)(this.el.container,"ui-scroll",this);const i=(0,r.cf)(),n=["ui_scroll_container"];for((0,s.each)((0,_.isArray)(this.options.theme)?this.options.theme:(0,s.trim)(this.options.theme+"").split(/\s+/),(function(e,t){t&&n.push("ui_scroll_"+t+"_theme")})),(0,r.addClass)(this.el.container,n.join(" ")),this.options.hidden&&(0,r.addClass)(this.el.container,"ui_scroll_hidden");this.el.container.firstChild;)this.el.content.appendChild(this.el.container.firstChild);if(this.el.outer.appendChild(this.el.inner),this.el.inner.appendChild(this.el.content),this.options.stopScrollPropagation?(this.el.blocker=(0,r.ce)("div",{className:"ui_scroll_blocker"}),this.addEvent(this.el.blocker,"scroll",this.fixBlocker.bind(this),!0),this.el.blocker.appendChild(this.el.outer),this.el.overflow.appendChild(this.el.blocker)):this.el.overflow.appendChild(this.el.outer),i.appendChild(this.el.overflow),this.options.native?(0,r.addClass)(this.el.container,"ui_scroll_native"):(this.el.barOuter.appendChild(this.el.barInner),this.el.barContainer.appendChild(this.el.barOuter),i.appendChild(this.el.barContainer),this.options.shadows&&(this.el.overflow.appendChild(this.el.shadowTop),this.el.overflow.appendChild(this.el.shadowBottom)),o.browser.mobile||this.options.scrollElements.push(this.el.barContainer)),this.options.autoresize){const e=(0,l.addResizeSensor)(this.el.inner,this.resize.bind(this,!0)),t=(0,l.addResizeSensor)(this.el.overflow,this.resize.bind(this,!1));this.removeElements.push(e[0]),this.removeElements.push(t[0]),this.startResizeListening=function(){e[1](),t[1]()}}this.removeElements.push(this.el.overflow,this.el.barContainer),this.el.container.appendChild(i),this.options.reversed&&(this.el.outer.scrollTop=this.el.outer.scrollHeight),this.el.container.__uiScroll__=this.api={container:this.el.container,scroller:this.el.outer,content:this.el.content,emitter:this.emitter,ondragstart:this.dragstart.bind(this),ondragstop:this.dragstop.bind(this),ondrag:this.drag.bind(this),destroy:this.destroy.bind(this),disable:this.disable.bind(this,!0),enable:this.disable.bind(this,!1),scrollTop:this.scrollTop.bind(this,!0),scrollBottom:this.scrollBottom.bind(this,!0),scrollBy:this.scrollBy.bind(this),scrollIntoView:this.scrollIntoView.bind(this,!0),update:this.init.bind(this),updateAbove:this.updateAbove.bind(this),updateBelow:this.updateBelow.bind(this),data:{scrollTop:null,scrollBottom:null,scrollHeight:null,viewportHeight:null}},this.init();const c="onwheel"in this.el.outer?"wheel":void 0!==document.onmousewheel?"mousewheel":o.browser.mozilla?"MozMousePixelScroll":"DOMMouseScroll";return this.addEvent(this.el.container,c,function(e){this.animation&&this.animation.stop(),!this.disabled&&this.options.stopScrollPropagation&&(this.unnecessary?this.options.stopScrollPropagationAlways&&(0,a.cancelEvent)(e):this.isScrollEventUnused(e)?(0,a.cancelEvent)(e):(0,a.stopEvent)(e))}.bind(this),!this.options.stopScrollPropagation),this.options.native||this.addEvent(this.el.barContainer,"mousedown",this.dragstart.bind(this)),(0,s.each)(this.options.scrollElements,function(e,t){this.addEvent(t,c,function(e){this.disabled||this.unnecessary||(this.scrollBy(d.scrollEventDelta(e)),!this.options.stopScrollPropagation&&this.isScrollEventUnused(e)||(0,a.cancelEvent)(e))}.bind(this))}.bind(this)),this.options.reversed&&this.addEvent(this.el.container,"mousedown touchstart pointerdown",function(e){this.released=!1,this.noMore=!0;const t=this.addEvent(document,"mouseup contextmenu touchend pointerup",function(e){(0,a.removeEvent)(document,"mouseup contextmenu touchend pointerup",t),this.released=!0,this.noMore&&this.stopped&&!this.dragging&&(this.noMore=!1,this.more())}.bind(this))}.bind(this)),this.addEvent(this.el.outer,"scroll",function(){this.update()&&(this.stopped?(this.stopped=!1,this.emitEvent("scrollstart")):this.options.native||!1!==this.stopped||(this.stopped=0,(0,r.addClass)(this.el.container,"ui_scroll_scrolled")),this.emitEvent("scroll"),this.stoppedTimeout&&clearTimeout(this.stoppedTimeout),this.stoppedTimeout=setTimeout(function(){this.stopped||(this.stopped=!0,this.options.native||(0,r.removeClass)(this.el.container,"ui_scroll_scrolled"),this.emitEvent("scrollstop"),this.noMore&&this.released&&!this.dragging&&(this.noMore=!1,this.more()))}.bind(this),200))}.bind(this)),this.api}}d.addResizeSensor=l.addResizeSensor},48070:(e,t,i)=>{i.d(t,{addResizeSensor:()=>c,getScrollElement:()=>d,nextFrame:()=>l});var o=i(39715),_=i(40378),s=i(77908);let r;const a=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||(e=>setTimeout(e,1)),n=window.cancelAnimationFrame||window.cancelRequestAnimationFrame||window.webkitCancelRequestAnimationFrame||window.mozCancelRequestAnimationFrame||window.oCancelRequestAnimationFrame||window.msCancelRequestAnimationFrame||clearTimeout;function l(e){r&&n(r),r=a(e)}function d(e){return(0,o.isString)(e)&&"_"===e[0]?(0,_.geByClass1)(e):(0,_.ge)(e)}function c(e,t){if((e=d(e))&&(0,o.isFunction)(t)){if(s.browser.msie9||s.browser.opera&&s.browser.version<13){let i=!1,r=!1;const a=(0,_.ce)("object",{type:"text/html",className:"ui_scroll_resize_object",data:"about:blank",onload:function(){r=!0,i&&n()}});function n(){if(!a.contentDocument)return setTimeout(n,100);a.contentDocument.defaultView.removeEventListener("resize",t),a.contentDocument.defaultView.addEventListener("resize",t),t()}return e.appendChild(a),e.__resizeSensor__=[a,function(){i=!0,r&&n()}]}{const l=(0,_.ce)("div",{className:"ui_scroll_resize_sensor"}),c=(0,_.ce)("div",{className:"ui_scroll_resize_sensor ui_scroll_resize_expand"}),u=(0,_.ce)("div",{className:"ui_scroll_resize_sensor ui_scroll_resize_shrink"}),p=(0,_.ce)("div"),h=(0,_.ce)("div");let m=null;return c.appendChild(p),u.appendChild(h),l.appendChild(c),l.appendChild(u),e.appendChild(l),e.__resizeSensor__=[l,c.onscroll=u.onscroll=function(){const i=(e.offsetWidth||1e4)+10,o=(e.offsetHeight||1e4)+10;p.style.width=i+"px",p.style.height=o+"px",c.scrollLeft=i,c.scrollTop=o,u.scrollLeft=i,u.scrollTop=o,m!==(m=i+" "+o)&&t()}]}}}},96022:(e,t,i)=>{i.d(t,{useExternRef:()=>_});var o=i(67294);function _(...e){const t=(0,o.useRef)(null);return(0,o.useMemo)((()=>({get current(){return t.current},set current(i){t.current=i,e.forEach((e=>{e&&function(e,t){t&&("function"==typeof t?t(e):t.current=e)}(i,e)}))}})),e)}},62959:(e,t,i)=>{i.d(t,{useIsMounted:()=>_});var o=i(67294);const _=()=>{const e=(0,o.useRef)(!1);return(0,o.useEffect)((()=>(e.current=!0,()=>{e.current=!1})),[]),(0,o.useCallback)((()=>e.current),[])}},43222:(e,t,i)=>{i.d(t,{createFriendsAddFx:()=>_,createFriendsDeleteFx:()=>s});var o=i(66448);const _=e=>(0,o.createApiEffect)("friends.add",e),s=e=>(0,o.createApiEffect)("friends.delete",e)},26734:(e,t,i)=>{i.d(t,{createGroupsJoinFx:()=>_,createGroupsLeaveFx:()=>s});var o=i(66448);const _=e=>(0,o.createApiEffect)("groups.join",e),s=e=>(0,o.createApiEffect)("groups.leave",e)},83560:(e,t,i)=>{i.d(t,{formatCount:()=>o});const o=(e,t)=>{var i,o,_,s,r,a,n;const l=(null==(i=t)?void 0:i.separator)||".";var d;const c=null!=(d=null==(o=t)?void 0:o.maximumFractionDigits)?d:1,u=(null==(_=t)?void 0:_.roundingMode)||void 0,p=(null==(s=t)?void 0:s.kLimit)||1e3,h=(null==(r=t)?void 0:r.mLimit)||1e6,m=(null==(a=t)?void 0:a.bLimit)||1e9,E=(null==(n=window.langConfig)?void 0:n.locale)||"ru",b=(e,t)=>{"floor"===u&&(e=Math.floor(e*Math.pow(10,c))/Math.pow(10,c));let i=e.toFixed(c);return Number(i).toLocaleString(E).replace(/\./,l)+t};if(e>-p&&e<p)return e.toLocaleString(E);const w=e/m;if(w>=1||w<=-1)return b(e/1e9,"B");const f=e/h;if(f>=1||f<=-1)return b(e/1e6,"M");const g=e/p;return g>=1||g<=-1?b(e/1e3,"K"):String(e)}},44471:(e,t,i)=>{i.d(t,{getOwnerFullName:()=>a,getOwnerHref:()=>r,getOwnerShortName:()=>n,isOwnerGroup:()=>s,isOwnerUser:()=>_});var o=i(41547);const _=e=>!!e&&"first_name"in e,s=e=>!!e&&"name"in e;function r(e,t=!1){let i="/";return e&&(s(e)?i+=e.screen_name||`club${e.id}`:i+=e.screen_name||e.domain||`id${e.id}`),t?window.location.origin+i:i}function a(e){let t="";return e?(e.first_name&&(t+=e.first_name.trim()),e.last_name&&(t+=` ${e.last_name.trim()}`),e.maiden_name&&e.sex===o.BaseSexEnumNames.FEMALE&&(t+=` (${e.maiden_name.trim()})`),t):t}function n(e){let t="";return e.first_name&&(t+=e.first_name.trim()),e.last_name&&(t+=` ${e.last_name.trim().slice(0,1)}.`),t}},46601:(__unused_webpack_module,__unused_webpack___webpack_exports__,__webpack_require__)=>{var _web_stories_narrative_utils__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(71889),_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(60283),_shared_lib_browser__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(77908),_web_lib_video__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(46844),_web_lib_ui__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(8932),_web_lib_debug_tools__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(97061),_web_lib_ui_util__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(10273),_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(74450),_shared_lib_common__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(64639),_web_lib_tooltip_utils__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(66657),_web_lib_fx__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(1106),_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(70784),_web_legacy_ui_ui_scroll__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(37046),_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(40378),_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(39715),_web_articles_article_utils__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__(36606),_web_evbus__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__(2386),_shared_lib_js_logger__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__(75973),_shared_ranges__WEBPACK_IMPORTED_MODULE_18__=__webpack_require__(83668);(0,_web_evbus__WEBPACK_IMPORTED_MODULE_16__.init)(),window.WComments={init(e){e.reply_names&&(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_8__.isArray)(e.reply_names)&&(e.reply_names={}),(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.extend)(cur,{options:e,oid:e.user_id,postTo:e.user_id,heightEl:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass1)("_wcomments_page"),countEl:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass1)("_wcomments_count"),contentEl:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass1)("_wcomments_content"),section:e.section,noAwayCheck:!0,sendPostBtn:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("send_post"),postsEl:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("wcomments_posts"),postsOuterEl:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass1)("_wcomments_posts_outer"),wallType:"widget_comments",onReplyFormSizeUpdate:WComments.contentUpdated.bind(WComments,!1),onEditFormSizeUpdate:WComments.contentUpdated.bind(WComments,!1)}),cur.options.filter_media_types=cur.options.media_types||[],this.override("lite.js"),this.override(window.jsc("web/page.js")),this.override(window.jsc("web/emoji.js")),window.stManager.emitter.addListener("update",this.override.bind(this)),this.updateSize(),(e.is_auto||e.is_nano)&&(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.extend)(e,{media_opts:{hideAfterCount:0,maxShown:0}}),Wall.init(e),e.fixed_height?((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.setStyle)(cur.postsOuterEl,{maxHeight:e.fixed_height-(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.getSize)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass1)("_wcomments_head"))[1]-(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.getSize)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass1)("_wcomments_form"))[1]}),cur.scrollbar=new _web_legacy_ui_ui_scroll__WEBPACK_IMPORTED_MODULE_12__.UiScroll(cur.postsOuterEl,{hidden:1,onmore:this.showMore.bind(this),ondragstart:function(){cur.Rpc.callMethod("startDrag")},ondragstop:function(){cur.Rpc.callMethod("stopDrag")}}),cur.mouseMove=cur.scrollbar.ondrag.bind(cur.scrollbar),cur.mouseUp=cur.scrollbar.ondragstop.bind(cur.scrollbar)):(cur.mouseMove=function(){},cur.mouseUp=function(){}),e.qtransport&&this.initQTransport(e.qtransport),window.timeUpdateInt=setInterval(this.updateTimes.bind(this),1e4),cur.RpcMethods={onInit:function(){let e=this.resizeWidget.bind(this);setTimeout(e,0),setTimeout(e,500)}.bind(this),updateStickers:function(){window.emojiStickers=!1,window.Emoji&&Emoji.updateTabs()},mouseMove:cur.mouseMove,mouseUp:cur.mouseUp,chooseMedia:function(){let e=cleanObj(this.uncleanObj([].slice.call(arguments)));cur.chooseMedia.apply(cur.chooseMedia,e),setTimeout(this.resizeWidget.bind(this),0)}.bind(this),addMedia:function(e,t,...i){~["pollBackgroundUploaded"].indexOf(t)&&cur.addMedia&&cur.addMedia[e]&&(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.isFunction)(cur.addMedia[e][t])&&cur.addMedia[e][t].apply(cur.addMedia[e],i)},showMediaProgress:function(){let e=cleanObj([].slice.call(arguments));cur.showMediaProgress.apply(cur.showMediaProgress,e)},likeFullUpdate:function(){}};try{cur.Rpc=new fastXDM.Client(cur.RpcMethods,{safe:!0,sameOrigin:!0,unsafeMethods:["mouseMove","mouseUp"]}),cur.resizeInt=setInterval(this.resizeWidget.bind(this),1e3)}catch(e){(0,_web_lib_debug_tools__WEBPACK_IMPORTED_MODULE_5__.debugLog)(e)}_shared_ranges__WEBPACK_IMPORTED_MODULE_18__.Ranges.isUserId(e.user_id)||((0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_11__.addEvent)("send_post","click",Widgets.oauth.bind(Widgets)),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_11__.addEvent)("post_field","click",Widgets.oauth.bind(Widgets)))},uncleanObj:function(e){let t;if((0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_8__.isObject)(e)){t={};for(let i in e)t[i.replace(/[^a-zA-Z0-9_\-]/g,"")]=this.uncleanObj(e[i])}else if((0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_8__.isArray)(e))t=[],e.forEach((e=>{t.push(this.uncleanObj(e))}));else{let i=typeof e;t="number"==i||"boolean"==i||"function"==i?e:(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_8__.unclean)(e)}return t},getSectionParams:function(){let e={app:cur.options.app,width:cur.options.width,startWidth:cur.options.startWidth,limit:cur.options.limit};switch(cur.section){case"admin_browse":e.act="admin_browse";break;case"admin_bl":e.act="admin_bl",e.limit=15;break;case"admin_updates":e.act="admin_updates";break;case"browse":e.browse=1,e.replies=cur.options.replies;break;default:e.page_query=cur.options.page_query,e.part=1}return e},contentUpdated:function(e){e&&this.applyOptions(e),this.resizeWidget()},applyOptions:function(options){if(options.reply_names&&((0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_8__.isArray)(options.reply_names)&&(options.reply_names={}),cur.options.reply_names=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.extend)(cur.options.reply_names||{},options.reply_names),delete options.reply_names),options.head_count&&"browse"!=cur.section&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass1)("_wcomments_count"),options.head_count),delete options.head_count),options.script)try{eval(options.script),delete options.script}catch(e){(0,_shared_lib_js_logger__WEBPACK_IMPORTED_MODULE_17__.logEvalError)(e,options.script)}(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.extend)(cur.options,options),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.toggle)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass1)("_wcomments_more"),options.offset<options.count)},updateSize:function e(t){let i=(t||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.getSize)("page_wrap"))[0];if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.setStyle)(cur.heightEl,{width:i}),cur.options.is_auto){let t=1==cur.options.mini||0!=cur.options.mini&&i<630,o=t&&i<380;e.size!=t+""+o&&(e.size=t+""+o,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.removeClass)(document.body,"wcomments_mini"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.removeClass)(document.body,"wcomments_nano"),t&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.addClass)(document.body,"wcomments_mini"),o&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.addClass)(document.body,"wcomments_nano"))}},resizeWidget:function e(){if(!cur.heightEl||!cur.Rpc)return;let t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.getSize)("page_wrap");(_shared_lib_browser__WEBPACK_IMPORTED_MODULE_2__.browser.msie&&!_shared_lib_browser__WEBPACK_IMPORTED_MODULE_2__.browser.msie8||_shared_lib_browser__WEBPACK_IMPORTED_MODULE_2__.browser.opera)&&(t[1]+=15),window.onBodyResize&&onBodyResize(),e.size!=t.join(" ")&&(e.size=t.join(" "),this.updateSize(t),cur.Rpc.callMethod("resize",t[1]))},showMore:function(){if(cur.switchingSection)return;let e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass1)("_wcomments_more");if(cur.options.offset>=cur.options.count)return(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hide)(e);buttonLocked(e)||ajax.post("al_widget_comments.php",(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.extend)(WComments.getSectionParams(),{offset:cur.options.offset,width:cur.options.width,startWidth:cur.options.startWidth,part:1}),{onDone:function(e,t){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("wcomments_posts").appendChild((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.cf)(t)),WComments.contentUpdated(e)},showProgress:lockButton.pbind(e),hideProgress:unlockButton.pbind(e)})},switchSection:function(e){if(cur.switchingSection||cur.section==e)return!1;cur.switchingSection=!0;let t=uiTabs&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass1)("_wcomments_admin_tabs"),i=t&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass1)("_"+e);return"posts"==e||"posts"==cur.section?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.addClass)(cur.contentEl,"wcomments_content_loading"):t&&uiTabs.showProgress(t),i&&uiTabs.switchTab((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass1)("ui_tab",i)),cur.section=e,ajax.post("al_widget_comments.php",WComments.getSectionParams(),{onDone:function(i,o){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)(cur.postsEl,o),t&&uiTabs.hideProgress(t),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.removeClass)(cur.contentEl,"wcomments_content_loading"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.removeClass)(cur.heightEl,"wcomments_section_posts"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.removeClass)(cur.heightEl,"wcomments_section_admin_browse"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.removeClass)(cur.heightEl,"wcomments_section_admin_bl"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.removeClass)(cur.heightEl,"wcomments_section_admin_updates"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.removeClass)(cur.heightEl,"wcomments_section_browse"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.addClass)(cur.heightEl,"wcomments_section_"+e),cur.options.fixed_height&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.setStyle)(cur.postsOuterEl,{maxHeight:cur.options.fixed_height-(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.getSize)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass1)("_wcomments_head"))[1]-(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.getSize)("posts"==cur.section||"browse"==cur.section?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass1)("_wcomments_form"):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass1)("_wcomments_admin_tabs"))[1]}),cur.scrollbar&&cur.scrollbar.scrollTop(),WComments.contentUpdated(i),cur.switchingSection=!1}}),!1},addToBl:function(e,t,i){if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(i,"wcomments_bl_action_loading"))return!1;ajax.post("al_widget_comments.php",{act:"a_add_to_bl",id:e,hash:t,app:cur.options.app},{onDone:function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hide)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass1)("_wcomments_bl_label_"+e)),i.onclick=WComments.delFromBl.bind(WComments,e,t,i),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)(i,(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang)("widgets_remove_from_banlist"))},showProgress:_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.addClass.pbind(i,"wcomments_bl_action_loading"),hideProgress:_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.removeClass.pbind(i,"wcomments_bl_action_loading")})},delFromBl:function(e,t,i){if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(i,"wcomments_bl_action_loading"))return!1;ajax.post("al_widget_comments.php",{act:"a_del_from_bl",id:e,hash:t,app:cur.options.app},{onDone:function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.setStyle)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass1)("_wcomments_bl_label_"+e),"display","inline"),i.onclick=WComments.addToBl.bind(WComments,e,t,i),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)(i,(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang)("widgets_restore_to_banlist"))},showProgress:_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.addClass.pbind(i,"wcomments_bl_action_loading"),hideProgress:_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.removeClass.pbind(i,"wcomments_bl_action_loading")})},updateTimes:function(e){if(!(cur.lang||{}).wall_X_seconds_ago_words)return;let t=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.intval)((0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_8__.vkNow)()/1e3),i=[];t-=cur.tsDiff,(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.each)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass)("rel_date_needs_update",e||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("wcomments_posts"),"span"),(function(e,o){if(!o)return;let _=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.intval)(o.getAttribute("time")),s=t-_,r=o.getAttribute("abs_time");s<5?r=(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang)("profile_status_word_secs_ago",1):s<60?r=Wall.langWordNumeric(s,cur.lang.wall_X_seconds_ago_words,cur.lang.wall_X_seconds_ago):s<3600?r=Wall.langWordNumeric((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.intval)(s/60),cur.lang.wall_X_minutes_ago_words,cur.lang.wall_X_minutes_ago):s<14400?r=Wall.langWordNumeric((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.intval)(s/3600),cur.lang.wall_X_hours_ago_words,cur.lang.wall_X_hours_ago):i.push(o),o.innerHTML=r})),(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.each)(i,(function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.removeClass)(this,"rel_date_needs_update")}))},langWordNumeric:function(e,t,i){return(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_8__.isArray)(t)&&e<t.length?t[e]:(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.langNumeric)(e,i)},showLikesBox:function(e,t){showBox("widget_like.php",(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.extend)({act:"a_stats_box",app:cur.options.app,obj:e,from:"wcomments",check_hash:cur.likeCheckHash,widget_width:638},t||{}))},deleteAllAndBan:function(e,t,i,o){ajax.post("al_widget_comments.php",{act:"a_add_to_bl",id:t,hash:i,app:cur.options.app},{onDone(i,o){o&&(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.each)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass)("wcomments_post",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("wcomments_posts"),"div"),(function(){!this.id.indexOf("post"+t)&&this.id.split("_")[1]>=o&&this.id!="post"+e&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.isVisible)(this)&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hide)(this)})),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("post_del"+e).innerHTML=i,WComments.contentUpdated()},showProgress:()=>{lockButton(o)},hideProgress:()=>{unlockButton(o)}})},initQTransport:function(e){window.curNotifier=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.extend)(e,{lp_connected:!1,error_timeout:1,addQueues:{},recvClbks:{},recvData:{},onConnectionId:[]}),WComments.lpInit(),WComments.lpStart()},lpGetTransportWrap(){let e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("queue_transport_wrap");return e||(e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ce)("div",{id:"queue_transport_wrap"}),utilsNode.appendChild(e)),e},lpInit:function(){curNotifier.lpMakeRequest||(delete curNotifier.lpMakeRequest,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.re)("queue_transport_frame"),WComments.lpGetTransportWrap().appendChild((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ce)("iframe",{id:"queue_transport_frame",name:"queue_transport_frame",src:curNotifier.frame_path})))},lpStart:function(){curNotifier.lp_started=!0,WComments.lpCheck()},lpStop(){curNotifier.lp_started=!1,clearTimeout(curNotifier.lp_check_to),clearTimeout(curNotifier.lp_error_to)},lpCheck(){curNotifier.lp_started&&(curNotifier.lpMakeRequest?curNotifier.lpMakeRequest(curNotifier.frame_url,{act:"a_check",ts:curNotifier.timestamp,key:curNotifier.key,id:curNotifier.uid,wait:25},(text=>{if(curNotifier.lp_started)try{let success=this.lpChecked(eval("("+text+")"));success&&(this.lpCheck(),curNotifier.error_timeout=1)}catch(e){(0,_web_lib_ui_util__WEBPACK_IMPORTED_MODULE_6__.topError)("Notify error: "+e.message),curNotifier.lp_error_to=setTimeout(this.lpCheck.bind(this),1e3*curNotifier.error_timeout),curNotifier.error_timeout<64&&(curNotifier.error_timeout*=2)}}),(()=>{curNotifier.lp_error_to=setTimeout(this.lpCheck.bind(this),1e3*curNotifier.error_timeout),curNotifier.error_timeout<64&&(curNotifier.error_timeout*=2)})):curNotifier.lp_check_to=setTimeout(this.lpCheck.bind(this),1e3))},lpChecked:function(e){let t=e.failed;if(2==t)return curNotifier.lp_error_to=setTimeout(this.lpGetKey.bind(this),1e3*curNotifier.error_timeout),curNotifier.error_timeout<64&&(curNotifier.error_timeout*=2),!1;if(t)throw new Error((0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang)("global_unknown_error"));return curNotifier.timestamp=e.ts,!cur.section.indexOf("admin")||(cur.saveScrollPosition=cur.scrollbar&&cur.scrollbar.data.scrollTop>100,(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.each)(e.events,(function(e,t){WComments.eventsParse(t)})),!0)},lpGetKey:function(){ajax.post("al_widget_comments.php",{act:"a_get_key",id:curNotifier.uid,app:cur.options.app,page_query:cur.options.page_query},{onDone:function(e,t){curNotifier.timestamp=t,curNotifier.key=e,this.lpCheck()}.bind(this),onFail:function(e){if(3!=e)return curNotifier.error_timeout=64,this.lp_error_to=setTimeout(this.lpGetKey.bind(this),1e3*curNotifier.error_timeout),curNotifier.error_timeout<64&&(curNotifier.error_timeout*=2),!0;location.reload()}.bind(this)})},resizePostSizedThumbs:function(e,t,i,o,_){let s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass)("page_post_thumb_wrap",e),r=[],a=0,n=0;const l=function(){a=n=0,(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.extend)(this,{tiles:[],height:0,x:0,y:0}),r.push(this)};let d=function(e){e&&(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.extend)(this,{el:e,lastRow:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(e,"page_post_thumb_last_row"),lastColumn:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(e,"page_post_thumb_last_column"),width:(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.intval)(e.style.width),height:(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.intval)(e.style.height)})},c=new l,u=(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_8__.positive)(e.style.width),p=(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_8__.positive)(e.style.height),h=0;if(t>u&&(t=null),(o>p||_&&s.length>1)&&(o=null),!o&&t)o=Math.round(p*(t/u));else if(o&&!t)t=Math.round(u*(o/p));else{if(!t||!o)return;_&&(o=Math.min(o,Math.round(p*(t/u))),t=Math.round(u*(o/p)))}return(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.each)(s,(function(e,t){let o=t.tile||new d(t),_=new d(s[e+1]);c.height=Math.max(c.height,o.height),u-a>=o.width/2?(a+=o.width+(o.lastColumn?0:i),n=o.height,o.x=c.x,o.y=c.y=0,c.tiles.push(o),o.lastColumn?_&&_.lastColumn&&c.height-n>=_.height/2||(c=new l):c.x++):o.lastColumn&&c.height-n>=o.height/2&&(n+=o.height+i,o.x=c.x,o.y=++c.y,c.tiles.push(o),!o.lastRow&&_&&_.lastColumn&&c.height-n>=_.height/2||(c.height=Math.max(c.height,n),c=new l))})),(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.each)(r,(function(e,_){let s=0,a=0,n=(t-i*_.x)/(u-i*_.x),l=(o-i*_.y)/(p-i*_.y),d=r.length-1==e?o-h:Math.round(_.height*l),c=0,m=0;h+=d+i,(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.each)(_.tiles,(function(e,o){o.x<_.x?(c=Math.round(o.width*n),s+=c+i,o.y||(m=d)):o.lastColumn&&(c=t-s,o.y==_.y?m=d-a:(m=Math.round(o.height*l),a+=m+i)),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.setStyle)(o.el,{width:c,height:m})}))})),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.setStyle)(e,{width:t,height:o}),[t,o]},resizePostAlbumWrap:function(e,t,i,o){o||(o="");let _=(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_8__.positive)(e.style.width),s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass1)("page"+o+"_album_thumb_wrap",e,"div"),r=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domFC)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass1)("page"+o+"_album_photos",e,"div")),a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domFC)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass1)("page"+o+"_album_under_row",e,"div"));if(scaleX=t/_,_<t)return;if(!s)return;(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.setStyle)(e,{width:t});let n=Math.round((0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_8__.positive)(s.style.width)*scaleX),l=Math.round((0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_8__.positive)(s.style.height)*scaleX);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.setStyle)(s,{width:n,height:l}),r&&WComments.resizePostSizedThumbs(r,t-i-n,i,l),a&&WComments.resizePostSizedThumbs(a,t,i,(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_8__.positive)(a.style.height)*((t-i)/(_-i)))},resizePost(e,t){let i=t?cur.options.reply_max_w:cur.options.max_w,o=Math.max(cur.options.kludges_min_h,i*(t?cur.options.reply_kludges_ratio:cur.options.kludges_ratio));return(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.each)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass)("page_album_wrap",e,"div"),(function(e,t){WComments.resizePostAlbumWrap(t,i,5)})),(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.each)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass)("page_market_album_wrap",e,"div"),(function(e,t){WComments.resizePostAlbumWrap(t,i-2,2,"_market")})),(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.each)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass)("page_post_sized_thumbs",e,"div"),(function(e,t){WComments.resizePostSizedThumbs(t,i,5,o,!0)})),(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.each)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass)("audio_pl_snippet",e,"div"),(function(e,t){let o;o=i<=cur.playlist_snippet_max_narrow_width?"audio_pl_snippet_size_narrow":i<=cur.playlist_snippet_max_medium_width?"audio_pl_snippet_size_medium":"",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.setStyle)(t,"width",i),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.removeClass)(t,"audio_pl_snippet_size_narrow"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.removeClass)(t,"audio_pl_snippet_size_medium"),o&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.addClass)(t,o)})),e},eventsQueue:[],eventsPaused:!1,eventsPause:function(){this.eventsPaused=!0},eventsProceed:function(){for(this.eventsPaused=!1;this.eventsQueue.length;)this.eventsParse(this.eventsQueue.shift())},eventsUpdateAttaches:function(e){(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.each)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass)("audio_row",e,"div"),(function(e,t){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.addClass)(t,"audio_no_actions")}))},eventsParse:function(e){if(this.eventsPaused)return this.eventsQueue.push(e);if((0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_8__.isObject)(e))return Wall.processQueueEvent(e);let t,i=e.split("<!>"),o=i[0],_=i[1],s=i[2],r=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("post"+s);if(o!=cur.options.qversion)return location.reload();switch(_){case"new_post":if(r)break;let a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("wcomments_posts");function n(){a.insertBefore(t,a.firstChild),(0,_web_stories_narrative_utils__WEBPACK_IMPORTED_MODULE_0__.updateNarrativeSnippetsFromQueueByPost)(t),(0,_web_articles_article_utils__WEBPACK_IMPORTED_MODULE_15__.updateArticleSnippetsFromQueueByPost)(t)}t=this.resizePost((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.se)(Wall.getNewPostHTML(i,cur.options.is_admin))),WComments.eventsUpdateAttaches(t),cur.saveScrollPosition?cur.scrollbar.updateAbove(n):(n(),cur.scrollbar&&cur.scrollbar.scrollTop(0,!0)),nodeUpdated(t),Wall.updateMentionsIndex(),"browse"!==cur.section&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)(cur.countEl,newCnt?(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang)("widgets_comments_top_count",newCnt):(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang)("widgets_comments"));break;case"del_post":r&&(!cur.wallMyDeleted[s]&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hide)(r),cur.options.offset--);break;case"res_post":r&&cur.options.offset++;break;case"new_reply":if(!r||cur.wallMyReplied[s]||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("post"+i[3]))break;let l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("replies"+s);t=this.resizePost((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.se)(Wall.getNewReplyHTML(i,cur.options.is_admin)),!0);let d=!1;if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.isVisible)("reply_link"+s))(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.re)("reply_link"+s),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.show)("replies_wrap"+s),d=!0;else{let c=l.nextSibling,u=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass)("new_reply",l,"div").length+1;if(cur.wallMyOpened[s]){c&&"replies_open"==c.className&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.re)(c),d=!0;let p=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass1)("wr_header",l,"a"),h=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass)("reply",l,"div").length+1,m=h;p&&(m=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.intval)(p.getAttribute("offs").split("/")[1])+1),(m>5||h<m)&&(p||(p=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ce)("a",{className:"wr_header"}),l.insertBefore(p,l.firstChild)),Wall.updateRepliesHeader(s,p,h,m))}else(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.addClass)(t,"new_reply"),c&&"replies_open"==c.className||(c=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ce)("div",{className:"replies_open",onclick:Wall.openNewComments.pbind(s)}),l.parentNode.insertBefore(c,l.nextSibling)),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)(c,(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang)("news_x_new_replies_more",Math.min(100,u))),c.newCnt=u}(0,_web_stories_narrative_utils__WEBPACK_IMPORTED_MODULE_0__.updateNarrativeSnippetsFromQueueByPost)(t),(0,_web_articles_article_utils__WEBPACK_IMPORTED_MODULE_15__.updateArticleSnippetsFromQueueByPost)(t),WComments.eventsUpdateAttaches(t),l.appendChild(t),d&&nodeUpdated(t);break;case"del_reply":!cur.wallMyDeleted[s]&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.re)(r)}this.resizeWidget()},override(e,t){const i=new RegExp(e.replace(/\.js$/,"\\.[0-9a-f]{8,20}\\.js$"));var o,_;if(Boolean(StaticFiles[e])||Object.keys(StaticFiles).some((function(e){return i.test(e)}))||!0===t)switch(e){case"lite.js":(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.extend)(window,{showTooltip:Widgets.showTooltip,showBox:Widgets.showBox({"al_photos.php":{photo_box:!0,choose_photo:!0},"al_video.php":{video_box:!0,a_choose_video_box:!0},"al_places.php":{show_photo_place:!0},"like.php":{publish_box:!0},"widget_like.php":{a_stats_box:!0},"al_wall.php":{canvas_draw_box:!0},"al_im.php":{stickers_store:!0,sticker_preview:!0},"al_audio.php":{choose_box:!0},"al_page.php":{owner_photo_box:!0},"al_voting.php":{export_box:!0},"docs.php":{show_box:!0}}),showReCaptchaBox:Widgets.showReCaptchaBox,gotSession(){location.reload()},showPhoto:Widgets.showPhoto,showVideo:Widgets.showVideo,shareAudioPlaylist:function(e){_shared_ranges__WEBPACK_IMPORTED_MODULE_18__.Ranges.isUserId(vk.id)?e.apply(null,[].slice.call(arguments,1)):Widgets.oauth()}.bind(null,shareAudioPlaylist),addAudio:function(e){_shared_ranges__WEBPACK_IMPORTED_MODULE_18__.Ranges.isUserId(vk.id)?e.apply(null,[].slice.call(arguments,1)):Widgets.oauth()}.bind(null,_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_1__.AudioUtils.addAudio),showWiki:function(e){if("likes"==(e=(e&&e.w||"").split("/"))[0])WComments.showLikesBox(e[1]);else{if("shares"!=e[0])return!0;WComments.showLikesBox(e[1],{tab:"published"})}},mentionOver:function(){return!0},mentionClick:function(){return!0},showInlineVideo:Widgets.showInlineVideo,revertLastInlineVideo:Widgets.revertLastInlineVideo,pauseLastInlineVideo:Widgets.pauseLastInlineVideo});break;case window.jsc("web/emoji.js"):(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.extend)(Emoji,{focus:function(e,t){if(Emoji.editableFocus(e,!1,!0),t&&cur.scrollbar){let t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domCA)(e,".reply_box");t&&cur.scrollbar.scrollIntoView(t)}}});break;case window.jsc("web/page.js"):(cur.options.is_auto||cur.options.is_nano)&&(Composer.init=(_=Composer.init,function(){let e=[].slice.call(arguments);return e[1].media&&(e[1].media.options=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.extend)(e[1].media.options||{},{hideAfterCount:0,maxShown:0,forceToUp:1})),_.apply(Wall,e)})),(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.extend)(Wall,{scrollHighlightReply:function(e){(e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)(e))&&(cur.options.fixed_height&&cur.scrollbar?cur.scrollbar.scrollIntoView(e,!0,Wall.highlightReply.bind(Wall,e)):(e.scrollIntoView(),Wall.highlightReply(e)))},postTooltip:(o=Wall.postTooltip,function(){let e=[].slice.call(arguments);return e[3]=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.extend)(e[3]||{},{appendEl:cur.postsOuterEl}),o.apply(this,e)}),sendPost:function(){if(!cur.sendPostBtn)return;let e=cur.wallAddMedia||{},t=e.chosenMedia||{},i=cur.wallAddMedia?e.getMedias():[],o=e.shareData||{},_=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.trim)((window.Emoji?Emoji.editableVal:_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("post_field"))),s=cur.options.suggesting?"suggest":cur.wallType,r={act:"post",message:_,to_id:cur.postTo,type:s,status_export:"",widget_app:cur.options.app,widget_page_url:cur.options.page_url,widget_page_title:cur.options.page_title,widget_page_desc:cur.options.page_desc,widget_page_query:cur.options.page_query,hash:cur.options.post_hash},a=0;if((0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_8__.isArray)(t)&&t.length&&i.push((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.clone)(t)),i.length){let t=!1;if((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.each)(i,(function(i,s){if(!s)return;let n=this[0],l=this[1];switch(n){case"poll":let i=e.pollData();if(!i)return t=!0,!1;l=i.media,delete i.media,r=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.extend)(r,i);break;case"share":if(o.share_upload_failed)break;if(o.failed||!o.url||!o.title&&(!o.images||!o.images.length)&&!o.photo_url)return cur.shareLastParseSubmitted&&(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_8__.vkNow)()-cur.shareLastParseSubmitted<2e3?(t=!0,!1):void 0;if(l=!o.noPhoto&&_shared_ranges__WEBPACK_IMPORTED_MODULE_18__.Ranges.isUserId(o.user_id)&&o.photo_id?o.user_id+"_"+o.photo_id:"",!l&&!o.share_own_image&&o.images&&o.images.length&&o.images.some((function(e){return(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_8__.isString)(e)&&e.length})))return e.uploadShare(Wall.sendPost),t=!0,!1;o.initialPattern&&(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.trim)(_)==o.initialPattern&&(r.message=""),o.is_vk_mini_app&&(r.is_vk_mini_app=!0,r.is_photo_edit=o.isPhotoEdit,r.image_offset=cur.shareShowImg),r=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.extend)(r,{url:o.url,module:cur.module,title:(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_8__.replaceEntities)(o.title),description:(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_8__.replaceEntities)(o.description),extra:o.extra,extra_data:o.extraData,mode:o.mode,photo_url:o.noPhoto?"":(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_8__.replaceEntities)(o.photo_url),open_graph_data:(o.openGraph||{}).data,open_graph_hash:(o.openGraph||{}).hash});break;case"page":o.initialPattern&&(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.trim)(_)==o.initialPattern&&(r.message="");break;case"postpone":let s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)("postpone_date"+e.lnkId);return r=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.extend)(r,{postpone:s}),void(cur.postponedLastDate=s)}this[3]&&(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.trim)(_)==this[3]&&(r.message=""),r["attach"+(a+1)+"_type"]=n,r["attach"+(a+1)]=l,a++})),t)return}if(!a&&!_)return void(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.elfocus)("post_field");let n=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("send_post");n&&buttonLocked(n)||(cur.postAutosave&&clearTimeout(cur.postAutosave),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hide)("submit_post_error"),cur.postSent=!0,setTimeout((function(){WComments.eventsPause(),ajax.post("al_wall.php",Wall.fixPostParams(r),{onDone:function(e){if(e){let t={act:"a_post",post:e,width:cur.options.width,startWidth:cur.options.startWidth,hash:cur.options.post_hash,app:cur.options.app,limit:cur.options.limit,export:(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_4__.isChecked)("wcomments_export")};ajax.post("al_widget_comments.php",t,{onDone:function(e,t){"posts"==cur.section&&cur.Rpc&&cur.Rpc.callMethod("publish","widgets.comments.new_comment",e.count,e.last_comment,e.date,e.full_hash,e.pageId),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)("wcomments_posts",t),WComments.contentUpdated(e),Wall.updateMentionsIndex(),WComments.eventsProceed()},onFail(){WComments.eventsProceed()},showProgress(){lockButton((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("send_post"))},hideProgress(){Wall.clearInput(),cur.postSent=!1;let e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("post_field");if(cur.withMentions){let t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.data)(e,"mention");t&&(t.rtaEl.innerHTML="",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hide)(t.cont),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.show)(e))}e.value="",e.blur(),e.phonblur(),Wall.hideEditPost(!0),cur.wallAddMedia&&cur.wallAddMedia.unchooseMedia(),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hide)("post_warn"),cur.onWallSendPost&&cur.onWallSendPost(),unlockButton((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("send_post"))}})}},onFail:function(e){return cur.postSent=!1,!e||((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("submit_post_error").innerHTML=e.length>60?'<div class="msg_text">'+e+"</div>":e,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.isVisible)("submit_post_error")||(0,_web_lib_fx__WEBPACK_IMPORTED_MODULE_10__.slideDown)("submit_post_error",100),!0)},showProgress:function(){lockButton(n)},hideProgress:function(){unlockButton(n)}})}),0))},sendReply:function(e,t,i){if(i=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.extend)({},i),window.mvcur&&mvcur.post==e)return Videoview.sendComment(e,t,i);let o,_,s=window.cur.wallLayer==e,r=s?wkcur:window.cur,a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("reply_field"+e),n=a&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.data)(a,"composer"),l=r.reply_to&&Wall.getReplyName(r.reply_to[0]),d=a&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.data)(a,"send");if(d&&(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.isFunction)(d))return d(e,t,i);if(i.stickerId)_={message:"",attach1_type:"sticker",attach1:i.stickerId,sticker_referrer:i.sticker_referrer};else{if(_=n?Composer.getSendParams(n,Wall.sendReply.pbind(e)):{message:(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.trim)(Emoji.editableVal(a))},_.delayed)return;if(!_.attach1_type&&(!_.message||(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_8__.isArray)(l)&&!l[1].indexOf(_.message)))return void Emoji.editableFocus((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("reply_field"+e),!1,!0);n?o=Composer.reset(n):window.Emoji&&Emoji.val(a,""),a.autosize&&a.autosize.update()}r.wallMyOpened=r.wallMyOpened||{},r.wallMyReplied[e]=1,r.wallMyOpened[e]=1;let c=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("post_hash"+e)?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("post_hash"+e).value:r.options.post_hash,u=null;if((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.extend)(_,{act:"post",type:"widget",width:r.options.width,startWidth:r.options.startWidth,reply_to:e,reply_to_msg:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)("reply_to"+e),reply_to_user:r.reply_to&&r.reply_to[0]||0,start_id:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)("start_reply"+e),from:"widget",hash:c}),r.reverse&&(_.rev=1),_shared_lib_browser__WEBPACK_IMPORTED_MODULE_2__.browser.mobile?Wall.hideEditReply(e):(Emoji.editableFocus(a,!1,!0),Wall.cancelReplyTo(e,t)),ajax.post("al_wall.php",Wall.fixPostParams(_),{onDone:function(t,i,o,_){if("full"==r.wallType)return FullWall.onReplySent.apply(window,arguments);r.wallMyReplied[e]=0,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.re)("reply_link"+e),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hide)("reply_warn"+e),Wall._repliesLoaded(e,!1,i,o,_)},onFail:function(){u&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.re)(u),n?o=Composer.restore(n,o):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)(a,_.message),a.autosize&&a.autosize.update()},showProgress:lockButton.pbind((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("reply_button"+e)),hideProgress:unlockButton.pbind((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("reply_button"+e))}),_.from_oid||!_.message)return;let p,h=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("replies"+e),m=-++r.wallMyRepliesCnt,E=Emoji.emojiToHTML((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.clean)(_.message),!0);p=_shared_ranges__WEBPACK_IMPORTED_MODULE_18__.Ranges.isGroupId(_.reply_to_user)?(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang)("wall_replied_to_group"):_shared_ranges__WEBPACK_IMPORTED_MODULE_18__.Ranges.isUserId(_.reply_to_user)?r.options.reply_names[_.reply_to_user]&&r.options.reply_names[_.reply_to_user][0]:null;let b=p?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.rs)(r.wallTpl.reply_link_to,{to_user:p}):"";if(u=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.se)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.rs)(r.wallTpl.reply_fast,{reply_id:"0_"+m,message:E.replace(/\n/g,"<br/>"),to_link:b,date:Wall.getNowRelTime(r)})),h&&!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.isVisible)(h)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("reply_link"+e))(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.re)("reply_link"+e),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.show)("replies_wrap"+e);else if(!r.onepost){let t=h.nextSibling;if(t&&"replies_open"==t.className&&Wall.openNewComments(e),!s){let t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass1)("wr_header",h,"a"),i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass)("reply",h,"div").length+1,o=i;t&&(o=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.intval)(t.getAttribute("offs").split("/")[1])+1),(o>5||i<o)&&(t||h.insertBefore(t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ce)("a",{className:"wr_header"}),h.firstChild),Wall.updateRepliesHeader(e,t,i,o))}}r.reverse?h.insertBefore(u,h.firstChild):h.appendChild(u)},deletePost:function(e,t,i,o,_){(cur.wallLayer?wkcur:cur).wallMyDeleted[t]=1;let s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("post"+t),r=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass1)("post_actions",s);ajax.post("al_wall.php",{act:"delete",post:t,hash:i,root:o?1:0,confirm:_?1:0,from:"widget"},{onDone:function(e,_,r){if(r){let _=showFastBox(e,r,(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang)("global_delete"),(function(){_.hide(),wall.deletePost(t,i,o,1)}),(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang)("box_cancel"));return}_&&"posts"==cur.section&&cur.Rpc&&cur.Rpc.callMethod("publish","widgets.comments.delete_comment",_.count,_.last_comment,_.date,_.full_hash,_.pageId);let a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass1)("_post_content",s)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass1)("feedback_row_t",s);(0,_web_lib_video__WEBPACK_IMPORTED_MODULE_3__.revertLastInlineVideo)(a);let n=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("post_del"+t);n?(n.innerHTML='<span class="dld_inner">'+e+"</span>",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.show)(n)):s.appendChild((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ce)("div",{id:"post_del"+t,className:"dld",innerHTML:'<span class="dld_inner">'+e+"</span>"})),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hide)(a),"post_publish"==(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domNS)(a).className&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hide)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domNS)(a)),"full_own"==cur.wallType||"full_all"==cur.wallType?(Pagination.recache(-1),FullWall.updateSummary(cur.pgCount)):"full"==cur.wallType&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(s,"reply")&&(cur.pgOffset--,cur.pgCount--,FullWall.repliesSummary(cur.pgCount)),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(s,"suggest")?Wall.suggestUpdate(-1):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(s,"postponed")||"own"!=cur.wallType&&"all"!=cur.wallType||((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(s,"own")&&++cur.deletedCnts.own,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(s,"all")&&++cur.deletedCnts.all,Wall.update()),WComments.contentUpdated()},showProgress:function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(e,"ui_actions_menu_item")?lockActionsMenuItem(e):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(e,"flat_button")?lockButton(e):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.addClass)(r,"post_actions_progress")},hideProgress:function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(e,"ui_actions_menu_item")?unlockActionsMenuItem(e):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(e,"flat_button")?unlockButton(e):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.removeClass)(r,"post_actions_progress")}});let a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("delete_post"+t);a&&a.tt&&a.tt.el&&a.tt.destroy()},restorePost:function(e,t,i){return(cur.wallLayer?wkcur:cur).wallMyDeleted[e]=0,ajax.post("al_wall.php",{act:"restore",post:e,hash:t,root:i?1:0,from:"widget"},{onDone:function(){let t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("post_del"+e);if(!t)return;let i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("post"+e),o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass1)("_post_content",i)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass1)("feedback_row_t",i);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.show)(o),"post_publish"==(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domNS)(o).className&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.show)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domNS)(o)),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hide)(t),"full_own"==cur.wallType||"full_all"==cur.wallType?(Pagination.recache(1),FullWall.updateSummary(cur.pgCount)):"full"==cur.wallType&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(i,"reply")&&(cur.pgOffset++,cur.pgCount++,FullWall.repliesSummary(cur.pgCount)),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(i,"suggest")?Wall.suggestUpdate(1):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(i,"postponed")||"own"!=cur.wallType&&"all"!=cur.wallType||((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(i,"own")&&--cur.deletedCnts.own,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(i,"all")&&--cur.deletedCnts.all,Wall.update()),WComments.contentUpdated()}}),!1},postClick:function(e,t,i){let o,_=(e||"").match(/^(-?\d+)_(wall)?(\d+)$/),s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("post"+e);if(o=!(!i||!i.skipCheck)||Wall.checkPostClick(s,t),o){if(!0!==o){let e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass1)("wall_post_more",o,"a");if(e&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.isVisible)(e))return e.onclick(),void(_||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.removeClass)(s,"wall_post_over"))}_&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("wcomments_posts"),"no_post_click")||window.open("wall"+_[1]+"_"+_[3],"_blank"))}},_repliesLoaded:function(e,t,i,o){let _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("replies"+e);if(!_)return;t?(cur.options.fixed_height&&cur.scrollbar?cur.scrollbar.updateAbove((function(){_.innerHTML=i})):_.innerHTML=i,setTimeout(Wall.scrollHighlightReply.pbind("post"+t),0)):_.innerHTML=i;let s=_.nextSibling;s&&"replies_open"==s.className&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.re)(s),(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.extend)(cur.options.reply_names||{},o),Wall.updateMentionsIndex()},checkTextLen:function(){},checkPostLen:function(){},replySubmitTooltip:function(){},repliesSideSetup:function(){},repliesSideClick:function(){},likesShow:function(e,t,i){i=i||{};let o=wall.parsePostId(t),_=o.type,s=o.id,r=_+s,a=e&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.gpeByClass)("_post_content",e)||wall.domPost(s),n=i.share?"_share_wrap":"_like_wrap",l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domByClass)(a,n),d=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domByClass)(l,"_icon"),c=a&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domByClass)(a,"_share_wrap");if(!d||cur.viewAsBox)return;let u=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.getXY)(l)[0],p=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.getXY)(d)[0]+(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.getSize)(d,!0)[0]/2-u-56;(0,_web_lib_tooltip_utils__WEBPACK_IMPORTED_MODULE_9__.showTooltip)(d.parentNode,{url:"/like.php",params:(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.extend)({act:"a_get_stats",object:r,has_share:c?1:""},i.share?{published:1}:{}),slide:15,shift:[-p,-3],ajaxdt:100,showdt:400,hidedt:200,dir:"auto",checkLeft:!0,reverseOffset:80,appendEl:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("page_wrap"),tip:{over:function(){Wall.likesShow(e,t,i)}},typeClass:"like_tt wcomments_like_tt",className:i.cl||""})},showReplies:function(e,t,i,o){if(!(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_11__.checkEvent)(o||window.event))return cur.viewAsBox?cur.viewAsBox():(cur.wallMyOpened[e]=3!=t,ajax.post("al_wall.php",{act:"get_replies",width:cur.options.width,startWidth:cur.options.startWidth,post:e,count:t,from:"widget"},{onDone:function(){let t=[].slice.call(arguments);t.unshift(e,i),Wall._repliesLoaded.apply(Wall,t),WComments.resizeWidget()},showProgress:lockButton.pbind("wrh"+e),hideProgress:unlockButton.pbind("wrh"+e)}),!1)}}),(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.each)(["showEditReply","markAsSpam","stickerClick","likeIt"],(function(e,t){var i;Wall[t]=(i=Wall[t],function(){if(_shared_ranges__WEBPACK_IMPORTED_MODULE_18__.Ranges.isUserId(vk.id))return i.apply(Wall,[].slice.call(arguments));Widgets.oauth()})}))}}};try{window.stManager.done(window.jsc("api/widgets/comments.js"))}catch(e){}},73215:(e,t,i)=>{i.d(t,{apiAudioToAudioTuple:()=>a});var o=i(64639),_=i(59397),s=i(6327),r=i(24248);const a=e=>{var t,i,a,n,l,d,c,u,p,h,m,E;return e?[e.id,e.owner_id,e.url||"",(0,o.clean)(e.title),(0,o.clean)(e.artist||e.performer||""),e.duration,e.album_id||0,0,"",e.lyrics_id||0,0,"","[]",(0,s.getAudioHashesString)({addHash:e.access_key,editHash:e.access_key,actionHash:e.access_key,deleteHash:e.access_key,replaceHash:e.access_key,urlHash:e.access_key,restoreHash:e.access_key}),(null==(i=e.album)||null==(t=i.thumb)?void 0:t.sizes)?(null==(a=(0,_.getPhotoSize)((null==(l=e.album)||null==(n=l.thumb)?void 0:n.sizes)||[],(0,r.getImageMinWidth)(200)))?void 0:a.url)||"":`${null==(c=e.album)||null==(d=c.thumb)?void 0:d.photo_300},${null==(p=e.album)||null==(u=p.thumb)?void 0:u.photo_135}`||"",e.ads||{},(0,o.clean)(e.subtitle||""),e.main_artists||"",e.featured_artists||"",!!e.album&&[null==(h=e.album)?void 0:h.owner_id,null==(m=e.album)?void 0:m.id,null==(E=e.album)?void 0:E.access_key],e.track_code||"",e.content_restricted||0,e.album_part_number||0,!0,e.access_key||"",e.audio_chart_info||!1,""]:null}},9569:(e,t,i)=>{i.d(t,{AUDIO_PLAYER_ADAPTER_HASHES_SEPARATOR:()=>o});const o="/"},6327:(e,t,i)=>{i.d(t,{getAudioHashesString:()=>_});var o=i(9569);const _=({addHash:e,editHash:t,actionHash:i,deleteHash:_,replaceHash:s,urlHash:r,restoreHash:a})=>[e||"",t||"",i||"",_||"",s||"",r||"",a||""].join(o.AUDIO_PLAYER_ADAPTER_HASHES_SEPARATOR)},30771:(e,t,i)=>{i.d(t,{createCacheService:()=>_});var o=i(92923);const _=e=>{const t=(0,o.getEffectorServiceDomain)(e),i=Object.create(null),_=t.createStore(Object.create(null)),s=t.createEvent("add"),r=t.createEvent("delete");return _.on(s,((e,{key:t,data:i})=>(e[t]=i,e))).on(r,((e,t)=>(delete e[t],e))),{$cache:_,add:s,delete:r,get:e=>_.getState()[e]||null,isWaited:e=>void 0!==i[e],getWaited:e=>i[e],setWaited:(e,t)=>{i[e]=t},deleteWaited:e=>{delete i[e]}}}},37328:(e,t,i)=>{i.d(t,{createUserService:()=>o.createUserService});var o=i(9258);i(21209)},21209:(e,t,i)=>{i(34788),i(98116),i(62888),i(83668);var o=i(30771);i(92923),i(44471);(0,o.createCacheService)()},9258:(e,t,i)=>{i.d(t,{createUserService:()=>a});var o=i(11010),_=i(34788),s=i(98116),r=i(62888);const a=({domain:e})=>{const t=(e,t)=>!(!e||e.id!==t.userId),i=e.createStore(null),a=e.createEffect((({params:e})=>(0,r.apiWithPrefetch)("users.get",e))),n=e.createEffect((0,o._)((function*(e){return{userId:e.params.owner_id,response:yield(0,r.api)("wall.subscribe",e.params)}}))),l=e.createEffect((0,o._)((function*(e){return{userId:e.params.owner_id,response:yield(0,r.api)("wall.unsubscribe",e.params)}}))),d=e.createEffect((0,o._)((function*(e){return{userId:e.params.owner_id,response:yield(0,r.api)("video.liveSubscribe",e.params)}}))),c=e.createEffect((0,o._)((function*(e){return{userId:e.params.owner_id,response:yield(0,r.api)("video.liveUnsubscribe",e.params)}}))),u=e.createEffect((0,o._)((function*(e){return{userId:e.params.user_id,response:yield(0,r.api)("fave.addUser",e.params)}}))),p=e.createEffect((0,o._)((function*(e){return{userId:e.params.user_id,response:yield(0,r.api)("fave.removeUser",e.params)}}))),h=e.createEffect((0,o._)((function*(e){return{userId:e.params.owner_id,response:yield(0,r.api)("account.ban",e.params)}}))),m=e.createEffect((0,o._)((function*(e){return{userId:e.params.owner_id,response:yield(0,r.api)("account.unban",e.params)}}))),E=e.createEffect((0,o._)((function*(e){return{userId:e.params.user_id,response:yield(0,r.api)("bestFriends.add",e.params)}}))),b=e.createEffect((0,o._)((function*(e){return{userId:e.params.user_id,response:yield(0,r.api)("bestFriends.delete",e.params)}})));return(0,s.sample)({clock:a.doneData,fn:e=>e[0]||null,target:i}),(0,s.sample)({clock:n.doneData,source:i,filter:t,fn:e=>(0,_._)({},e,{is_subscribed:1}),target:i}),(0,s.sample)({clock:l.doneData,source:i,filter:t,fn:e=>(0,_._)({},e,{is_subscribed:0}),target:i}),(0,s.sample)({clock:d.doneData,source:i,filter:t,fn:e=>(0,_._)({},e,{video_live:e.video_live?(0,_._)({},e.video_live,{is_notifications_blocked:0}):void 0}),target:i}),(0,s.sample)({clock:c.doneData,source:i,filter:t,fn:e=>(0,_._)({},e,{video_live:e.video_live?(0,_._)({},e.video_live,{is_notifications_blocked:1}):void 0}),target:i}),(0,s.sample)({clock:u.doneData,source:i,filter:t,fn:e=>(0,_._)({},e,{is_favorite:1}),target:i}),(0,s.sample)({clock:p.doneData,source:i,filter:t,fn:e=>(0,_._)({},e,{is_favorite:0}),target:i}),(0,s.sample)({clock:h.doneData,source:i,filter:t,fn:e=>(0,_._)({},e,{blacklisted_by_me:1}),target:i}),(0,s.sample)({clock:m.doneData,source:i,filter:t,fn:e=>(0,_._)({},e,{blacklisted_by_me:0}),target:i}),(0,s.sample)({clock:E.doneData,source:i,filter:t,fn:e=>(0,_._)({},e,{is_best_friend:!0}),target:i}),(0,s.sample)({clock:b.doneData,source:i,filter:t,fn:e=>(0,_._)({},e,{is_best_friend:!1}),target:i}),{fetchUserFx:a,subscribeToPostsFx:n,unsubscribeFromPostsFx:l,subscribeToVideoLiveFx:d,unsubscribeFromVideoLiveFx:c,faveAddUserFx:u,faveRemoveUserFx:p,accountBanFx:h,accountUnbanFx:m,bestFriendAddFx:E,bestFriendDeleteFx:b,$user:i,domain:e}}},79462:(e,t,i)=>{i.d(t,{apiFaveAddNarrative:()=>_,apiFaveRemoveNarrative:()=>s});var o=i(62888);function _(e){return(0,o.api)("fave.addNarrative",e)}function s(e){return(0,o.api)("fave.removeNarrative",e)}},90694:(e,t,i)=>{i.d(t,{createFaveService:()=>o.createFaveService});i(79462);var o=i(77433)},77433:(e,t,i)=>{i.d(t,{createFaveService:()=>s});var o=i(98116),_=i(79462);const s=({domain:e})=>{const t=e.createEvent("fire/faveAddNarrative"),i=e.createEvent("fire/faveRemoveNarrative"),s=e.createEffect("fx/faveAddNarrative"),r=e.createEffect("fx/faveRemoveNarrative");return s.use(_.apiFaveAddNarrative),r.use(_.apiFaveRemoveNarrative),(0,o.sample)({clock:t,target:s}),(0,o.sample)({clock:i,target:r}),{fireAddNarrative:t,fireRemoveNarrative:i,addNarrativeFx:s,removeNarrativeFx:r}}},98442:(e,t,i)=>{i.d(t,{findOwnerById:()=>_});var o=i(26525);const _=(e=0,t=[],i=[])=>{if(e)return o.Ranges.isUserId(e)?t.find((t=>{var i;return(null==(i=t)?void 0:i.id)===e})):i.find((t=>{var i;return(null==(i=t)?void 0:i.id)===Math.abs(e)}))}},60091:(e,t,i)=>{var o,_,s,r,a,n,l,d;i.d(t,{StickerTypes:()=>n,StoryBlockType:()=>r,StoryListName:()=>a,StoryPollBackgroundType:()=>d,StoryStickerSubtype:()=>l,StoryType:()=>o}),function(e){e.PHOTO="photo",e.VIDEO="video",e.LIVE="live"}(o||(o={})),function(e){e.SWIPE="swipe",e.NAVIGATION_BUTTON="navigation_button",e.SIT_POSTING="sit_posting",e.LINK="link",e.STORY_REPLY="story_reply",e.STORY_REPOST="story_repost",e.CATALOG_ADD="catalog_add",e.DIALOG="dialog",e.STORY_LIVE_FINISHED="story_live_finished",e.DIALOG_VKME="dialog_vkme",e.STORY_VIEWER_FINISHED="story_viewer_finished",e.PUSH_TRY_MASK="push_try_mask",e.STORY_VIEWER_TRY_MASK="story_viewer_try_mask",e.LINK_MASK="link_mask",e.POSTING="posting",e.NEW_STORY_AVATAR="new_story_avatar",e.STORY_REPLIES_LIST="story_replies_list",e.STORIES_FEED="stories_feed",e.STORIES_SEARCH_NEWS="stories_search_news",e.QUESTION_STICKER="question_sticker",e.LIST_MIDDLE="list_middle",e.ARCHIVE_EMPTY_BUTTON="archive_empty_button",e.ARCHIVE_MENU_BUTTON="archive_menu_button",e.IM="im",e.PROFILE_BUTTON="profile_button",e.SHARE="share",e.MINI_APP="mini_app",e.SYSTEM_SHARING="system_sharing",e.SHORTCUT="shortcut",e.ARCHIVE_SHARING="archive_sharing",e.STORY_VIEWER_CAMERA_BUTTON="story_viewer_camera_button",e.STORY_VIEWER_MUSIC="story_viewer_music",e.STORY_VIEWER_MUSIC_SHEET="story_viewer_music_sheet",e.REPOST_TO_STORY_ACTIVITY="repost_to_story_activity",e.CHANGE_AVATAR="change_avatar"}(_||(_={})),function(e){e.FEED="feed",e.FEED_MIDDLE="feed_middle",e.LINK="link",e.PROFILE="profile",e.IM_DIALOGS="im_dialogs",e.IM_DIALOG_HEADER="im_dialog_header",e.SNIPPET="snippet",e.REPLY="reply",e.REPLIES_LIST="replies_list",e.REPLY_STORY="reply_story",e.DISCOVER="discover",e.STORIES_MANAGE="stories_manage",e.USER_PERSONAL_CARD="user_personal_card",e.GROUP_PERSONAL_CARD="group_personal_card",e.NARRATIVE_SNIPPET="narrative_snippet",e.NARRATIVE_STORY="narrative_story",e.NARRATIVE_LINK="narrative_link",e.NARRATIVE_RECOMMENDATIONS="narrative_recommendations",e.NARRATIVE_SECTION="narrative_section",e.FAVE="fave",e.SPAMFEED="sf",e.ADS_PREVIEW="ads_preview",e.LIST_MIDDLE="list_middle",e.PLACE_STORY_LIST="place_story_list",e.SEARCH_STORY_LIST="search_story_list",e.STORY_ARCHIVE="story_archive",e.IM_MSG_LIST="im_msg_list",e.NOSPAM="nospam",e.PROFILE_SNACKBAR="profile_snackbar",e.MY_QUESTIONS="question_story"}(s||(s={})),function(e){e.stories="stories",e.appGroupedStories="app_grouped_stories",e.discover="discover"}(r||(r={})),function(e){e.feed="feed",e.apps="apps",e.discover="discover"}(a||(a={})),function(e){e[e.hashtag=1]="hashtag",e[e.mention=2]="mention",e[e.question=3]="question",e[e.place=4]="place",e[e.music=5]="music",e[e.storyReply=6]="storyReply",e[e.owner=7]="owner",e[e.link=8]="link",e[e.marketItem=9]="marketItem",e[e.post=10]="post",e[e.poll=11]="poll",e[e.sticker=12]="sticker",e[e.app=13]="app",e[e.situationalTheme=14]="situationalTheme",e[e.playlist=15]="playlist",e[e.videoButton=16]="videoButton"}(n||(n={})),function(e){e.aliexpress="aliexpress_product",e.market="market_item"}(l||(l={})),function(e){e.photo="photo",e.gradient="gradient",e.default="default"}(d||(d={}))},74476:(e,t,i)=>{i.d(t,{apiLikesAdd:()=>_,apiLikesDelete:()=>s});var o=i(62888);function _(e){return(0,o.api)("likes.add",e)}function s(e){return(0,o.api)("likes.delete",e)}},29986:(e,t,i)=>{var o;!function(e){e.Story="story"}(o||(o={}))},20602:(e,t,i)=>{i.d(t,{createLikesService:()=>o.createLikesService});var o=i(25347);i(74476),i(29986)},25347:(e,t,i)=>{i.d(t,{createLikesService:()=>s});var o=i(98116),_=i(74476);const s=({domain:e})=>{const t=e.createEvent("fire/likesAdd"),i=e.createEvent("fire/likesDelete"),s=e.createEffect("fx/likesAdd"),r=e.createEffect("fx/likesDelete");return s.use(_.apiLikesAdd),r.use(_.apiLikesDelete),(0,o.sample)({clock:t,target:s}),(0,o.sample)({clock:i,target:r}),{fireAdd:t,fireDelete:i,addFx:s,deleteFx:r}}},328:(e,t,i)=>{i.d(t,{apiMessagesSend:()=>_});var o=i(62888);function _(e){return(0,o.api)("messages.send",e)}},25959:(e,t,i)=>{i.d(t,{createMessagesService:()=>o.createMessagesService});i(328);var o=i(35355)},35355:(e,t,i)=>{i.d(t,{createMessagesService:()=>s});var o=i(98116),_=i(328);const s=({domain:e})=>{const t=e.createEvent("fire/messageSend"),i=e.createEffect("fx/messageSend");return i.use(_.apiMessagesSend),(0,o.sample)({clock:t,target:i}),{fireMessagesSend:t,sendFx:i}}},30782:(e,t,i)=>{i.d(t,{apiNarrativesBatchEdit:()=>r,apiNarrativesCreate:()=>_,apiNarrativesDelete:()=>a,apiNarrativesEdit:()=>s,apiNarrativesGetById:()=>n,apiNarrativesGetFeedBlock:()=>l,apiNarrativesGetFromOwner:()=>d,apiNarrativesReorder:()=>u,apiNarrativesSaveCustomCover:()=>c});var o=i(62888);function _(e){return(0,o.api)("narratives.create",e)}function s(e){return(0,o.api)("narratives.edit",e)}function r(e){return(0,o.api)("narratives.batchEdit",e)}function a(e){return(0,o.api)("narratives.delete",e)}function n(e){return(0,o.api)("narratives.getById",e)}function l(e={}){return(0,o.api)("narratives.getFeedBlock",e)}function d(e){return(0,o.api)("narratives.getFromOwner",e)}function c(e){return(0,o.api)("narratives.saveCustomCover",e)}function u(e){return(0,o.api)("narratives.reorder",e)}},19565:(e,t,i)=>{i.d(t,{apiNarrativesGetById:()=>_.apiNarrativesGetById,apiNarrativesGetFeedBlock:()=>_.apiNarrativesGetFeedBlock,apiNarrativesGetFromOwner:()=>_.apiNarrativesGetFromOwner,createNarrativesService:()=>o.createNarrativesService});var o=i(36482),_=i(30782)},36482:(e,t,i)=>{i.d(t,{createNarrativesService:()=>s});var o=i(98116),_=i(30782);const s=({domain:e})=>{const t=e.createEvent("fire/narrativesGetById"),i=e.createEvent("fire/narrativesGetFromOwner"),s=e.createEvent("fire/narrativesGetFeedBlock"),r=e.createEvent("fire/narrativesCreate"),a=e.createEvent("fire/narrativesEdit"),n=e.createEvent("fire/narrativesBatchEdit"),l=e.createEvent("fire/narrativesDelete"),d=e.createEvent("fire/narrativesSaveCustomCover"),c=e.createEvent("fire/narrativesReorder"),u=e.createEffect("fx/narrativesGetById"),p=e.createEffect("fx/narrativesGetFromOwner"),h=e.createEffect("fx/narrativesGetFeedBlock"),m=e.createEffect("fx/narrativesCreate"),E=e.createEffect("fx/narrativesEdit"),b=e.createEffect("fx/narrativesBatchEdit"),w=e.createEffect("fx/narrativesDelete"),f=e.createEffect("fx/narrativesSaveCustomCover"),g=e.createEffect("fx/narrativesReorder");return u.use(_.apiNarrativesGetById),p.use(_.apiNarrativesGetFromOwner),h.use(_.apiNarrativesGetFeedBlock),m.use(_.apiNarrativesCreate),E.use(_.apiNarrativesEdit),b.use(_.apiNarrativesBatchEdit),w.use(_.apiNarrativesDelete),f.use(_.apiNarrativesSaveCustomCover),g.use(_.apiNarrativesReorder),(0,o.sample)({clock:t,target:u}),(0,o.sample)({clock:i,target:p}),(0,o.sample)({clock:s,target:h}),(0,o.sample)({clock:r,target:m}),(0,o.sample)({clock:a,target:E}),(0,o.sample)({clock:n,target:b}),(0,o.sample)({clock:l,target:w}),(0,o.sample)({clock:d,target:f}),(0,o.sample)({clock:c,target:g}),{fireGetById:t,fireGetFromOwner:i,fireGetFeedBlock:s,fireCreate:r,fireEdit:a,fireBatchEdit:n,fireDelete:l,fireSaveCustomCover:d,fireReorder:c,getByIdFx:u,getFromOwnerFx:p,getFeedBlockFx:h,createFx:m,editFx:E,batchEditFx:b,deleteFx:w,saveCustomCoverFx:f,reorderFx:g}}},75536:(e,t,i)=>{function o(e,t=","){return e&&e.length?e.reduce(((e,i)=>{const o="rawId"in i?i.rawId:`${i.owner_id}_${i.id}`;return o&&(e+=`${e.length?t:""}${o}`),e}),""):""}i.d(t,{joinNarrativeRawIds:()=>o})},57206:(e,t,i)=>{i.d(t,{getPhotoSize:()=>o});function o(e,t){var i,o,_,s;if(!(null==(o=e)||null==(i=o.sizes)?void 0:i.length))return"";const r=[...e.sizes].sort(((e,t)=>e.width-t.width));let a=r.find((e=>e.width>=t));return(null==(_=a)?void 0:_.url)?a.url:(a=r.reverse().find((e=>e.width<t)),(null==(s=a)?void 0:s.url)?a.url:"")}},28262:(e,t,i)=>{i.d(t,{apiPollsCreate:()=>s,apiPollsGetById:()=>_});var o=i(62888);function _(e){return(0,o.api)("polls.getById",e)}function s(e){return(0,o.api)("polls.create",e)}},656:(e,t,i)=>{i.d(t,{createPollsService:()=>o.createPollsService});i(28262);var o=i(673)},673:(e,t,i)=>{i.d(t,{createPollsService:()=>s});var o=i(98116),_=i(28262);const s=({domain:e})=>{const t=e.createEvent("fire/pollsGetById"),i=e.createEvent("fire/pollsCreate"),s=e.createEffect("fx/pollsGetById"),r=e.createEffect("fx/pollsCreate");return s.use(_.apiPollsGetById),r.use(_.apiPollsCreate),(0,o.sample)({clock:t,target:s}),(0,o.sample)({clock:i,target:r}),{fireGetById:t,fireCreate:i,getByIdFx:s,createFx:r}}},410:(e,t,i)=>{i.d(t,{ArticleTtsActionType:()=>o,articleTtsActionStatController:()=>s});var o,_=i(34015);!function(e){e.START="start",e.PAUSE="pause",e.CONTINUE="continue",e.SEEK="seek",e.CLOSE="close",e.P10="10p",e.P25="25p",e.P50="50p",e.P75="75p",e.P95="95p",e.P99="99p",e.P100="100p"}(o||(o={}));const s=new class{logEvent(e,t){const i={type:"type_marusia_reading_item",type_marusia_reading_item:e};this.actionStatCollector.logEvent(i,t)}constructor(){this.productStatCollector=new _.ProductionStatCollector,this.actionStatCollector=new _.ActionStatCollector(this.productStatCollector)}}},41378:(e,t,i)=>{i.d(t,{apiStatsTrackEvents:()=>_});var o=i(62888);function _(e){return(0,o.api)("stats.trackEvents",e)}},12941:(e,t,i)=>{i.d(t,{STATS_EVENT_TYPE_STORIES_VIEWER_NAVIGATION:()=>o,STATS_EVENT_TYPE_STORIES_VIEWING_START_TIME:()=>_});const o="stories_viewer_navigation",_="stories_viewing_start_time"},14246:(e,t,i)=>{i.d(t,{createStatsService:()=>o.createStatsService});i(41378);var o=i(23231)},23231:(e,t,i)=>{i.d(t,{createStatsService:()=>s});var o=i(98116),_=i(41378);const s=({domain:e})=>{const t=e.createEvent("fire/statsTrackEvents"),i=e.createEffect("fx/statsTrackEvents");return i.use(_.apiStatsTrackEvents),(0,o.sample)({clock:t,target:i}),{fireTrackEvents:t,trackEventsFx:i}}},45492:(e,t,i)=>{i.d(t,{apiStoriesAskQuestion:()=>g,apiStoriesBanOwner:()=>A,apiStoriesBanQuestionAuthor:()=>P,apiStoriesDelete:()=>f,apiStoriesDeleteQuestion:()=>v,apiStoriesGet:()=>_,apiStoriesGetArchive:()=>n,apiStoriesGetById:()=>r,apiStoriesGetDetailedStats:()=>p,apiStoriesGetDiscover:()=>a,apiStoriesGetPhotoUploadServer:()=>T,apiStoriesGetQuestions:()=>c,apiStoriesGetReplies:()=>d,apiStoriesGetStats:()=>u,apiStoriesGetVideoUploadServer:()=>I,apiStoriesGetViewers:()=>l,apiStoriesGetWithPrefetch:()=>s,apiStoriesHideAllReplies:()=>B,apiStoriesHidePrivacyBlock:()=>w,apiStoriesHideReply:()=>k,apiStoriesMarkAppNotificationsSeen:()=>O,apiStoriesMarkNotInterested:()=>m,apiStoriesMarkSeen:()=>b,apiStoriesMarkSkipped:()=>h,apiStoriesSave:()=>C,apiStoriesSearch:()=>E,apiStoriesSetDiscoverVisible:()=>y,apiStoriesSubscribeUserToApp:()=>D,apiStoriesUnbanOwner:()=>S,apiStoriesUnbanQuestionAuthor:()=>M});var o=i(62888);function _(e){return(0,o.api)("stories.get",e)}function s(e){return(0,o.apiWithPrefetch)("stories.get",e)}function r(e){return(0,o.api)("stories.getById",e)}function a(e){return(0,o.api)("stories.getDiscover",e)}function n(e){return(0,o.api)("stories.getArchive",e)}function l(e){return(0,o.api)("stories.getViewers",e)}function d(e){return(0,o.api)("stories.getReplies",e)}function c(e){return(0,o.api)("stories.getQuestions",e)}function u(e){return(0,o.api)("stories.getStats",e)}function p(e){return(0,o.api)("stories.getDetailedStats",e)}function h(e){return(0,o.api)("stories.markSkipped",e)}function m(e){return(0,o.api)("stories.markNotInterested",e)}function E(e){return(0,o.api)("stories.search",e)}function b(e){return(0,o.api)("stories.markSeen",e)}function w(e){return(0,o.api)("stories.hidePrivacyBlock",e)}function f(e){return(0,o.api)("stories.delete",e)}function g(e){return(0,o.api)("stories.askQuestion",e)}function v(e){return(0,o.api)("stories.deleteQuestion",e)}function P(e){return(0,o.api)("stories.banQuestionAuthor",e)}function M(e){return(0,o.api)("stories.unbanQuestionAuthor",e)}function O(e){return(0,o.api)("stories.markAppNotificationsSeen",e)}function D(e){return(0,o.api)("stories.subscribeUserToApp",e)}function T(e){return(0,o.api)("stories.getPhotoUploadServer",e)}function I(e){return(0,o.api)("stories.getVideoUploadServer",e)}function C(e){return(0,o.api)("stories.save",e)}function A(e){return(0,o.api)("stories.banOwner",e)}function S(e){return(0,o.api)("stories.unbanOwner",e)}function y(e){return(0,o.api)("stories.setDiscoverVisible",e)}function k(e){return(0,o.api)("stories.hideReply",e)}function B(e){return(0,o.api)("stories.hideAllReplies",e)}},30822:(e,t,i)=>{i.d(t,{STORIES_ARCHIVE_START_TIME:()=>o});const o=1559032200},77586:(e,t,i)=>{var o,_=i(25714),s=i(27879);!function(e){e[e.getViewers=0]="getViewers",e[e.getReplies=1]="getReplies",e[e.getQuestions=2]="getQuestions",e[e.getDetailedStats=3]="getDetailedStats",e[e.getStats=4]="getStats"}(o||(o={}));_.storiesDomain.createEffect({name:"fire/storiesGetFeedback",handler:({ownerId:e,storyId:t,pollId:i})=>{const o=((e,t)=>({0:{owner_id:e,story_id:t,extended:1,count:100,fields:(0,s.makeOwnerFields)(["is_nft","photo_100","photo_50"])},1:{owner_id:e,story_id:t,extended:1,fields:(0,s.getStoryOwnerFields)()},2:{owner_id:e,story_id:t,extended:1,fields:(0,s.makeOwnerFields)(["domain","first_name_dat","first_name_ins","last_name_ins","last_name_dat","first_name_gen","last_name_gen"]),count:30},3:{owner_id:e,story_id:t},4:{owner_id:e,story_id:t}}))(e,t);return Promise.allSettled([_.storiesService.getViewersFx(o[0]),_.storiesService.getRepliesFx(o[1]),_.storiesService.getQuestionsFx(o[2]),i?_.pollsService.getByIdFx({owner_id:e,poll_id:i}):Promise.resolve(null),_.storiesService.getDetailedStatsFx(o[3]),_.storiesService.getStatsFx(o[4])]).then((e=>e.map((e=>{var t;return"fulfilled"===e.status?null==(t=e)?void 0:t.value:null}))))}})},36782:(e,t,i)=>{i.d(t,{STORIES_ARCHIVE_START_TIME:()=>r.STORIES_ARCHIVE_START_TIME,apiStoriesGet:()=>s.apiStoriesGet,apiStoriesGetArchive:()=>s.apiStoriesGetArchive,apiStoriesGetById:()=>s.apiStoriesGetById,apiStoriesGetDiscover:()=>s.apiStoriesGetDiscover,apiStoriesGetReplies:()=>s.apiStoriesGetReplies,apiStoriesGetWithPrefetch:()=>s.apiStoriesGetWithPrefetch,apiStoriesSearch:()=>s.apiStoriesSearch,createStoriesService:()=>o.createStoriesService,decodeBase64:()=>_.decodeBase64});var o=i(47608),_=i(57030),s=(i(26511),i(45492)),r=i(30822);i(25714),i(77586)},56959:(e,t,i)=>{i.d(t,{fetchList:()=>P});var o=i(13989),_=i(36782),s=i(19565),r=i(27879),a=i(18982),n=i(75536),l=i(72516);const d=/^feed$/,c=/^discover$/,u=/(-?\d+)_(\d+)/,p=/^owner_feed(-?\d+)/,h=/^replies(-?\d+)_(\d+)/,m=/^narrative(-?\d+)_(\d+)$/,E=/^narratives(-?\d+)$/,b=/^recommended_narratives$/,w=/^archive(?:(-?\d+)_)?([0-9]+)/,f=/^search_([\w|-]+)/,g=/^place(\d+)/,v=(0,l.partConfigEnabled)("mvk_feed_stories_block_async_with_prefetch");function P(e,t){let i=e.match(d);if(i)return(v?_.apiStoriesGetWithPrefetch:_.apiStoriesGet)({fields:(0,r.getStoryOwnerFields)(),extended:1}).then((t=>{var i;return{list:(0,o.transformStoryGetApiResponseToLegacyFormat)(t,e,(0,a.isMvk)()),nextFrom:(null==(i=t)?void 0:i.next_from)||"",response:t}}));var l,P,O;if(i=e.match(c),i)return(0,_.apiStoriesGetDiscover)({count:null==(l=t)?void 0:l.count,track_code:null==(P=t)?void 0:P.trackCode,start_from:null==(O=t)?void 0:O.startFrom,fields:(0,r.getStoryOwnerFields)(),extended:1}).then((t=>{var i;return{list:(0,o.transformStoryGetApiResponseToLegacyFormat)(t,e,(0,a.isMvk)()),nextFrom:(null==(i=t)?void 0:i.next_from)||""}}));if(i=e.match(p),i){const t=Number(i[1]);return t?(0,_.apiStoriesGet)({owner_id:t,fields:(0,r.getStoryOwnerFields)(),extended:1}).then((t=>{var i;return{list:(0,o.transformStoryGetApiResponseToLegacyFormat)(t,e,(0,a.isMvk)()),nextFrom:(null==(i=t)?void 0:i.next_from)||""}})):Promise.reject("empty ownerId")}if(i=e.match(h),i){const t=Number(i[1]),s=Number(i[2]);return t&&s?(0,_.apiStoriesGetReplies)({owner_id:t,story_id:s,fields:(0,r.getStoryOwnerFields)(),extended:1}).then((t=>{var i;return{list:(0,o.transformStoryGetApiResponseToLegacyFormat)(t,e,(0,a.isMvk)()),nextFrom:(null==(i=t)?void 0:i.next_from)||""}})):Promise.reject("ownerId or storyId is empty")}if(i=e.match(m),i){const t=Number(i[1]),o=Number(i[2]);if(!t||!o)return Promise.reject("ownerId or narrativeId is empty");return M(e,`${t}_${o}`)}if(i=e.match(E),i){var D,T;const o=Number(i[1]);if(!o)return Promise.reject("ownerId is empty");let _=null==(D=t)?void 0:D.narrativeRawIds;return(null==(T=_)?void 0:T.length)?M(e,_):(0,s.apiNarrativesGetFromOwner)({owner_id:o,with_empty:0,limit:15}).then((t=>{var i,o;return _=(0,n.joinNarrativeRawIds)(null==(i=t)?void 0:i.items),(null==(o=_)?void 0:o.length)?M(e,_):Promise.reject("narrativeRawIds is empty")}))}if(i=e.match(b),i){var I,C;let i=null==(I=t)?void 0:I.narrativeRawIds;return(null==(C=i)?void 0:C.length)?M(e,i):(0,s.apiNarrativesGetFeedBlock)().then((t=>{var o,_,s;return i=(0,n.joinNarrativeRawIds)(null==(_=t)||null==(o=_.block)?void 0:o.narratives),(null==(s=i)?void 0:s.length)?M(e,i):Promise.reject("narrativeRawIds is empty")}))}if(i=e.match(w),i){const t=i[1],s=Number(i[2]);return t?(0,_.apiStoriesGetArchive)({date:s,fields:(0,r.getStoryOwnerFields)(),extended:1}).then((t=>({list:(0,o.transformStoriesToLegacy)(t,e,(0,a.isMvk)())}))):Promise.reject("ownerId is empty")}if(i=e.match(u),i){var A;const s=Number(i[1]),n=Number(i[2]);if(!s||!n)return Promise.reject("ownerId or storyId is empty");const l=null==(A=t)?void 0:A.context;return"all"===l||"new"===l?(0,_.apiStoriesGet)({fields:(0,r.getStoryOwnerFields)(),extended:1}).then((t=>({list:(0,o.transformStoryGetApiResponseToLegacyFormat)(t,e,(0,a.isMvk)())}))):(0,_.apiStoriesGetById)({stories:`${s}_${n}`,with_context:"owner"===l?1:0,fields:(0,r.getStoryOwnerFields)(),extended:1}).then((t=>({list:(0,o.transformStoriesToLegacy)(t,e,(0,a.isMvk)())})))}if(i=e.match(f),i){var S;const s=i[1],n=null==(S=t)?void 0:S.situationalSuggestId;if(!s&&void 0===n)return Promise.reject("rawQuery or suggest id is empty");let l="";if(s){const e=s.replaceAll("-","+").replaceAll("_","/");l=(0,_.decodeBase64)(e)}return(0,_.apiStoriesSearch)({q:l,count:100,situational_suggest_id:n,fields:(0,r.getStoryOwnerFields)(),extended:1}).then((t=>({list:(0,o.transformStoryGetApiResponseToLegacyFormat)(t,e,(0,a.isMvk)())})))}if(i=e.match(g),i){const t=Number(i[1]);return t?(0,_.apiStoriesSearch)({place_id:t,count:100,fields:(0,r.getStoryOwnerFields)(),extended:1}).then((t=>({list:(0,o.transformStoryGetApiResponseToLegacyFormat)(t,e,(0,a.isMvk)())}))):Promise.reject("place id is empty")}return Promise.reject("unknown list")}function M(e="",t=""){return(0,s.apiNarrativesGetById)({narratives:t,fields:(0,r.getStoryOwnerFields)(),extended:1}).then((t=>({list:(0,o.transformNarrativeGetApiResponseToLegacyFormat)(t,e,(0,a.isMvk)())})))}},27879:(e,t,i)=>{function o(){return _(["first_name","last_name","first_name_gen","last_name_gen","first_name_ins","last_name_ins","screen_name","name","is_member","is_closed","is_nft","is_nft_photo","photo_50","photo_100","friend_status","verified","sex"])}function _(e){return e.join(",")}i.d(t,{getStoryOwnerFields:()=>o,makeOwnerFields:()=>_})},68236:(e,t,i)=>{i.d(t,{transformClickableStickers:()=>E});var o=i(59397),_=i(44471),s=i(1435),r=i(73215),a=i(74450),n=i(57206),l=i(98442),d=i(75034),c=i(60091);const u={hashtag:c.StickerTypes.hashtag,mention:c.StickerTypes.mention,question:c.StickerTypes.question,place:c.StickerTypes.place,music:c.StickerTypes.music,story_reply:c.StickerTypes.storyReply,owner:c.StickerTypes.owner,link:c.StickerTypes.link,market_item:c.StickerTypes.marketItem,post:c.StickerTypes.post,poll:c.StickerTypes.poll,sticker:c.StickerTypes.sticker,app:c.StickerTypes.app,situational_theme:c.StickerTypes.situationalTheme,playlist:c.StickerTypes.playlist,clip:c.StickerTypes.videoButton},p={transparent:1,blue_gradient:2,red_gradient:3,underline:4,blue:5,green:6,white:7,question_reply:8,light:9,impressive:10,dark:11,accent_background:12,accent_text:13,dark_unique:14,light_unique:15,light_text:18,dark_text:19,black:20,dark_without_bg:21,light_without_bg:22},h=(e,t=6)=>isNaN(e)?NaN:Number(e.toFixed(t)),m=/^\[(id|club)(\d+)\|(.*)]$/;function E(e,t=[],i=[],E){var b,w,f;const g=null==(b=e)?void 0:b.clickable_stickers;if(!(g&&Object.values(g).length&&g.original_width&&g.original_height))return{original_width:0,original_height:0,stickers:[]};let v=g.original_width,P=g.original_height;Number((P/v).toFixed(2))>1.78&&(P=1.78*v);const M=(g.original_height-P)/2,O=v/100,D=P/100;return{original_width:v,original_height:P,stickers:(null==(f=g)||null==(w=f.clickable_stickers)?void 0:w.length)?g.clickable_stickers.reduce(((b,w)=>{if(!w)return b;const{clickable_area:f=[]}=w;if(f.length<4)return b;const g=Math.sqrt(Math.pow(f[1].x-f[0].x,2)+Math.pow(f[1].y-f[0].y,2)),v=Math.sqrt(Math.pow(f[1].x-f[2].x,2)+Math.pow(f[1].y-f[2].y,2));if(!g||!v)return b;const P=f[1].x-f[0].x;let T=180*Math.acos(P/g)/Math.PI;isNaN(T)&&(T=0),f[1].y<f[0].y&&(T=-T);const I=u[w.type],C={id:w.id,type:I,top:h((f[0].y-M)/D/100),left:h(f[0].x/O/100),width:h(g/O/100),height:h(v/D/100),rotate:h(T)};w.style&&(C.style=p[w.style]);let A=!1;switch(I){case c.StickerTypes.hashtag:w.hashtag?C.hashtag=w.hashtag:A=!0;break;case c.StickerTypes.mention:{var S,y,k;const e=null==(S=w.mention)?void 0:S.match(m),o=null==(y=e)?void 0:y[1],s=Number(null==(k=e)?void 0:k[2]);if(!s||isNaN(s)){A=!0;break}const r="id"===o&&t.find((({id:e})=>e===s)),a=!r&&"club"===o&&i.find((({id:e})=>e===s));r?(C.mentionedPhotoUrl=r.photo_100||r.photo_50||"",C.mentionedOwnerHref=(0,_.getOwnerHref)(r),C.mentionedText=(0,_.getOwnerFullName)(r)):a?(C.mentionedText=a.name||"",C.mentionedPhotoUrl=a.photo_100||a.photo_50||"",C.mentionedOwnerHref=(0,_.getOwnerHref)(a)):A=!0;break}case c.StickerTypes.question:C.question=w.question||"";break;case c.StickerTypes.place:w.place_id?C.placeId=w.place_id:A=!0;break;case c.StickerTypes.music:if(!w.audio){A=!0;break}var B,R,U;if(C.audioId=`${w.audio.owner_id}_${w.audio.id}`,C.audioData=JSON.stringify((0,r.apiAudioToAudioTuple)(w.audio)),w.audio_restrictions)C.audioRestriction={code:w.audio_restrictions.id,title:w.audio_restrictions.title,buttonText:(null==(B=w.audio_restrictions.button)?void 0:B.title)||"",buttonUrl:(null==(U=w.audio_restrictions.button)||null==(R=U.action)?void 0:R.url)||""};break;case c.StickerTypes.playlist:if(!w.playlist){A=!0;break}C.playlistOwnerId=w.playlist.owner_id,C.playlistId=w.playlist.id,C.playlistFollowed=Boolean(w.playlist.followed);break;case c.StickerTypes.storyReply:w.owner_id&&(C.ownerId=w.owner_id),C.link=(0,_.getOwnerHref)((0,l.findOwnerById)(w.owner_id,t,i)),w.story_id?C.storyId=w.story_id:C.isExpired=!0;break;case c.StickerTypes.owner:w.owner_id&&(C.ownerId=w.owner_id),C.link=(0,_.getOwnerHref)((0,l.findOwnerById)(w.owner_id,t,i));break;case c.StickerTypes.link:w.link_object?(C.link=w.link_object.url?(0,d.wrapAwayIfExternal)(w.link_object.url):"",C.tooltipText=w.tooltip_text||""):A=!0;break;case c.StickerTypes.marketItem:var L;if(w.subtype===c.StoryStickerSubtype.aliexpress)C.link=(null==(L=w.link_object)?void 0:L.url)?(0,d.wrapAwayIfExternal)(w.link_object.url):"",C.photoUrl=w.link_object&&(0,n.getPhotoSize)(w.link_object.photo,50*devicePixelRatio)||"";else if(w.subtype===c.StoryStickerSubtype.market&&w.market_item){var W;if(C.photoUrl=w.market_item.thumb&&(null==(W=(0,o.getPhotoSize)(w.market_item.thumb,50*devicePixelRatio))?void 0:W.url)||"",C.isRestricted=!1,E)C.link=`/product${w.market_item.owner_id}_${w.market_item.id}`;else{const e=(0,_.getOwnerHref)((0,l.findOwnerById)(w.market_item.owner_id,t,i));C.link=`${e}?w=product${w.market_item.owner_id}_${w.market_item.id}`}}else A=!0;break;case c.StickerTypes.post:w.post_owner_id&&(C.postOwnerId=w.post_owner_id),w.post_id?C.postId=w.post_id:A=!0;break;case c.StickerTypes.poll:w.poll?(C.pollId=w.poll.id,C.pollOwnerId=w.poll.owner_id):A=!0;break;case c.StickerTypes.app:if(w.app){C.appId=w.app.id,C.hasNewInteractions=Boolean(w.has_new_interactions);const t=[e.owner_id,e.id,"story",w.id];w.app_context&&t.push(btoa(w.app_context)),C.appRef=`story${t.join("_")}`}else A=!0;break;case c.StickerTypes.sticker:w.sticker_pack_id?(C.stickerPackId=w.sticker_pack_id,w.sticker_id&&(C.stickerId=w.sticker_id),C.tooltipText=(0,a.getLang)("stories_view_sticker_pack")):A=!0;break;case c.StickerTypes.situationalTheme:w.situational_theme_id?(C.situationalAppId=s.SITPOSTING_APP_ID,C.situationalThemeId=w.situational_theme_id):A=!0;break;case c.StickerTypes.videoButton:w.clip_id?(w.owner_id&&(C.videoOwnerId=w.owner_id),C.videoId=w.clip_id,C.videoType=w.type,C.tooltipText=(0,a.getLang)("stories_link_attach_clip")):A=!0;break;default:A=!0}return A||b.push(C),b}),[]):[]}}},60793:(e,t,i)=>{i(74450),i(59397),i(44471),i(60091)},13989:(e,t,i)=>{i.d(t,{transformNarrativeGetApiResponseToLegacyFormat:()=>o.transformNarrativeGetApiResponseToLegacyFormat,transformStoriesToLegacy:()=>o.transformStoriesToLegacy,transformStoryGetApiResponseToLegacyFormat:()=>o.transformStoryGetApiResponseToLegacyFormat});i(68236),i(55070),i(47291);var o=i(83372);i(60793)},83372:(e,t,i)=>{i.d(t,{getVideoSize:()=>D,transformNarrativeGetApiResponseToLegacyFormat:()=>m,transformStoriesToLegacy:()=>f,transformStoryGetApiResponseToLegacyFormat:()=>h});var o=i(85566),_=i(72045),s=i(44471),r=i(83560),a=i(60091),n=i(74450),l=i(59397),d=i(64639),c=i(98442),u=i(68236),p=i(55070);function h(e,t,i){const{items:o,profiles:s=[],groups:r=[]}=e,n=o.map((e=>{var o,n,l,d,u;const p=e.owner_id||(null==(n=e.stories)||null==(o=n[0])?void 0:o.owner_id)||0,m=(0,c.findOwnerById)(p,s,r)||{id:p},f=(null==(l=e.stories)?void 0:l.filter(Boolean))||[],g=t===a.StoryListName.feed||t===a.StoryListName.discover||t===a.StoryListName.apps,v={id:e.id||(0,_.default)(),author:b(m,s,null==(d=f[0])?void 0:d.also_subscribed),has_unseen:e.has_unseen,items:f.map((e=>w(e,m,s,r,i,t))),track_code:e.track_code,can_blacklist:g,app:e.app&&E(e.app),type:e.type,send_mask_hash:"",remove_from_blacklist_hash:"",is_narrative:!1,is_apps:e.type===a.StoryBlockType.appGroupedStories,next_from:""};if((null==(u=e.grouped)?void 0:u.length)&&(v.grouped=h({items:e.grouped,profiles:s,groups:r},t,i)),i){const o=function(e,t,i,o,_,s){var r;const a=null==(r=e.stories)?void 0:r[0],n=e.app;if("app_grouped_stories"!==e.type||!a)return;const l=w(a,t,i,o,_,s);l.raw_id=l.raw_id+"&meta",l.is_apps_meta_story=!0,n&&(l.app=E(n));return l}(e,m,s,r,i,t);o&&v.items.push(o)}return v}));return n}function m(e,t,i){const{items:o,profiles:s=[],groups:r=[]}=e;return o.map((e=>{var o,n,l,d;const u=e.owner_id||(null==(n=e.stories)||null==(o=n[0])?void 0:o.owner_id)||0,h=(0,c.findOwnerById)(u,s,r)||{id:u},m=(null==(l=e.stories)?void 0:l.filter(Boolean))||[];return{id:(0,_.default)(),author:b(h,s,null==(d=m[0])?void 0:d.also_subscribed),items:m.map((e=>w(e,h,s,r,i,t))),can_blacklist:!1,type:a.StoryBlockType.stories,send_mask_hash:"",remove_from_blacklist_hash:"",is_apps:!1,next_from:"",is_narrative:!0,narrative:(0,p.transformNarrative)(e,h)}}))}function E(e){return{url:`/app${e.id}`,name:e.title,photoUrl:e.icon_139||e.icon_150||e.icon_75||""}}function b(e,t=[],i){const o=e.verified?'<div class="page_verified"></div>':"",_=function(e,t=[]){if(!e)return;const i=[],o=e.user_ids||[];return o.forEach((e=>{const o=t.find((t=>t.id===e));o&&i.push({photo_url:o.photo_50||o.photo_100||"",href:(0,s.getOwnerHref)(o),name:o.first_name||"",sex:o.sex||0})})),{total_count:e.count||0,owners:i}}(i,t);if((0,s.isOwnerUser)(e)){const t=e.id,i=e.first_name||"",r=e.last_name||"",a=e.first_name_gen||"",n=e.last_name_gen||"",d=e.first_name_ins||"",c=(0,s.getOwnerFullName)(e),u=r?`${a} ${n}`:a;return{id:t,name:(0,l.escape)(c),name_get:(0,l.escape)(u),firstName:(0,l.escape)(i),first_name_gen:(0,l.escape)(a),first_name_ins:(0,l.escape)(d),photo:e.photo_100||e.photo_50||"",href:(0,s.getOwnerHref)(e),verify:o,gender:e.sex||0,can_follow:v(e),nft:Boolean(e.is_nft),also_subscribed:_}}const r=-e.id,a=(0,l.escape)(e.name||"");return{id:r,name:a,name_get:a,firstName:a,first_name_gen:a,first_name_ins:a,photo:e.photo_100||e.photo_50||"",href:(0,s.getOwnerHref)(e),verify:o,gender:0,can_follow:v(e),nft:Boolean(e.is_nft_photo),also_subscribed:_}}function w(e,t,i,o,_,p){var h,m,E,b,w,f,v,I,C,A,S;let y,k;if(null==(h=e.mask)?void 0:h.owner_id){var B;const t=(0,c.findOwnerById)(null==(B=e.mask)?void 0:B.owner_id,i,o);t&&(y=t.screen_name,(0,s.isOwnerUser)(t)&&(k=t.sex))}const R=P(t,e),U=!R&&(p===a.StoryListName.feed||p===a.StoryListName.apps||p===a.StoryListName.discover);return{owner_id:e.owner_id,raw_id:`${e.owner_id}_${e.id}`,date:(0,n.getSmDate)(e.date||0),time:e.date||0,type:T(e),unread:!e.seen,canLike:Boolean(e.can_like),can_comment:Boolean(e.can_comment),can_share:Boolean(e.can_share),can_remove:M(e,t),can_manage:R,can_ask:Boolean(e.can_ask),can_ask_anonymous:Boolean(e.can_ask_anonymous),canAddToNarrative:e.can_use_in_narrative,stats:{follow:{event_type:"subscribe",rhash:""},url_view:{event_type:"url_view",rhash:""}},isLiked:Boolean(e.is_liked),likeHash:"",reaction_set_id:e.reaction_set_id||"",user_reaction_id:e.user_reaction_id||0,preview_url:"",needMute:Boolean(e.need_mute),muteReply:Boolean(e.mute_reply),isPromo:Boolean(e.is_promo),isProfileQuestion:Boolean(e.is_profile_question),promoCaption:e.is_promo&&e.caption||"",track_code:e.track_code||"",video:{owner_id:e.owner_id,video_id:(null==(m=e.video)?void 0:m.id)||0},link:e.link?{text:e.link.text||"",url:e.link.url||""}:void 0,isPartOfNarrative:Boolean(e.narratives_count),report_hash:"",maskOwnerDomain:y,maskOwnerSex:k,can_hide_reply:O(e,i,o),noSound:Boolean(e.no_sound),isNewQuestions:R&&Boolean(null==(E=e.questions)?void 0:E.new),views:Boolean(e.views)?(0,r.formatCount)(e.views||0):"",needShowEmptyStats:Boolean(e.need_show_empty_stats),is_expired:Boolean(e.is_expired),is_deleted:Boolean(e.is_deleted),is_private:!Boolean(e.can_see),isAds:Boolean(e.is_ads),isOneTime:Boolean(e.is_one_time),isOneTimeSeen:Boolean(e.is_one_time)&&!Boolean(e.can_see),seenProgress:0,replies:(null==(b=e.replies)?void 0:b.count)?(0,r.formatCount)(e.replies.count):"",replies_new_counter:(null==(w=e.replies)?void 0:w.new)||0,clickable_stickers:(0,u.transformClickableStickers)(e,i,o,_),askQuestionHash:"",canMarkNotInterested:U,photo_url:(null==(f=e.photo)?void 0:f.sizes)&&(null==(v=(0,l.getPhotoSize)(e.photo.sizes,(0,d.isRetina)()?1200:600))?void 0:v.url)||"",small_preview:g(e,_),video_url:(null==(I=e.video)?void 0:I.files)?D(e.video.files):"",first_frame:(null==(C=e.video)?void 0:C.first_frame)&&(null==(A=(0,l.getPhotoSize)(null==(S=e.video)?void 0:S.first_frame,800))?void 0:A.url)||"",is_apps_meta_story:!1,repliesCountText:"",authorId:0,isMusicCover:!1,is_authors_ads:e.is_authors_ads,advertiser_info_url:e.advertiser_info_url,ad_marker:e.ad_marker,caption:e.caption,is_best_friends_privacy:e.is_best_friends_privacy}}function f(e,t,i){var o,s;const{items:r,profiles:n,groups:l}=e,d=(null==(o=r[0])?void 0:o.owner_id)||0,u=(0,c.findOwnerById)(d,n,l)||{id:d},p=t===a.StoryListName.feed||t===a.StoryListName.discover||t===a.StoryListName.apps,h=r.some((e=>!e.seen));return[{id:(0,_.default)(),author:b(u,n,null==(s=r[0])?void 0:s.also_subscribed),has_unseen:h,items:r.map((e=>w(e,u,n,l,i,t))),track_code:"",can_blacklist:p,type:a.StoryBlockType.stories,send_mask_hash:"",remove_from_blacklist_hash:"",is_narrative:!1,is_apps:!1,next_from:""}]}function g(e,t=!1){var i,o;const _=null==(i=e.photo)?void 0:i.sizes;var s;if(_)return(null==(s=(0,l.getPhotoSize)(_,t?10:(0,d.isRetina)()?600:300))?void 0:s.url)||"";const r=null==(o=e.video)?void 0:o.first_frame;var a;return r&&(null==(a=(0,l.getPhotoSize)(r,t?10:320))?void 0:a.url)||""}function v(e){return(0,s.isOwnerUser)(e)?window.vk.id!==e.id&&(e.friend_status===o.FriendsFriendStatusStatusEnumNames.NOT_A_FRIEND||e.friend_status===o.FriendsFriendStatusStatusEnumNames.INCOMING_REQUEST):!e.is_member&&!e.is_closed}function P(e,t){return(0,s.isOwnerUser)(e)?t.owner_id===e.id&&window.vk.id===e.id:t.owner_id===-e.id&&(t.is_ads?Boolean(e.is_advertiser):Boolean(e.is_admin))}function M(e,t){return P(t,e)&&("photo"===e.type||"video"===e.type)&&!e.is_deleted}function O(e,t,i){if(!e.parent_story_owner_id||!e.parent_story_id)return!1;const o=window.vk.id,_=e.parent_story_owner_id;if(_===o)return!0;const r=(0,c.findOwnerById)(_,t,i);return!!(r&&(0,s.isOwnerGroup)(r)&&r.is_admin)}function D(e){const t=["mp4_2160","mp4_1440","mp4_1080","mp4_720","mp4_480","mp4_360","mp4_240","mp4_144"].find((t=>Boolean(e[t])));return t&&e[t]?String(e[t]):""}function T(e){return"photo"===e.type?a.StoryType.PHOTO:"video"===e.type?a.StoryType.VIDEO:"live_active"===e.type||"live_finished"===e.type?a.StoryType.LIVE:a.StoryType.PHOTO}},55070:(e,t,i)=>{i.d(t,{transformNarrative:()=>r});var o=i(59397),_=i(44471),s=(i(98442),i(47291));function r(e,t){var i,r;const a=`${e.owner_id}_${e.id}`,n=(0,_.isOwnerGroup)(t),l=n&&Boolean(t.is_closed),d={id:e.id,rawId:a,ownerId:e.owner_id,ownerName:(0,o.escape)((n?t.name:(0,_.getOwnerFullName)(t))||""),ownerShortName:(0,o.escape)((n?t.name:(0,_.getOwnerShortName)(t))||""),ownerUrl:(0,_.getOwnerHref)(t),ownerPath:`${n?"club":"id"}${e.owner_id}`,ownerAvatarUrl:t.photo_100||t.photo_50||"",title:(0,o.escape)(e.title),isBookmarked:e.is_favorite,bookmarkHash:"",reportHash:"",canEdit:Boolean(e.can_delete),editHash:"",canView:e.can_see,storiesCount:(null==(i=e.story_ids)?void 0:i.length)||0,isOwnerClosedGroup:l,isGroupEditor:l&&Boolean(t.is_admin),url:`${window.location.origin}/narrative${a}`,stories:(null==(r=e.stories)?void 0:r.map(s.transformStoryArchive))||[],isDeleted:e.is_delete,date:"",coverUrl:""};if(e.cover){var c;Object.assign(d,{coverUrl:e.cover.cropped_sizes&&(null==(c=(0,o.getPhotoSize)(e.cover.cropped_sizes,300))?void 0:c.url)||"",coverCrop:{x:e.cover.crop_x||0,y:e.cover.crop_y||0,width:e.cover.crop_width||0,height:e.cover.crop_height||0}}),e.cover.custom_photo&&(d.customCover=function(e,t=[]){var i,_,s,r;if(!e)return;return{photoId:e.id,originalPhotoUrl:(null==(i=e.orig_photo)?void 0:i.url)||e.sizes&&(null==(_=(0,o.getPhotoSize)(e.sizes,600))?void 0:_.url)||"",previewUrl:t&&(null==(s=(0,o.getPhotoSize)(t,300))?void 0:s.url)||e.sizes&&(null==(r=(0,o.getPhotoSize)(e.sizes,300))?void 0:r.url)||""}}(e.cover.custom_photo,e.cover.cropped_sizes));const t=e.cover.cover_story_id;if(t){var u;Object.assign(d,{coverStoryId:t,coverStoryRawId:`${e.owner_id}_${t}`});const i=null==(u=e.stories)?void 0:u.find((e=>{var i;return(null==(i=e)?void 0:i.id)===t}));i&&(d.coverStory=(0,s.transformStoryArchive)(i))}}return d}},47291:(e,t,i)=>{i.d(t,{transformStoryArchive:()=>a});var o=i(59397),_=i(36782),s=i(83372),r=i(75034);function a(e){var t,i,a,n;const l=Math.max(e.date?Math.ceil(new Date(1e3*e.date).setUTCHours(0,0,0,0)/1e3):0,_.STORIES_ARCHIVE_START_TIME),d=(null==(t=e.photo)?void 0:t.sizes)||(null==(i=e.video)?void 0:i.image),c={id:e.id,rawId:`${e.owner_id}_${e.id}`,listId:`archive${e.owner_id}_${l}`,time:Number(e.date),preview:d&&(null==(a=(0,o.getPhotoSize)(d,350))?void 0:a.url)||"",originalPreviewUrl:d&&(null==(n=(0,o.getPhotoSize)(d,600))?void 0:n.url)||""};return"video"===e.type&&e.video&&Object.assign(c,{videoUrl:e.video.files&&(0,s.getVideoSize)(e.video.files)||"",duration:e.video.duration}),e.link&&Object.assign(c,{linkUrl:(0,r.wrapAwayIfExternal)(e.link.url)||"",linkText:e.link.text||"",linkType:""}),c}},47608:(e,t,i)=>{i.d(t,{createStoriesService:()=>a});var o=i(98116),_=i(45492),s=i(43222),r=i(26734);const a=({domain:e})=>{const t=e.createEvent("fire/storiesGet"),i=e.createEvent("fire/storiesGetById"),a=e.createEvent("fire/storiesGetArchive"),n=e.createEvent("fire/storiesGetViewers"),l=e.createEvent("fire/storiesGetReplies"),d=e.createEvent("fire/storiesGetQuestions"),c=e.createEvent("fire/storiesGetStats"),u=e.createEvent("fire/storiesGetDetailedStats"),p=e.createEvent("fire/storiesMarkSkipped"),h=e.createEvent("fire/storiesMarkNotInterested"),m=e.createEvent("fire/storiesMarkSeen"),E=e.createEvent("fire/storiesHidePrivacyBlock"),b=e.createEvent("fire/storiesDelete"),w=e.createEvent("fire/storiesAskQuestion"),f=e.createEvent("fire/storiesDeleteQuestion"),g=e.createEvent("fire/storiesBanQuestionAuthor"),v=e.createEvent("fire/storiesUnbanQuestionAuthor"),P=e.createEvent("fire/storiesMarkAppNotificationsSeen"),M=e.createEvent("fire/storiesSubscribeUserToApp"),O=e.createEvent("fire/storiesGetPhotoUploadServer"),D=e.createEvent("fire/storiesGetVideoUploadServer"),T=e.createEvent("fire/storiesSave"),I=e.createEvent("fire/storiesSearch"),C=e.createEvent("fire/storiesUnbanOwner"),A=e.createEvent("fire/storiesBanOwner"),S=e.createEvent("fire/storiesSetDiscoverVisible"),y=e.createEvent("fire/storiesHideReply"),k=e.createEvent("fire/storieHideAllReplies"),B=e.createEffect("fx/storiesGet"),R=e.createEffect("fx/storiesGetById"),U=e.createEffect("fx/storiesGetArchive"),L=e.createEffect("fx/storiesGetViewers"),W=e.createEffect("fx/storiesGetReplies"),x=e.createEffect("fx/storiesGetQuestions"),N=e.createEffect("fx/storiesGetStats"),K=e.createEffect("fx/storiesGetDetailedStats"),F=e.createEffect("fx/storiesMarkSkipped"),H=e.createEffect("fx/storiesMarkNotInterested"),G=e.createEffect("fx/storiesMarkSeen"),j=e.createEffect("fx/storiesHidePrivacyBlock"),z=e.createEffect("fx/storiesDelete"),q=e.createEffect("fx/storiesAskQuestion"),V=e.createEffect("fx/storiesDeleteQuestion"),Y=e.createEffect("fx/storiesBanQuestionAuthor"),Q=e.createEffect("fx/storiesUnbanQuestionAuthor"),$=e.createEffect("fx/storiesMarkAppNotificationsSeen"),X=e.createEffect("fx/storiesSubscribeUserToApp"),J=e.createEffect("fx/storiesGetPhotoUploadServer"),Z=e.createEffect("fx/storiesGetVideoUploadServer"),ee=e.createEffect("fx/storiesSave"),te=e.createEffect("fx/storiesSearch"),ie=e.createEffect("fx/storiesUnbanOwner"),oe=e.createEffect("fx/storiesBanOwner"),_e=e.createEffect("fx/storiesSetDiscoverVisible"),se=e.createEffect("fx/storiesHideReply"),re=e.createEffect("fx/storiesHideAllReplies"),ae=(0,s.createFriendsAddFx)({domain:e}),ne=(0,s.createFriendsDeleteFx)({domain:e}),le=(0,r.createGroupsJoinFx)({domain:e}),de=(0,r.createGroupsLeaveFx)({domain:e});return B.use(_.apiStoriesGet),R.use(_.apiStoriesGetById),U.use(_.apiStoriesGetArchive),L.use(_.apiStoriesGetViewers),W.use(_.apiStoriesGetReplies),x.use(_.apiStoriesGetQuestions),N.use(_.apiStoriesGetStats),K.use(_.apiStoriesGetDetailedStats),F.use(_.apiStoriesMarkSkipped),H.use(_.apiStoriesMarkNotInterested),G.use(_.apiStoriesMarkSeen),j.use(_.apiStoriesHidePrivacyBlock),z.use(_.apiStoriesDelete),q.use(_.apiStoriesAskQuestion),V.use(_.apiStoriesDeleteQuestion),Y.use(_.apiStoriesBanQuestionAuthor),Q.use(_.apiStoriesUnbanQuestionAuthor),$.use(_.apiStoriesMarkAppNotificationsSeen),X.use(_.apiStoriesSubscribeUserToApp),J.use(_.apiStoriesGetPhotoUploadServer),Z.use(_.apiStoriesGetVideoUploadServer),ee.use(_.apiStoriesSave),te.use(_.apiStoriesSearch),oe.use(_.apiStoriesBanOwner),ie.use(_.apiStoriesUnbanOwner),_e.use(_.apiStoriesSetDiscoverVisible),se.use(_.apiStoriesHideReply),re.use(_.apiStoriesHideAllReplies),(0,o.sample)({clock:t,target:B}),(0,o.sample)({clock:i,target:R}),(0,o.sample)({clock:a,target:U}),(0,o.sample)({clock:n,target:L}),(0,o.sample)({clock:l,target:W}),(0,o.sample)({clock:d,target:x}),(0,o.sample)({clock:c,target:N}),(0,o.sample)({clock:u,target:K}),(0,o.sample)({clock:p,target:F}),(0,o.sample)({clock:h,target:H}),(0,o.sample)({clock:m,target:G}),(0,o.sample)({clock:E,target:j}),(0,o.sample)({clock:b,target:z}),(0,o.sample)({clock:w,target:q}),(0,o.sample)({clock:f,target:V}),(0,o.sample)({clock:g,target:Y}),(0,o.sample)({clock:v,target:Q}),(0,o.sample)({clock:P,target:$}),(0,o.sample)({clock:M,target:X}),(0,o.sample)({clock:O,target:J}),(0,o.sample)({clock:D,target:Z}),(0,o.sample)({clock:T,target:ee}),(0,o.sample)({clock:I,target:te}),(0,o.sample)({clock:C,target:ie}),(0,o.sample)({clock:A,target:oe}),(0,o.sample)({clock:S,target:_e}),(0,o.sample)({clock:y,target:se}),(0,o.sample)({clock:k,target:re}),{fireGet:t,fireGetById:i,fireGetArchive:a,fireGetViewers:n,fireGetReplies:l,fireGetQuestions:d,fireGetStats:c,fireGetDetailedStats:u,fireMarkSkipped:p,fireMarkNotInterested:h,fireMarkSeen:m,fireHidePrivacyBlock:E,fireDelete:b,fireAskQuestion:w,fireDeleteQuestion:f,fireBanQuestionAuthor:g,fireUnbanQuestionAuthor:v,fireMarkAppNotificationsSeen:P,fireSubscribeUserToApp:M,fireGetPhotoUploadServer:O,fireGetVideoUploadServer:D,fireSave:T,fireSearch:I,fireUnbanOwner:C,fireBanOwner:A,fireSetDiscoverVisible:S,fireHideReply:y,fireHideAllReplies:k,getFx:B,getByIdFx:R,getArchiveFx:U,getViewersFx:L,getRepliesFx:W,getQuestionsFx:x,getStatsFx:N,getDetailedStatsFx:K,markSkippedFx:F,markNotInterestedFx:H,markSeenFx:G,hidePrivacyBlockFx:j,deleteFx:z,askQuestionFx:q,deleteQuestionFx:V,banQuestionAuthorFx:Y,unbanQuestionAuthorFx:Q,markAppNotificationsSeenFx:$,subscribeUserToAppFx:X,getPhotoUploadServerFx:J,getVideoUploadServerFx:Z,saveFx:ee,searchFx:te,unbanOwnerFx:ie,banOwnerFx:oe,setDiscoverVisibleFx:_e,hideReplyFx:se,hideAllRepliesFx:re,friendsAddFx:ae,friendsDeleteFx:ne,groupsJoinFx:le,groupsLeaveFx:de}}},25714:(e,t,i)=>{i.d(t,{pollsService:()=>h,storiesDomain:()=>u,storiesService:()=>p});var o=i(98116),_=i(36782),s=i(14246),r=i(19565),a=i(20602),n=i(25959),l=i(90694),d=i(656),c=i(37328);const u=(0,o.createDomain)("stories"),p=(0,_.createStoriesService)({domain:u}),h=((0,s.createStatsService)({domain:u}),(0,r.createNarrativesService)({domain:u}),(0,a.createLikesService)({domain:u}),(0,n.createMessagesService)({domain:u}),(0,l.createFaveService)({domain:u}),(0,d.createPollsService)({domain:u}));(0,c.createUserService)({domain:u})},57030:(e,t,i)=>{function o(e){var t,i;return(null!=(i=null==(t=e)?void 0:t.split("_"))?i:[]).map(Number)}function _(e,t="windows-1251"){return new TextDecoder(t).decode(function(e){const t=atob(e);return Uint8Array.from(t,(e=>e.codePointAt(0)||0))}(e))}i.d(t,{decodeBase64:()=>_,splitStoryRawId:()=>o})},36606:(e,t,i)=>{i.d(t,{updateArticleSnippetsFromQueueByPost:()=>a});i(11010);var o=i(75973),_=i(64639),s=i(72516);i(34322),i(76129),i(18384),i(74838),i(71858),i(11147),i(10939),i(74450);const r="article_snippet";function a(e){if(!window.vk.id)return;if(!(0,s.partConfigEnabled)("update_private_snippets_by_queue"))return;const t=Array.from(e.querySelectorAll(`.${r}`));if(!t.length)return;const i=[];t.forEach((e=>{if(!window.vk.id||!e.dataset.needUpdate)return;const t=e.dataset.articleRawId;t&&i.push({article_raw_id:t,post_raw_id:e.dataset.postId,is_mini_snippet:(0,_.intval)(e.dataset.isMiniSnippet)})})),i.length&&window.ajax.post("al_articles.php",{act:"get_snippets",article_snippets:JSON.stringify(i)},{onDone:e=>{t.forEach((t=>{t.dataset.articleRawId&&e[t.dataset.articleRawId]&&(t.outerHTML=e[t.dataset.articleRawId])}))},onFail:()=>((0,o.logError)(new Error("Fail: updateArticleSnippetsFromQueueByPost")),!0)})}},2386:(e,t,i)=>{i.d(t,{init:()=>l});var o=i(80816),_=i(57289),s=i(42024),r=i(82795),a=i(18610),n=i(75973);const l=()=>{(0,o.init)(),(0,_.tqi)().setHandler("Common/nav_go",(e=>{var t,i;(null==(t=e.payload.event)?void 0:t.target)&&window.nav.go(e.payload.event.target,e.payload.event,JSON.parse((null==(i=e.payload.dataAttrs)?void 0:i.options)||"{}"))}),!1),(0,_.tqi)().setHandler("Common/cur_box_hide",(()=>{var e;null==(e=(0,s.curBox)())||e.hide()}),!1),(0,_.tqi)().setHandler("Common/show_menu_settings",(e=>{var t;const i=(null==(t=e.payload.dataAttrs)?void 0:t.type)?Number(e.payload.dataAttrs.type):void 0;(0,r.showMenuSettingsBox)(i)}),!1),(0,_.tqs)().setHandler("HelpHints/init",(({payload:{target:e}})=>{var t,i;null==(t=e)||t.remove(),(0,a.ensureAccountHelpHintsService)().initialize({viewerId:null==(i=window.vk)?void 0:i.id,logErrorFn:n.logError})}),!0)}},93446:(e,t,i)=>{i.d(t,{highlightModule:()=>d});var o=i(32953),_=i(20137),s=i(4865),r=i(40378),a=i(26466);let n,l;function d(e){const t=document.getElementById(e.module);if(!t||!t.classList.contains("module"))return;window.cur.__narrowBarForceNotFixed=!0;const i=e.speed?e.speed:300;(0,s.scrollToY)((0,r.getXY)(t)[1]-100,i);const d=()=>{n&&(n.hideTT(),(0,s.enableBodyScroll)(),delete window.cur.__narrowBarForceNotFixed,(0,_.updateNarrow)(),e.onClose&&e.onClose())};n=new o.default(t,e.text,{highlight:!0,width:250,offset:[0,-17],side:"bottom",withCloseButton:!0,onBGClick:d,onCloseButtonClick:d}),n.show(),(0,s.disableBodyScroll)(),e.autoCancelDelay&&(l=setTimeout((()=>{d(),l=null}),e.autoCancelDelay),(0,a.pushNavDestroy)((()=>{l&&clearTimeout(l)})))}},9702:(e,t,i)=>{i.d(t,{PROFILE_MEDIA_NARROW_BLOCK_ID:()=>o});const o="profile_media_narrow_block"},32727:(e,t,i)=>{i.d(t,{MenuSettings:()=>C});var o=i(11010),_=i(34788),s=i(85893),r=i(67294),a=i(63825),n=i(54182),l=i(58344),d=i(72311),c=i(10361),u=i(21097),p=i(36858),h=i(99339),m=i(45112),E=i(17286),b=i(84990),w=i(20646),f=i(22209),g=i(17194),v=i(74450),P=i(62959),M=i(28807),O=i(48110),D=i(33182);function T(e){return`menu-settings-tab-${e}`}function I(e){return`menu-settings-panel-${e}`}const C=({onClose:e,onAppSave:t,initialData:i})=>{var C;const{title:A,tabs:S,limits:y,message:k,only:B,hash:R,type:U,app_id:L}=i,[W,x]=(0,r.useState)(S),[N,K]=(0,r.useState)(W[U]?U:W[O.MENU_TYPE_MAIN].id),F="number"==typeof B,H=W[F?B:N],[G,j]=(0,r.useState)(!1),z=(0,P.useIsMounted)(),q=e=>{const t=W[e];return t?t.items.filter((e=>e.is_checked)).length:0};let V=0,Y=0;H&&(Y=y[H.id],V=q(H.id));const Q=(0,o._)((function*(){const{params:i,appIsAdded:o}=(0,O.wrapMenuSettings)(R,W,L);j(!0);try{const _=yield(0,O.saveMenuSettingsRequest)(i);(0,D.updateSidebar)(_),window.uiPageBlock&&window.uiPageBlock.showSaved("settings_services"),window.Apps&&window.Apps.updateAddToMenuAction(),t&&t(o),e()}catch(e){z()&&j(!1)}})),$=Object.values(W);return(0,s.jsxs)(a.ModalBox,{focusTrap:!0,children:[(0,s.jsx)(n.ModalHeader,{onClose:e,closeAriaLabel:(0,v.getLang)("global_close"),children:A}),k&&(0,s.jsx)(l.ModalMessage,{children:(0,s.jsx)(d.InnerHTML,{children:k})}),!F&&$.length>0&&(0,s.jsx)(c.ModalTabs,{children:$.filter((e=>e.items.length)).map((e=>(0,s.jsx)(u.TabsItem,{"aria-controls":I(e.id),id:T(e.id),onClick:()=>K(e.id),selected:e.id===N,children:e.label},e.label)))}),(0,s.jsx)(p.ModalScrollView,{id:F?void 0:I(N),"aria-labelledby":F?void 0:T(N),height:400,children:(0,s.jsx)(h.Div,{mode:"horizontal",spacing:8,children:(0,s.jsx)(m.SpacedList,{spacing:4,children:null==(C=H)?void 0:C.items.map((e=>{let t;return e.icon?t=(0,s.jsx)(E.Image,{size:40,borderRadius:"l",withBorder:!1,children:(0,s.jsx)(d.InnerHTML,{className:M.default.beforeIcon,children:e.icon})}):e.photo&&(t=e.is_app_photo?(0,s.jsx)(E.Image,{size:40,src:e.photo,borderRadius:"l"}):(0,s.jsx)(b.Avatar,{size:40,src:e.photo})),(0,s.jsx)(w.SelectableCell,{disabled:e.is_fixed,selectable:!Y||V<Y,before:t,checked:Boolean(e.is_checked),onChange:t=>{return i=t.target.checked,o=N,s=e.id,void x((e=>e[o]?(e[o].items=e[o].items.map((e=>{if(e.id===s){const t=y[o];if(t&&q(o)===t&&!e.is_checked)return e;e.is_checked=i}return e})),(0,_._)({},e)):e));var i,o,s},className:M.default.cell,children:e.label},e.id)}))})})}),(0,s.jsx)(f.ModalFooter,{before:Y>0&&(0,s.jsx)(d.InnerHTML,{children:(0,v.getLang)("settings_admin_groups_left").replace("{count}",String(V)).replace("{amt}",String(Y))}),actionButtons:[(0,s.jsx)(g.Button,{size:"m",mode:"secondary",onClick:e,children:(0,v.getLang)("global_cancel")},"cancel"),(0,s.jsx)(g.Button,{size:"m",mode:"primary",onClick:Q,loading:G,children:(0,v.getLang)("global_save")},"send")]})]})}},48110:(e,t,i)=>{i.d(t,{MENU_TYPE_APPS:()=>r,MENU_TYPE_GROUPS:()=>s,MENU_TYPE_MAIN:()=>_,MENU_TYPE_SERVICE:()=>a,saveMenuSettingsRequest:()=>l,wrapMenuSettings:()=>n});var o=i(34788);const _=0,s=1,r=2,a=3;function n(e,t,i){const o={hash:e},_=[],n=[];let l=!1;const d=[],c=[];for(const e of Object.values(t))for(const t of e.items)switch(e.id){case s:t.is_checked&&_.push(t.id);break;case r:n.push(t.id),t.is_checked&&(i===t.id&&(l=!0),d.push(t.id));break;case a:t.is_checked||c.push(t.id);break;default:o[t.id]=Number(t.is_checked)}return n.length&&(o.apps_all=n.join(","),o.apps_on=d.join(",")),o.groups_list=_.join(","),o.service_hidden=c.join(","),{params:o,appIsAdded:l}}function l(e){return new Promise(((t,i)=>{window.ajax.post("al_settings.php",(0,o._)({},e,{act:"a_change_services"}),{onDone:e=>{t(e)},onFail:e=>(i(e),!0)})}))}},82795:(e,t,i)=>{i.r(t),i.d(t,{MENU_TYPE_APPS:()=>_.MENU_TYPE_APPS,MENU_TYPE_GROUPS:()=>_.MENU_TYPE_GROUPS,MENU_TYPE_MAIN:()=>_.MENU_TYPE_MAIN,MENU_TYPE_SERVICE:()=>_.MENU_TYPE_SERVICE,showMenuSettingsBox:()=>o.showMenuSettingsBox});var o=i(31455),_=i(48110)},31455:(e,t,i)=>{i.d(t,{showMenuSettingsBox:()=>d});var o=i(85893),_=i(59397),s=i(32727),r=i(42024),a=i(48110),n=i(5646);const l=(e,t)=>{e=(0,_.decodeHTMLEntitiesDeep)(e);let i=!1;(0,n.showMessageBoxModal)((({onClose:t})=>(0,o.jsx)(s.MenuSettings,{initialData:e,onClose:t,onAppSave:e=>{i=e}})),{width:600,onDestroy:()=>{t&&t(i)}})};function d(e=a.MENU_TYPE_MAIN,t,i){window.ajax.post("al_settings.php",{act:"menu_box",type:e,app_id:t},{onDone:e=>{l(e,i)},showProgress:()=>{(0,r.showBoxLoader)()},hideProgress:()=>{(0,r.hideBoxLoader)()}})}},33182:(e,t,i)=>{i.d(t,{updateSidebar:()=>s});var o=i(74455),_=i(75973);function s(e){if(!e)return;if(e.includes("internal.getWebLeftMenu")){try{const t=JSON.parse(e);(0,o.setLeftMenu)(t)}catch(e){(0,_.logError)(e)}return}const t=document.querySelector(".side_bar_ol");t&&(t.innerHTML=e)}},97258:(e,t,i)=>{i.d(t,{STORIES_MANAGE_MODULE:()=>o});const o="stories_manage"},71889:(e,t,i)=>{i.d(t,{updateNarrativeSnippetsFromQueueByPost:()=>r});i(40378),i(42024),i(93446),i(74450),i(64639),i(9702),i(30621);var o=i(75973),_=i(72516);i(83668);const s="NarrativeSnippet";function r(e){if(!window.vk.id)return;if(!(0,_.partConfigEnabled)("update_private_snippets_by_queue"))return;const t=Array.from(e.querySelectorAll(`.${s}`));if(!t.length)return;const i=[];t.forEach((e=>{if(!window.vk.id||!e.dataset.needUpdate)return;const t=e.dataset.narrativeRawId;t&&i.push({narrative_raw_id:t,snippet_type:e.dataset.snippetType,from:e.dataset.from})})),i.length&&window.ajax.post("al_stories.php",{act:"get_narrative_snippets",narrative_snippets:JSON.stringify(i)},{onDone:e=>{t.forEach((t=>{t.dataset.narrativeRawId&&e[t.dataset.narrativeRawId]&&(t.outerHTML=e[t.dataset.narrativeRawId])}))},onFail:()=>((0,o.logError)(new Error("Fail: updateNarrativeSnippetFromQueueByPost")),!0)})}},30621:(e,t,i)=>{i.d(t,{removeStoryList:()=>o});i(60091),i(40378),i(72516),i(26466),i(29088),i(56959),i(42024),i(97258),i(74450);function o(e){delete window.cur[`stories_list_${e}`]}},29088:(e,t,i)=>{i.d(t,{isApiForVKCOMViewerEnabled:()=>_});var o=i(72516);function _(){return(0,o.partConfigEnabled)("stories_web_api")}},71858:(e,t,i)=>{e.exports=i.p+"icons/d7ccdb168db391d6a891.png"},74185:(e,t)=>{t._=t._type_of=function(e){return e&&"undefined"!=typeof Symbol&&e.constructor===Symbol?"symbol":typeof e}}},__webpack_module_cache__={},deferred,inProgress,loadStylesheet,installedCssChunks;function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var i=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e].call(i.exports,i,i.exports,__webpack_require__),i.exports}__webpack_require__.m=__webpack_modules__,deferred=[],__webpack_require__.O=(e,t,i,o)=>{if(!t){var _=1/0;for(n=0;n<deferred.length;n++){for(var[t,i,o]=deferred[n],s=!0,r=0;r<t.length;r++)(!1&o||_>=o)&&Object.keys(__webpack_require__.O).every((e=>__webpack_require__.O[e](t[r])))?t.splice(r--,1):(s=!1,o<_&&(_=o));if(s){deferred.splice(n--,1);var a=i();void 0!==a&&(e=a)}}return e}o=o||0;for(var n=deferred.length;n>0&&deferred[n-1][2]>o;n--)deferred[n]=deferred[n-1];deferred[n]=[t,i,o]},__webpack_require__.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return __webpack_require__.d(t,{a:t}),t},__webpack_require__.d=(e,t)=>{for(var i in t)__webpack_require__.o(t,i)&&!__webpack_require__.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},__webpack_require__.f={},__webpack_require__.e=e=>Promise.all(Object.keys(__webpack_require__.f).reduce(((t,i)=>(__webpack_require__.f[i](e,t),t)),[])),__webpack_require__.u=e=>394===e?"api/widgets/chunks/AudioLongtapModal.b7305890.js":817===e?"api/widgets/chunks/hls.2410bb2a.js":980===e?"api/widgets/chunks/menu_settings.24583686.js":468===e?"api/widgets/chunks/SilentModeForms.d686bbf8.js":872===e?"api/widgets/chunks/feed-client-nav-skeleton.e96847da.js":953===e?"api/widgets/chunks/feed-client-nav-async-right-block.5c0bcbab.js":375===e?"api/widgets/chunks/voice_message_player.ef518805.js":762===e?"api/widgets/chunks/speech.1f66e8f6.js":240===e?"api/widgets/chunks/performance-stats.10f34858.js":317===e?"chunks/317.feac0c2b.js":786===e?"chunks/786.22736af0.js":void 0,__webpack_require__.miniCssF=e=>394===e?"api/widgets/chunks/6c6b10bc.css":980===e?"api/widgets/chunks/9c700d95.css":468===e?"api/widgets/chunks/3ab28f33.css":void 0,__webpack_require__.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),__webpack_require__.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),inProgress={},__webpack_require__.l=(e,t,i,o)=>{if(inProgress[e])inProgress[e].push(t);else{var _,s;if(void 0!==i)for(var r=document.getElementsByTagName("script"),a=0;a<r.length;a++){var n=r[a];if(n.getAttribute("src")==e||n.getAttribute("data-webpack")=="vk:"+i){_=n;break}}_||(s=!0,(_=document.createElement("script")).charset="utf-8",_.timeout=120,__webpack_require__.nc&&_.setAttribute("nonce",__webpack_require__.nc),_.setAttribute("data-webpack","vk:"+i),_.src=e),inProgress[e]=[t];var l=(t,i)=>{_.onerror=_.onload=null,clearTimeout(d);var o=inProgress[e];if(delete inProgress[e],_.parentNode&&_.parentNode.removeChild(_),o&&o.forEach((e=>e(i))),t)return t(i)},d=setTimeout(l.bind(null,void 0,{type:"timeout",target:_}),12e4);_.onerror=l.bind(null,_.onerror),_.onload=l.bind(null,_.onload),s&&document.head.appendChild(_)}},__webpack_require__.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},__webpack_require__.p="/dist/",loadStylesheet=e=>new Promise(((t,i)=>{var o=__webpack_require__.miniCssF(e),_=__webpack_require__.p+o;if(((e,t)=>{for(var i=document.getElementsByTagName("link"),o=0;o<i.length;o++){var _=(r=i[o]).getAttribute("data-href")||r.getAttribute("href");if("stylesheet"===r.rel&&(_===e||_===t))return r}var s=document.getElementsByTagName("style");for(o=0;o<s.length;o++){var r;if((_=(r=s[o]).getAttribute("data-href"))===e||_===t)return r}})(o,_))return t();((e,t,i,o)=>{var _=document.createElement("link");_.rel="stylesheet",_.type="text/css",_.onerror=_.onload=s=>{if(_.onerror=_.onload=null,"load"===s.type)i();else{var r=s&&("load"===s.type?"missing":s.type),a=s&&s.target&&s.target.href||t,n=new Error("Loading CSS chunk "+e+" failed.\n("+a+")");n.code="CSS_CHUNK_LOAD_FAILED",n.type=r,n.request=a,_.parentNode.removeChild(_),o(n)}},_.href=t,document.head.appendChild(_)})(e,_,t,i)})),installedCssChunks={803:0},__webpack_require__.f.miniCss=(e,t)=>{installedCssChunks[e]?t.push(installedCssChunks[e]):0!==installedCssChunks[e]&&{394:1,468:1,980:1}[e]&&t.push(installedCssChunks[e]=loadStylesheet(e).then((()=>{installedCssChunks[e]=0}),(t=>{throw delete installedCssChunks[e],t})))},(()=>{__webpack_require__.b=document.baseURI||self.location.href;var e={803:0};__webpack_require__.f.j=(t,i)=>{var o=__webpack_require__.o(e,t)?e[t]:void 0;if(0!==o)if(o)i.push(o[2]);else{var _=new Promise(((i,_)=>o=e[t]=[i,_]));i.push(o[2]=_);var s=__webpack_require__.p+__webpack_require__.u(t),r=new Error;__webpack_require__.l(s,(i=>{if(__webpack_require__.o(e,t)&&(0!==(o=e[t])&&(e[t]=void 0),o)){var _=i&&("load"===i.type?"missing":i.type),s=i&&i.target&&i.target.src;r.message="Loading chunk "+t+" failed.\n("+_+": "+s+")",r.name="ChunkLoadError",r.type=_,r.request=s,o[1](r)}}),"chunk-"+t,t)}},__webpack_require__.O.j=t=>0===e[t];var t=(t,i)=>{var o,_,[s,r,a]=i,n=0;if(s.some((t=>0!==e[t]))){for(o in r)__webpack_require__.o(r,o)&&(__webpack_require__.m[o]=r[o]);if(a)var l=a(__webpack_require__)}for(t&&t(i);n<s.length;n++)_=s[n],__webpack_require__.o(e,_)&&e[_]&&e[_][0](),e[_]=0;return __webpack_require__.O(l)},i=self.webpackChunkvkwidgets=self.webpackChunkvkwidgets||[];i.forEach(t.bind(null,0)),i.push=t.bind(null,i.push.bind(i))})();var __webpack_exports__=__webpack_require__.O(void 0,[808,322,927,356,140,734,244,778,996,250,101],(()=>__webpack_require__(46601)));__webpack_exports__=__webpack_require__.O(__webpack_exports__)})();