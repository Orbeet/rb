"use strict";(self.webpackChunkvkweb=self.webpackChunkvkweb||[]).push([[38234],{652047:(e,t,r)=>{r.d(t,{FriendsFriendStatusStatusEnumNames:()=>i});const i={NOT_A_FRIEND:0,OUTCOMING_REQUEST:1,INCOMING_REQUEST:2,IS_FRIEND:3}},123573:(e,t,r)=>{r.d(t,{API_VERSION:()=>i,CLOSE_STATUS:()=>p,ERROR_CODES:()=>n,ERROR_REASONS:()=>c,ERROR_TYPES:()=>d,GROUP_STATUS:()=>_,NFT_APP_ID:()=>S,ORD_APP_ID:()=>v,PERMISSION_TYPES:()=>l,PLATFORM:()=>s,PMC_PART_CONFIG_KEY_LONG_ID:()=>y,SITPOSTING_APP_ID:()=>m,TEXTLIVE_APPS:()=>f,THROTTLE_SCROLL_TIME:()=>a,VKPAY_APPS:()=>u,VKPAY_TRANSACTION_EVENT:()=>o,VK_CONNECT_EVENTS:()=>E,VK_CONNECT_SUPERAPPKIT_EVENT_TYPE:()=>h,VMOJI_CONSTRUCTOR_APP_ID:()=>g});const i="5.95",a=200,o="VKWebAppActionDone",s={WEB:"web",MOBILE_WEB:"mobile-web"},n={UNKNOWN:1,MISSING_PARAM:2,OLD_MISSING_PARAM:100,CONNECTION_LOST:3,USER_DENIED:4,INVALID_PARAMS:5,UNSUPPORTED_PLATFORM:6,REQUESTS_LIMIT_REACHED:10,ACCESS_DENIED:11,CUSTOM:13,NO_ADS:20},c={ACCESS_DENIED:"Access denied",UNSUPPORTED_PLATFORM:"Unsupported platform",UNSUPPORTED_ACTION:"Unsupported action",NATIVE_APP_IS_NOT_INSTALLED:"VK client is not installed on device",USER_NOT_A_PRIVATE_GROUP_MEMBER:"User is not a member of the given private group",UNKNOWN_ERROR:"Unknown error",CONNECTION_LOST:"Connection lost",NETWORK_ERROR:"Network error",USER_DENIED:"User denied",INVALID_PARAMS:"Invalid params",NO_ADS:"No ads",ADS_ALREADY_PLAYED:"Ads already played",VK_PAY_DISABLED:"This app can't use VK Pay",SCROLL_SUBSCRIBER_ALREADY_EXIST:"Scroll subscriber already exist",SUBSCRIPTION_IS_ALREADY_CANCELLED:"Subscription is in invalid status: subscription is already cancelled",SURVEY_INIT_IN_PROGRESS:"Survey init in progress",SURVEY_ALREADY_INIT:"Survey already init",SURVEY_NO_MATCH:"Survey no match",SURVEY_USER_CANCEL:"Survey user cancel",ALREADY_IN_PROGRESS:"Already in progress",USER_IS_NOT_GROUP_ADMIN:"Only group admins have access to group tokens",DEVICE_CANT_GET_GEODATA:"Device can't get geodata",USER_DIDNT_ALLOWED_ACTION:"User didn't allowed"},d={CLIENT:"client_error",API:"api_error",AUTH:"auth_error"},l={DENIED:"denied",PROMPT:"prompt",GRANTED:"granted"},p=["success","failed"],_={OPEN:0,CLOSED:1,PRIVATE:2},u=[6217559,7131443],f=[7512376],v=51707812,S=51459963,m=7644481,g=7929683,E={VKWebAppAddToCommunity:"add_to_community",VKWebAppAddToCommunityPreload:"get_groups_list",VKWebAppAddToFavorites:"add_to_favorites",VKWebAppAddToFavoritesPreload:"already_added_to_favorites",VKWebAppAddToMenu:"add_to_menu",VKWebAppAddToMenuPreload:"is_in_left_menu",VKWebAppGetCommunityToken:"get_community_token",VKWebAppGetCommunityTokenPreload:"get_community_preload_settings",VKWebAppGetAuthToken:"get_auth_token",VKWebAppGetAuthTokenPreload:"get_auth_token_info",VKWebAppGetPhoneNumber:"get_phone_number",VKWebAppGetPhoneNumberPreload:"already_get_phone_number",VKWebAppGetEmail:"get_email",VKWebAppGetEmailPreload:"already_get_email",VKWebAppGetFriends:"get_friends",VKWebAppAllowNotificationsPreload:"are_notifications_allowed",VKWebAppAllowNotifications:"allow_notifications",VKWebAppDenyNotifications:"deny_notifications",VKWebAppAllowMessagesFromGroup:"allow_messages_from_group",VKWebAppAllowMessagesFromGroupPreload:"can_send_messages_from_group",VKWebAppJoinGroup:"join_group",VKWebAppJoinGroupPreload:"is_group_member",VKWebAppLeaveGroup:"leave_group",VKWebAppLeaveGroupPreload:"is_group_member",VKWebAppOpenApp:"open_app",VKWebAppSendPayload:"send_payload",VKWebAppSendToClient:"send_to_client",VKWebAppSendToClientPreload:"get_open_in_native_permission",VKWebAppShowOrderBox:"order",VKWebAppShowSubscriptionBox:"subscription",VKWebAppShowLeaderBoardBox:"show_leader_board",VKWebAppShowLinkCardBox:"show_link_card",VKWebAppShowNftPaymentBox:"show_nft_pay_box",VKWebAppShowInviteBox:"invite_friends",VKWebAppShowStoryBox:"story_box",VKWebAppShowRequestBox:"send_request",VKWebAppShowRequestBoxPreload:"request_box_preload",VKWebAppStorageGetKeys:"storage_get_keys",VKWebAppStorageSet:"storage_set",VKWebAppStorageGet:"storage_get",VKWebAppOpenArticleEditor:"open_article_edit",VKWebAppSubscribeStoryApp:"subscribe_story_app",VKWebAppClose:"close",VKWebAppGetSilentToken:"get_silent_token",VKWebAppCheckAllowedScopes:"check_allowed_scopes",VKWebAppOpenPayForm:"open_pay_form",VKWebAppCheckSurvey:"check_survey",VKWebAppShowSurvey:"show_survey",VKWebAppAddToChat:"add_to_chat",VKWebAppTrackEvent:"track_event",VKWebAppCallStart:"call_start",VKWebAppCallJoin:"call_join",VKWebAppCallLeft:"call_left",VKWebAppCallFinished:"call_finished",VKWebAppCallGetStatus:"call_get_status"},h="vk-sak-sdk",y="mini_apps_long_id"},326845:(e,t,r)=>{r.d(t,{clearStoriesLoadingStats:()=>v,clearStoriesNavigationStats:()=>l,getConnectionType:()=>s,getStoriesLoadingStats:()=>f,getStoriesNavigationStats:()=>d,saveNavigationStatEvent:()=>c,saveViewerStartTime:()=>u,serializeLoadingStats:()=>S,serializeNavigationStats:()=>p});var i=r(659397),a=r(949253),o=r(388676);function s(){const{connection:e}=navigator;if(!e)return"";const{effectiveType:t,downlink:r}=e;switch(t){case"slow-2g":return"GPRS";case"2g":return"EDGE";case"3g":return"3G";case"4g":return r>8?"wi-fi":"LTE"}return""}let n=[];function c({storyRawId:e,source:t,action:r}){let i=0,s=0;e&&([i,s]=(0,o.splitStoryRawId)(e)),"reply"===t&&(t="replies_list");const c={e:a.STATS_EVENT_TYPE_STORIES_VIEWER_NAVIGATION,owner_id:i,story_id:s,source:t,action:r};n.push(c)}function d(){return(0,i.isArray)(n)?n:[]}function l(){n=[]}function p(){const e=n.map((({owner_id:e,story_id:t,source:r,action:i})=>[e,t,r,i].join(","))).join(";");return n=[],e}let _=[];function u({storyRawId:e,source:t,time:r}){const[i,n]=(0,o.splitStoryRawId)(e),c={e:a.STATS_EVENT_TYPE_STORIES_VIEWING_START_TIME,owner_id:i,story_id:n,source:t,time:r,internet_type:s()};_.push(c)}function f(){return(0,i.isArray)(_)?_:[]}function v(){_=[]}function S(){const e=_.map((({owner_id:e,story_id:t,source:r,time:i})=>[e,t,r,i].join(","))).join(";");return _=[],e}},749926:(e,t,r)=>{r.d(t,{createFriendsAddFx:()=>c,createFriendsAddListFx:()=>u,createFriendsDeleteBulkFx:()=>l,createFriendsDeleteFx:()=>d,createFriendsDeleteListFx:()=>f,createFriendsDeleteSubscriberFx:()=>m,createFriendsEditListFx:()=>v,createFriendsGetCountersFx:()=>h,createFriendsGetFollowersFx:()=>g,createFriendsGetFriendsDeletionSuggestionsFx:()=>s,createFriendsGetFx:()=>o,createFriendsGetListsFx:()=>a,createFriendsGetOnlineFx:()=>_,createFriendsGetRecommendationsFx:()=>n,createFriendsGetRequestsFx:()=>p,createFriendsRequestsToSubscribersFx:()=>E,createFriendsSearchFx:()=>S});var i=r(963632);const a=e=>(0,i.createApiEffect)("friends.getLists",e),o=e=>(0,i.createApiEffect)("friends.get",e),s=e=>(0,i.createApiEffect)("friends.getFriendsDeletionSuggestions",e),n=e=>(0,i.createApiEffect)("friends.getRecommendations",e),c=e=>(0,i.createApiEffect)("friends.add",e),d=e=>(0,i.createApiEffect)("friends.delete",e),l=e=>(0,i.createApiEffect)("friends.deleteBulk",e),p=e=>(0,i.createApiEffect)("friends.getRequests",e),_=e=>(0,i.createApiEffect)("friends.getOnline",e),u=e=>(0,i.createApiEffect)("friends.addList",e),f=e=>(0,i.createApiEffect)("friends.deleteList",e),v=e=>(0,i.createApiEffect)("friends.editList",e),S=e=>(0,i.createApiEffect)("friends.search",e),m=e=>(0,i.createApiEffect)("friends.deleteSubscriber",e),g=e=>(0,i.createApiEffect)("friends.getFollowers",e),E=e=>(0,i.createApiEffect)("friends.requestsToSubscribers",e),h=e=>(0,i.createApiEffect)("friends.getCounters",e)},552248:(e,t,r)=>{r.d(t,{formatCount:()=>i});const i=(e,t)=>{var r,i,a,o,s,n,c;const d=(null==(r=t)?void 0:r.separator)||".";var l;const p=null!=(l=null==(i=t)?void 0:i.maximumFractionDigits)?l:1,_=(null==(a=t)?void 0:a.roundingMode)||void 0,u=(null==(o=t)?void 0:o.kLimit)||1e3,f=(null==(s=t)?void 0:s.mLimit)||1e6,v=(null==(n=t)?void 0:n.bLimit)||1e9,S=(null==(c=window.langConfig)?void 0:c.locale)||"ru",m=(e,t)=>{"floor"===_&&(e=Math.floor(e*Math.pow(10,p))/Math.pow(10,p));let r=e.toFixed(p);return Number(r).toLocaleString(S).replace(/\./,d)+t};if(e>-u&&e<u)return e.toLocaleString(S);const g=e/v;if(g>=1||g<=-1)return m(e/1e9,"B");const E=e/f;if(E>=1||E<=-1)return m(e/1e6,"M");const h=e/u;return h>=1||h<=-1?m(e/1e3,"K"):String(e)}},416569:(e,t,r)=>{r.d(t,{apiAudioToAudioTuple:()=>n});var i=r(577686),a=r(659397),o=r(834909),s=r(448297);const n=e=>{var t,r,n,c,d,l,p,_,u,f,v,S;return e?[e.id,e.owner_id,e.url||"",(0,i.clean)(e.title),(0,i.clean)(e.artist||e.performer||""),e.duration,e.album_id||0,0,"",e.lyrics_id||0,0,"","[]",(0,o.getAudioHashesString)({addHash:e.access_key,editHash:e.access_key,actionHash:e.access_key,deleteHash:e.access_key,replaceHash:e.access_key,urlHash:e.access_key,restoreHash:e.access_key}),(null==(r=e.album)||null==(t=r.thumb)?void 0:t.sizes)?(null==(n=(0,a.getPhotoSize)((null==(d=e.album)||null==(c=d.thumb)?void 0:c.sizes)||[],(0,s.getImageMinWidth)(200)))?void 0:n.url)||"":`${null==(p=e.album)||null==(l=p.thumb)?void 0:l.photo_300},${null==(u=e.album)||null==(_=u.thumb)?void 0:_.photo_135}`||"",e.ads||{},(0,i.clean)(e.subtitle||""),e.main_artists||"",e.featured_artists||"",!!e.album&&[null==(f=e.album)?void 0:f.owner_id,null==(v=e.album)?void 0:v.id,null==(S=e.album)?void 0:S.access_key],e.track_code||"",e.content_restricted||0,e.album_part_number||0,!0,e.access_key||"",e.audio_chart_info||!1,""]:null}},958642:(e,t,r)=>{r.d(t,{AUDIO_PLAYER_ADAPTER_HASHES_SEPARATOR:()=>i});const i="/"},834909:(e,t,r)=>{r.d(t,{getAudioHashesString:()=>a});var i=r(958642);const a=({addHash:e,editHash:t,actionHash:r,deleteHash:a,replaceHash:o,urlHash:s,restoreHash:n})=>[e||"",t||"",r||"",a||"",o||"",s||"",n||""].join(i.AUDIO_PLAYER_ADAPTER_HASHES_SEPARATOR)},855589:(e,t,r)=>{r.d(t,{createCacheService:()=>a});var i=r(280729);const a=e=>{const t=(0,i.getEffectorServiceDomain)(e),r=Object.create(null),a=t.createStore(Object.create(null)),o=t.createEvent("add"),s=t.createEvent("delete");return a.on(o,((e,{key:t,data:r})=>(e[t]=r,e))).on(s,((e,t)=>(delete e[t],e))),{$cache:a,add:o,delete:s,get:e=>a.getState()[e]||null,isWaited:e=>void 0!==r[e],getWaited:e=>r[e],setWaited:(e,t)=>{r[e]=t},deleteWaited:e=>{delete r[e]}}}},330253:(e,t,r)=>{r.d(t,{createOwnerService:()=>a.createOwnerService,createUserService:()=>i.createUserService});var i=r(93233),a=r(373845)},373845:(e,t,r)=>{r.d(t,{createOwnerService:()=>p});var i=r(434788),a=r(798116),o=r(87330),s=r(547142),n=r(855589),c=r(280729),d=r(304244);const l=(0,n.createCacheService)(),p=e=>{const t=e.fields||[],r=(0,c.getEffectorServiceDomain)(e),n=r.createStore({id:0}),p=r.createEvent("initialize"),_=r.createEvent("reload"),u=r.createEffect({name:"initializeFx"}),f=u.pending,v=u.doneData;return u.use((({ownerId:e,useCache:r})=>{if(r){const r=l.get(e);if(r){if(t.every((e=>r.hasOwnProperty(e))))return Promise.resolve(r)}}if(l.isWaited(e)){const r=l.getWaited(e).find((e=>t.every((t=>Boolean(e.fields[t])))));if(r)return r.promise.finally((()=>{l.deleteWaited(e)})),r.promise}let i=s.Ranges.isGroupId(e)?(0,o.apiWithPrefetch)("groups.getById",{group_ids:String(e),fields:t.join(",")}).then((t=>{var r;return(null==(r=t.groups)?void 0:r[0])||{id:e}})):(0,o.apiWithPrefetch)("users.get",{user_ids:String(e),fields:t.join(",")}).then((e=>e[0]));const a={fields:t.reduce(((e,t)=>(e[t]=!0,e)),{}),promise:i},n=l.isWaited(e)?[...l.getWaited(e),a]:[a];return l.setWaited(e,n),i})),(0,a.sample)({clock:p,source:n,filter:(e,t)=>e.id!==t,fn:(t,r)=>{var i;return{ownerId:r,useCache:Boolean(null==(i=e)?void 0:i.useCache)}},target:u}),(0,a.sample)({clock:_,source:n,fn:e=>({ownerId:e.id}),target:u}),(0,a.sample)({clock:u.doneData,target:n}),(0,a.sample)({clock:u.doneData,filter:()=>{var t;return Boolean(null==(t=e)?void 0:t.useCache)},fn:e=>{const t=l.get(e.id);if(t){if((0,d.isOwnerUser)(t)&&(0,d.isOwnerUser)(e))return{key:e.id,data:(0,i._)({},t,e)};if((0,d.isOwnerGroup)(t)&&(0,d.isOwnerGroup)(e))return{key:e.id,data:(0,i._)({},t,e)}}return{key:e.id,data:e}},target:l.add}),{$isInitializing:f,$owner:n,initialize:p,onInitialized:v,reload:_}}},93233:(e,t,r)=>{r.d(t,{createUserService:()=>n});var i=r(11010),a=r(434788),o=r(798116),s=r(87330);const n=({domain:e})=>{const t=(e,t)=>!(!e||e.id!==t.userId),r=e.createStore(null),n=e.createEffect((({params:e})=>(0,s.apiWithPrefetch)("users.get",e))),c=e.createEffect((0,i._)((function*(e){return{userId:e.params.owner_id,response:yield(0,s.api)("wall.subscribe",e.params)}}))),d=e.createEffect((0,i._)((function*(e){return{userId:e.params.owner_id,response:yield(0,s.api)("wall.unsubscribe",e.params)}}))),l=e.createEffect((0,i._)((function*(e){return{userId:e.params.owner_id,response:yield(0,s.api)("video.liveSubscribe",e.params)}}))),p=e.createEffect((0,i._)((function*(e){return{userId:e.params.owner_id,response:yield(0,s.api)("video.liveUnsubscribe",e.params)}}))),_=e.createEffect((0,i._)((function*(e){return{userId:e.params.user_id,response:yield(0,s.api)("fave.addUser",e.params)}}))),u=e.createEffect((0,i._)((function*(e){return{userId:e.params.user_id,response:yield(0,s.api)("fave.removeUser",e.params)}}))),f=e.createEffect((0,i._)((function*(e){return{userId:e.params.owner_id,response:yield(0,s.api)("account.ban",e.params)}}))),v=e.createEffect((0,i._)((function*(e){return{userId:e.params.owner_id,response:yield(0,s.api)("account.unban",e.params)}}))),S=e.createEffect((0,i._)((function*(e){return{userId:e.params.user_id,response:yield(0,s.api)("bestFriends.add",e.params)}}))),m=e.createEffect((0,i._)((function*(e){return{userId:e.params.user_id,response:yield(0,s.api)("bestFriends.delete",e.params)}})));return(0,o.sample)({clock:n.doneData,fn:e=>e[0]||null,target:r}),(0,o.sample)({clock:c.doneData,source:r,filter:t,fn:e=>(0,a._)({},e,{is_subscribed:1}),target:r}),(0,o.sample)({clock:d.doneData,source:r,filter:t,fn:e=>(0,a._)({},e,{is_subscribed:0}),target:r}),(0,o.sample)({clock:l.doneData,source:r,filter:t,fn:e=>(0,a._)({},e,{video_live:e.video_live?(0,a._)({},e.video_live,{is_notifications_blocked:0}):void 0}),target:r}),(0,o.sample)({clock:p.doneData,source:r,filter:t,fn:e=>(0,a._)({},e,{video_live:e.video_live?(0,a._)({},e.video_live,{is_notifications_blocked:1}):void 0}),target:r}),(0,o.sample)({clock:_.doneData,source:r,filter:t,fn:e=>(0,a._)({},e,{is_favorite:1}),target:r}),(0,o.sample)({clock:u.doneData,source:r,filter:t,fn:e=>(0,a._)({},e,{is_favorite:0}),target:r}),(0,o.sample)({clock:f.doneData,source:r,filter:t,fn:e=>(0,a._)({},e,{blacklisted_by_me:1}),target:r}),(0,o.sample)({clock:v.doneData,source:r,filter:t,fn:e=>(0,a._)({},e,{blacklisted_by_me:0}),target:r}),(0,o.sample)({clock:S.doneData,source:r,filter:t,fn:e=>(0,a._)({},e,{is_best_friend:!0}),target:r}),(0,o.sample)({clock:m.doneData,source:r,filter:t,fn:e=>(0,a._)({},e,{is_best_friend:!1}),target:r}),{fetchUserFx:n,subscribeToPostsFx:c,unsubscribeFromPostsFx:d,subscribeToVideoLiveFx:l,unsubscribeFromVideoLiveFx:p,faveAddUserFx:_,faveRemoveUserFx:u,accountBanFx:f,accountUnbanFx:v,bestFriendAddFx:S,bestFriendDeleteFx:m,$user:r,domain:e}}},458038:(e,t,r)=>{r.d(t,{apiFaveAddNarrative:()=>a,apiFaveRemoveNarrative:()=>o});var i=r(87330);function a(e){return(0,i.api)("fave.addNarrative",e)}function o(e){return(0,i.api)("fave.removeNarrative",e)}},735825:(e,t,r)=>{r.d(t,{createFaveService:()=>i.createFaveService});r(458038);var i=r(377169)},377169:(e,t,r)=>{r.d(t,{createFaveService:()=>o});var i=r(798116),a=r(458038);const o=({domain:e})=>{const t=e.createEvent("fire/faveAddNarrative"),r=e.createEvent("fire/faveRemoveNarrative"),o=e.createEffect("fx/faveAddNarrative"),s=e.createEffect("fx/faveRemoveNarrative");return o.use(a.apiFaveAddNarrative),s.use(a.apiFaveRemoveNarrative),(0,i.sample)({clock:t,target:o}),(0,i.sample)({clock:r,target:s}),{fireAddNarrative:t,fireRemoveNarrative:r,addNarrativeFx:o,removeNarrativeFx:s}}},50173:(e,t,r)=>{r.d(t,{findOwnerById:()=>o,isGroup:()=>a});var i=r(323241);function a(e){return i.Ranges.isGroupId(e.id)}const o=(e=0,t=[],r=[])=>{if(e)return i.Ranges.isUserId(e)?t.find((t=>{var r;return(null==(r=t)?void 0:r.id)===e})):r.find((t=>{var r;return(null==(r=t)?void 0:r.id)===Math.abs(e)}))}},93473:(e,t,r)=>{var i,a,o,s,n,c,d,l;r.d(t,{StickerTypes:()=>c,StoryBlockType:()=>s,StoryEntryPoint:()=>a,StoryListName:()=>n,StoryPollBackgroundType:()=>l,StorySource:()=>o,StoryStickerSubtype:()=>d,StoryType:()=>i}),function(e){e.PHOTO="photo",e.VIDEO="video",e.LIVE="live"}(i||(i={})),function(e){e.SWIPE="swipe",e.NAVIGATION_BUTTON="navigation_button",e.SIT_POSTING="sit_posting",e.LINK="link",e.STORY_REPLY="story_reply",e.STORY_REPOST="story_repost",e.CATALOG_ADD="catalog_add",e.DIALOG="dialog",e.STORY_LIVE_FINISHED="story_live_finished",e.DIALOG_VKME="dialog_vkme",e.STORY_VIEWER_FINISHED="story_viewer_finished",e.PUSH_TRY_MASK="push_try_mask",e.STORY_VIEWER_TRY_MASK="story_viewer_try_mask",e.LINK_MASK="link_mask",e.POSTING="posting",e.NEW_STORY_AVATAR="new_story_avatar",e.STORY_REPLIES_LIST="story_replies_list",e.STORIES_FEED="stories_feed",e.STORIES_SEARCH_NEWS="stories_search_news",e.QUESTION_STICKER="question_sticker",e.LIST_MIDDLE="list_middle",e.ARCHIVE_EMPTY_BUTTON="archive_empty_button",e.ARCHIVE_MENU_BUTTON="archive_menu_button",e.IM="im",e.PROFILE_BUTTON="profile_button",e.SHARE="share",e.MINI_APP="mini_app",e.SYSTEM_SHARING="system_sharing",e.SHORTCUT="shortcut",e.ARCHIVE_SHARING="archive_sharing",e.STORY_VIEWER_CAMERA_BUTTON="story_viewer_camera_button",e.STORY_VIEWER_MUSIC="story_viewer_music",e.STORY_VIEWER_MUSIC_SHEET="story_viewer_music_sheet",e.REPOST_TO_STORY_ACTIVITY="repost_to_story_activity",e.CHANGE_AVATAR="change_avatar"}(a||(a={})),function(e){e.FEED="feed",e.FEED_MIDDLE="feed_middle",e.LINK="link",e.PROFILE="profile",e.IM_DIALOGS="im_dialogs",e.IM_DIALOG_HEADER="im_dialog_header",e.SNIPPET="snippet",e.REPLY="reply",e.REPLIES_LIST="replies_list",e.REPLY_STORY="reply_story",e.DISCOVER="discover",e.STORIES_MANAGE="stories_manage",e.USER_PERSONAL_CARD="user_personal_card",e.GROUP_PERSONAL_CARD="group_personal_card",e.NARRATIVE_SNIPPET="narrative_snippet",e.NARRATIVE_STORY="narrative_story",e.NARRATIVE_LINK="narrative_link",e.NARRATIVE_RECOMMENDATIONS="narrative_recommendations",e.NARRATIVE_SECTION="narrative_section",e.FAVE="fave",e.SPAMFEED="sf",e.ADS_PREVIEW="ads_preview",e.LIST_MIDDLE="list_middle",e.PLACE_STORY_LIST="place_story_list",e.SEARCH_STORY_LIST="search_story_list",e.STORY_ARCHIVE="story_archive",e.IM_MSG_LIST="im_msg_list",e.NOSPAM="nospam",e.PROFILE_SNACKBAR="profile_snackbar",e.MY_QUESTIONS="question_story"}(o||(o={})),function(e){e.stories="stories",e.appGroupedStories="app_grouped_stories",e.discover="discover"}(s||(s={})),function(e){e.feed="feed",e.apps="apps",e.discover="discover"}(n||(n={})),function(e){e[e.hashtag=1]="hashtag",e[e.mention=2]="mention",e[e.question=3]="question",e[e.place=4]="place",e[e.music=5]="music",e[e.storyReply=6]="storyReply",e[e.owner=7]="owner",e[e.link=8]="link",e[e.marketItem=9]="marketItem",e[e.post=10]="post",e[e.poll=11]="poll",e[e.sticker=12]="sticker",e[e.app=13]="app",e[e.situationalTheme=14]="situationalTheme",e[e.playlist=15]="playlist",e[e.videoButton=16]="videoButton"}(c||(c={})),function(e){e.aliexpress="aliexpress_product",e.market="market_item"}(d||(d={})),function(e){e.photo="photo",e.gradient="gradient",e.default="default"}(l||(l={}))},95948:(e,t,r)=>{r.d(t,{apiLikesAdd:()=>a,apiLikesDelete:()=>o});var i=r(87330);function a(e){return(0,i.api)("likes.add",e)}function o(e){return(0,i.api)("likes.delete",e)}},420179:(e,t,r)=>{var i;!function(e){e.Story="story"}(i||(i={}))},509902:(e,t,r)=>{r.d(t,{createLikesService:()=>i.createLikesService});var i=r(958434);r(95948),r(420179)},958434:(e,t,r)=>{r.d(t,{createLikesService:()=>o});var i=r(798116),a=r(95948);const o=({domain:e})=>{const t=e.createEvent("fire/likesAdd"),r=e.createEvent("fire/likesDelete"),o=e.createEffect("fx/likesAdd"),s=e.createEffect("fx/likesDelete");return o.use(a.apiLikesAdd),s.use(a.apiLikesDelete),(0,i.sample)({clock:t,target:o}),(0,i.sample)({clock:r,target:s}),{fireAdd:t,fireDelete:r,addFx:o,deleteFx:s}}},888440:(e,t,r)=>{r.d(t,{apiMessagesSend:()=>a});var i=r(87330);function a(e){return(0,i.api)("messages.send",e)}},404625:(e,t,r)=>{r.d(t,{apiMessagesSend:()=>i.apiMessagesSend,createMessagesService:()=>a.createMessagesService});var i=r(888440),a=r(463471)},463471:(e,t,r)=>{r.d(t,{createMessagesService:()=>o});var i=r(798116),a=r(888440);const o=({domain:e})=>{const t=e.createEvent("fire/messageSend"),r=e.createEffect("fx/messageSend");return r.use(a.apiMessagesSend),(0,i.sample)({clock:t,target:r}),{fireMessagesSend:t,sendFx:r}}},395410:(e,t,r)=>{r.d(t,{apiNarrativesBatchEdit:()=>s,apiNarrativesCreate:()=>a,apiNarrativesDelete:()=>n,apiNarrativesEdit:()=>o,apiNarrativesGetById:()=>c,apiNarrativesGetFeedBlock:()=>d,apiNarrativesGetFromOwner:()=>l,apiNarrativesReorder:()=>_,apiNarrativesSaveCustomCover:()=>p});var i=r(87330);function a(e){return(0,i.api)("narratives.create",e)}function o(e){return(0,i.api)("narratives.edit",e)}function s(e){return(0,i.api)("narratives.batchEdit",e)}function n(e){return(0,i.api)("narratives.delete",e)}function c(e){return(0,i.api)("narratives.getById",e)}function d(e={}){return(0,i.api)("narratives.getFeedBlock",e)}function l(e){return(0,i.api)("narratives.getFromOwner",e)}function p(e){return(0,i.api)("narratives.saveCustomCover",e)}function _(e){return(0,i.api)("narratives.reorder",e)}},383719:(e,t,r)=>{r.d(t,{apiNarrativesGetById:()=>a.apiNarrativesGetById,apiNarrativesGetFeedBlock:()=>a.apiNarrativesGetFeedBlock,apiNarrativesGetFromOwner:()=>a.apiNarrativesGetFromOwner,createNarrativesService:()=>i.createNarrativesService});var i=r(898484),a=r(395410)},898484:(e,t,r)=>{r.d(t,{createNarrativesService:()=>o});var i=r(798116),a=r(395410);const o=({domain:e})=>{const t=e.createEvent("fire/narrativesGetById"),r=e.createEvent("fire/narrativesGetFromOwner"),o=e.createEvent("fire/narrativesGetFeedBlock"),s=e.createEvent("fire/narrativesCreate"),n=e.createEvent("fire/narrativesEdit"),c=e.createEvent("fire/narrativesBatchEdit"),d=e.createEvent("fire/narrativesDelete"),l=e.createEvent("fire/narrativesSaveCustomCover"),p=e.createEvent("fire/narrativesReorder"),_=e.createEffect("fx/narrativesGetById"),u=e.createEffect("fx/narrativesGetFromOwner"),f=e.createEffect("fx/narrativesGetFeedBlock"),v=e.createEffect("fx/narrativesCreate"),S=e.createEffect("fx/narrativesEdit"),m=e.createEffect("fx/narrativesBatchEdit"),g=e.createEffect("fx/narrativesDelete"),E=e.createEffect("fx/narrativesSaveCustomCover"),h=e.createEffect("fx/narrativesReorder");return _.use(a.apiNarrativesGetById),u.use(a.apiNarrativesGetFromOwner),f.use(a.apiNarrativesGetFeedBlock),v.use(a.apiNarrativesCreate),S.use(a.apiNarrativesEdit),m.use(a.apiNarrativesBatchEdit),g.use(a.apiNarrativesDelete),E.use(a.apiNarrativesSaveCustomCover),h.use(a.apiNarrativesReorder),(0,i.sample)({clock:t,target:_}),(0,i.sample)({clock:r,target:u}),(0,i.sample)({clock:o,target:f}),(0,i.sample)({clock:s,target:v}),(0,i.sample)({clock:n,target:S}),(0,i.sample)({clock:c,target:m}),(0,i.sample)({clock:d,target:g}),(0,i.sample)({clock:l,target:E}),(0,i.sample)({clock:p,target:h}),{fireGetById:t,fireGetFromOwner:r,fireGetFeedBlock:o,fireCreate:s,fireEdit:n,fireBatchEdit:c,fireDelete:d,fireSaveCustomCover:l,fireReorder:p,getByIdFx:_,getFromOwnerFx:u,getFeedBlockFx:f,createFx:v,editFx:S,batchEditFx:m,deleteFx:g,saveCustomCoverFx:E,reorderFx:h}}},66334:(e,t,r)=>{function i(e,t=","){return e&&e.length?e.reduce(((e,r)=>{const i="rawId"in r?r.rawId:`${r.owner_id}_${r.id}`;return i&&(e+=`${e.length?t:""}${i}`),e}),""):""}r.d(t,{joinNarrativeRawIds:()=>i})},696812:(e,t,r)=>{r.d(t,{PHOTO_ALBUM_COVER_MIN_WIDTH:()=>i,getPhotoSize:()=>a});const i=200;function a(e,t){var r,i,a,o;if(!(null==(i=e)||null==(r=i.sizes)?void 0:r.length))return"";const s=[...e.sizes].sort(((e,t)=>e.width-t.width));let n=s.find((e=>e.width>=t));return(null==(a=n)?void 0:a.url)?n.url:(n=s.reverse().find((e=>e.width<t)),(null==(o=n)?void 0:o.url)?n.url:"")}},173542:(e,t,r)=>{r.d(t,{apiPollsCreate:()=>o,apiPollsGetById:()=>a});var i=r(87330);function a(e){return(0,i.api)("polls.getById",e)}function o(e){return(0,i.api)("polls.create",e)}},49661:(e,t,r)=>{r.d(t,{createPollsService:()=>i.createPollsService});r(173542);var i=r(622542)},622542:(e,t,r)=>{r.d(t,{createPollsService:()=>o});var i=r(798116),a=r(173542);const o=({domain:e})=>{const t=e.createEvent("fire/pollsGetById"),r=e.createEvent("fire/pollsCreate"),o=e.createEffect("fx/pollsGetById"),s=e.createEffect("fx/pollsCreate");return o.use(a.apiPollsGetById),s.use(a.apiPollsCreate),(0,i.sample)({clock:t,target:o}),(0,i.sample)({clock:r,target:s}),{fireGetById:t,fireCreate:r,getByIdFx:o,createFx:s}}},517591:(e,t,r)=>{r.d(t,{apiStatsTrackEvents:()=>a});var i=r(87330);function a(e){return(0,i.api)("stats.trackEvents",e)}},949253:(e,t,r)=>{r.d(t,{STATS_EVENT_TYPE_STORIES_VIEWER_NAVIGATION:()=>i,STATS_EVENT_TYPE_STORIES_VIEWING_START_TIME:()=>a,STATS_EVENT_TYPE_STORY_LINK_VIEW:()=>o,STATS_EVENT_TYPE_VIDEO_ONBOARDING:()=>s});const i="stories_viewer_navigation",a="stories_viewing_start_time",o="story_link_view",s="video_onboarding"},639636:(e,t,r)=>{r.d(t,{STATS_EVENT_TYPE_STORY_LINK_VIEW:()=>i.STATS_EVENT_TYPE_STORY_LINK_VIEW,STATS_EVENT_TYPE_VIDEO_ONBOARDING:()=>i.STATS_EVENT_TYPE_VIDEO_ONBOARDING,apiStatsTrackEvents:()=>a.apiStatsTrackEvents,createStatsService:()=>o.createStatsService});var i=r(949253),a=r(517591),o=r(525690)},525690:(e,t,r)=>{r.d(t,{createStatsService:()=>o});var i=r(798116),a=r(517591);const o=({domain:e})=>{const t=e.createEvent("fire/statsTrackEvents"),r=e.createEffect("fx/statsTrackEvents");return r.use(a.apiStatsTrackEvents),(0,i.sample)({clock:t,target:r}),{fireTrackEvents:t,trackEventsFx:r}}},299891:(e,t,r)=>{r.d(t,{apiStoriesAskQuestion:()=>h,apiStoriesBanOwner:()=>R,apiStoriesBanQuestionAuthor:()=>k,apiStoriesDelete:()=>E,apiStoriesDeleteQuestion:()=>y,apiStoriesGet:()=>a,apiStoriesGetArchive:()=>c,apiStoriesGetById:()=>s,apiStoriesGetDetailedStats:()=>u,apiStoriesGetDiscover:()=>n,apiStoriesGetPhotoUploadServer:()=>I,apiStoriesGetQuestions:()=>p,apiStoriesGetReplies:()=>l,apiStoriesGetStats:()=>_,apiStoriesGetVideoUploadServer:()=>b,apiStoriesGetViewers:()=>d,apiStoriesGetWithPrefetch:()=>o,apiStoriesHideAllReplies:()=>P,apiStoriesHidePrivacyBlock:()=>g,apiStoriesHideReply:()=>x,apiStoriesMarkAppNotificationsSeen:()=>w,apiStoriesMarkNotInterested:()=>v,apiStoriesMarkSeen:()=>m,apiStoriesMarkSkipped:()=>f,apiStoriesSave:()=>N,apiStoriesSearch:()=>S,apiStoriesSetDiscoverVisible:()=>F,apiStoriesSubscribeUserToApp:()=>T,apiStoriesUnbanOwner:()=>O,apiStoriesUnbanQuestionAuthor:()=>A});var i=r(87330);function a(e){return(0,i.api)("stories.get",e)}function o(e){return(0,i.apiWithPrefetch)("stories.get",e)}function s(e){return(0,i.api)("stories.getById",e)}function n(e){return(0,i.api)("stories.getDiscover",e)}function c(e){return(0,i.api)("stories.getArchive",e)}function d(e){return(0,i.api)("stories.getViewers",e)}function l(e){return(0,i.api)("stories.getReplies",e)}function p(e){return(0,i.api)("stories.getQuestions",e)}function _(e){return(0,i.api)("stories.getStats",e)}function u(e){return(0,i.api)("stories.getDetailedStats",e)}function f(e){return(0,i.api)("stories.markSkipped",e)}function v(e){return(0,i.api)("stories.markNotInterested",e)}function S(e){return(0,i.api)("stories.search",e)}function m(e){return(0,i.api)("stories.markSeen",e)}function g(e){return(0,i.api)("stories.hidePrivacyBlock",e)}function E(e){return(0,i.api)("stories.delete",e)}function h(e){return(0,i.api)("stories.askQuestion",e)}function y(e){return(0,i.api)("stories.deleteQuestion",e)}function k(e){return(0,i.api)("stories.banQuestionAuthor",e)}function A(e){return(0,i.api)("stories.unbanQuestionAuthor",e)}function w(e){return(0,i.api)("stories.markAppNotificationsSeen",e)}function T(e){return(0,i.api)("stories.subscribeUserToApp",e)}function I(e){return(0,i.api)("stories.getPhotoUploadServer",e)}function b(e){return(0,i.api)("stories.getVideoUploadServer",e)}function N(e){return(0,i.api)("stories.save",e)}function R(e){return(0,i.api)("stories.banOwner",e)}function O(e){return(0,i.api)("stories.unbanOwner",e)}function F(e){return(0,i.api)("stories.setDiscoverVisible",e)}function x(e){return(0,i.api)("stories.hideReply",e)}function P(e){return(0,i.api)("stories.hideAllReplies",e)}},453942:(e,t,r)=>{r.d(t,{STORIES_ARCHIVE_START_TIME:()=>a,STORIES_MAX_COUNT_REPLIES:()=>i});const i=250,a=1559032200},738507:(e,t,r)=>{r.d(t,{StoryFeedbackLoadMethods:()=>i,fetchFeedbackFx:()=>n,getStoryFeedbackLoadParams:()=>s});var i,a=r(156079),o=r(203917);!function(e){e[e.getViewers=0]="getViewers",e[e.getReplies=1]="getReplies",e[e.getQuestions=2]="getQuestions",e[e.getDetailedStats=3]="getDetailedStats",e[e.getStats=4]="getStats"}(i||(i={}));const s=(e,t)=>({0:{owner_id:e,story_id:t,extended:1,count:100,fields:(0,o.makeOwnerFields)(["is_nft","photo_100","photo_50"])},1:{owner_id:e,story_id:t,extended:1,fields:(0,o.getStoryOwnerFields)()},2:{owner_id:e,story_id:t,extended:1,fields:(0,o.makeOwnerFields)(["domain","first_name_dat","first_name_ins","last_name_ins","last_name_dat","first_name_gen","last_name_gen"]),count:30},3:{owner_id:e,story_id:t},4:{owner_id:e,story_id:t}}),n=a.storiesDomain.createEffect({name:"fire/storiesGetFeedback",handler:({ownerId:e,storyId:t,pollId:r})=>{const i=s(e,t);return Promise.allSettled([a.storiesService.getViewersFx(i[0]),a.storiesService.getRepliesFx(i[1]),a.storiesService.getQuestionsFx(i[2]),r?a.pollsService.getByIdFx({owner_id:e,poll_id:r}):Promise.resolve(null),a.storiesService.getDetailedStatsFx(i[3]),a.storiesService.getStatsFx(i[4])]).then((e=>e.map((e=>{var t;return"fulfilled"===e.status?null==(t=e)?void 0:t.value:null}))))}})},760474:(e,t,r)=>{r.d(t,{STORIES_ARCHIVE_START_TIME:()=>n.STORIES_ARCHIVE_START_TIME,STORIES_MAX_COUNT_REPLIES:()=>n.STORIES_MAX_COUNT_REPLIES,StoryFeedbackLoadMethods:()=>d.StoryFeedbackLoadMethods,apiStoriesGet:()=>s.apiStoriesGet,apiStoriesGetArchive:()=>s.apiStoriesGetArchive,apiStoriesGetById:()=>s.apiStoriesGetById,apiStoriesGetDiscover:()=>s.apiStoriesGetDiscover,apiStoriesGetReplies:()=>s.apiStoriesGetReplies,apiStoriesGetWithPrefetch:()=>s.apiStoriesGetWithPrefetch,apiStoriesSearch:()=>s.apiStoriesSearch,clearStoriesLoadingStats:()=>o.clearStoriesLoadingStats,clearStoriesNavigationStats:()=>o.clearStoriesNavigationStats,createStoriesService:()=>i.createStoriesService,decodeBase64:()=>a.decodeBase64,faveService:()=>c.faveService,fetchFeedbackFx:()=>d.fetchFeedbackFx,getConnectionType:()=>o.getConnectionType,getStoriesLoadingStats:()=>o.getStoriesLoadingStats,getStoriesNavigationStats:()=>o.getStoriesNavigationStats,getStoryFeedbackLoadParams:()=>d.getStoryFeedbackLoadParams,narrativesService:()=>c.narrativesService,saveNavigationStatEvent:()=>o.saveNavigationStatEvent,saveViewerStartTime:()=>o.saveViewerStartTime,serializeLoadingStats:()=>o.serializeLoadingStats,serializeNavigationStats:()=>o.serializeNavigationStats,splitStoryRawId:()=>a.splitStoryRawId,statsService:()=>c.statsService,storiesService:()=>c.storiesService,userService:()=>c.userService});var i=r(711669),a=r(388676),o=r(326845),s=r(299891),n=r(453942),c=r(156079),d=r(738507)},856728:(e,t,r)=>{r.d(t,{fetchList:()=>k,parseExtra:()=>w});var i=r(31195),a=r(760474),o=r(383719),s=r(203917),n=r(86548),c=r(66334),d=r(414126);const l=/^feed$/,p=/^discover$/,_=/(-?\d+)_(\d+)/,u=/^owner_feed(-?\d+)/,f=/^replies(-?\d+)_(\d+)/,v=/^narrative(-?\d+)_(\d+)$/,S=/^narratives(-?\d+)$/,m=/^recommended_narratives$/,g=/^archive(?:(-?\d+)_)?([0-9]+)/,E=/^search_([\w|-]+)/,h=/^place(\d+)/,y=(0,d.partConfigEnabled)("mvk_feed_stories_block_async_with_prefetch");function k(e,t){let r=e.match(l);if(r)return(y?a.apiStoriesGetWithPrefetch:a.apiStoriesGet)({fields:(0,s.getStoryOwnerFields)(),extended:1}).then((t=>{var r;return{list:(0,i.transformStoryGetApiResponseToLegacyFormat)(t,e,(0,n.isMvk)()),nextFrom:(null==(r=t)?void 0:r.next_from)||"",response:t}}));var d,k,w;if(r=e.match(p),r)return(0,a.apiStoriesGetDiscover)({count:null==(d=t)?void 0:d.count,track_code:null==(k=t)?void 0:k.trackCode,start_from:null==(w=t)?void 0:w.startFrom,fields:(0,s.getStoryOwnerFields)(),extended:1}).then((t=>{var r;return{list:(0,i.transformStoryGetApiResponseToLegacyFormat)(t,e,(0,n.isMvk)()),nextFrom:(null==(r=t)?void 0:r.next_from)||""}}));if(r=e.match(u),r){const t=Number(r[1]);return t?(0,a.apiStoriesGet)({owner_id:t,fields:(0,s.getStoryOwnerFields)(),extended:1}).then((t=>{var r;return{list:(0,i.transformStoryGetApiResponseToLegacyFormat)(t,e,(0,n.isMvk)()),nextFrom:(null==(r=t)?void 0:r.next_from)||""}})):Promise.reject("empty ownerId")}if(r=e.match(f),r){const t=Number(r[1]),o=Number(r[2]);return t&&o?(0,a.apiStoriesGetReplies)({owner_id:t,story_id:o,fields:(0,s.getStoryOwnerFields)(),extended:1}).then((t=>{var r;return{list:(0,i.transformStoryGetApiResponseToLegacyFormat)(t,e,(0,n.isMvk)()),nextFrom:(null==(r=t)?void 0:r.next_from)||""}})):Promise.reject("ownerId or storyId is empty")}if(r=e.match(v),r){const t=Number(r[1]),i=Number(r[2]);if(!t||!i)return Promise.reject("ownerId or narrativeId is empty");return A(e,`${t}_${i}`)}if(r=e.match(S),r){var T,I;const i=Number(r[1]);if(!i)return Promise.reject("ownerId is empty");let a=null==(T=t)?void 0:T.narrativeRawIds;return(null==(I=a)?void 0:I.length)?A(e,a):(0,o.apiNarrativesGetFromOwner)({owner_id:i,with_empty:0,limit:15}).then((t=>{var r,i;return a=(0,c.joinNarrativeRawIds)(null==(r=t)?void 0:r.items),(null==(i=a)?void 0:i.length)?A(e,a):Promise.reject("narrativeRawIds is empty")}))}if(r=e.match(m),r){var b,N;let r=null==(b=t)?void 0:b.narrativeRawIds;return(null==(N=r)?void 0:N.length)?A(e,r):(0,o.apiNarrativesGetFeedBlock)().then((t=>{var i,a,o;return r=(0,c.joinNarrativeRawIds)(null==(a=t)||null==(i=a.block)?void 0:i.narratives),(null==(o=r)?void 0:o.length)?A(e,r):Promise.reject("narrativeRawIds is empty")}))}if(r=e.match(g),r){const t=r[1],o=Number(r[2]);return t?(0,a.apiStoriesGetArchive)({date:o,fields:(0,s.getStoryOwnerFields)(),extended:1}).then((t=>({list:(0,i.transformStoriesToLegacy)(t,e,(0,n.isMvk)())}))):Promise.reject("ownerId is empty")}if(r=e.match(_),r){var R;const o=Number(r[1]),c=Number(r[2]);if(!o||!c)return Promise.reject("ownerId or storyId is empty");const d=null==(R=t)?void 0:R.context;return"all"===d||"new"===d?(0,a.apiStoriesGet)({fields:(0,s.getStoryOwnerFields)(),extended:1}).then((t=>({list:(0,i.transformStoryGetApiResponseToLegacyFormat)(t,e,(0,n.isMvk)())}))):(0,a.apiStoriesGetById)({stories:`${o}_${c}`,with_context:"owner"===d?1:0,fields:(0,s.getStoryOwnerFields)(),extended:1}).then((t=>({list:(0,i.transformStoriesToLegacy)(t,e,(0,n.isMvk)())})))}if(r=e.match(E),r){var O;const o=r[1],c=null==(O=t)?void 0:O.situationalSuggestId;if(!o&&void 0===c)return Promise.reject("rawQuery or suggest id is empty");let d="";if(o){const e=o.replaceAll("-","+").replaceAll("_","/");d=(0,a.decodeBase64)(e)}return(0,a.apiStoriesSearch)({q:d,count:100,situational_suggest_id:c,fields:(0,s.getStoryOwnerFields)(),extended:1}).then((t=>({list:(0,i.transformStoryGetApiResponseToLegacyFormat)(t,e,(0,n.isMvk)())})))}if(r=e.match(h),r){const t=Number(r[1]);return t?(0,a.apiStoriesSearch)({place_id:t,count:100,fields:(0,s.getStoryOwnerFields)(),extended:1}).then((t=>({list:(0,i.transformStoryGetApiResponseToLegacyFormat)(t,e,(0,n.isMvk)())}))):Promise.reject("place id is empty")}return Promise.reject("unknown list")}function A(e="",t=""){return(0,o.apiNarrativesGetById)({narratives:t,fields:(0,s.getStoryOwnerFields)(),extended:1}).then((t=>({list:(0,i.transformNarrativeGetApiResponseToLegacyFormat)(t,e,(0,n.isMvk)())})))}function w(e){const t={},r=String(e).split(";");for(let e of r){const[r,i]=e.split(":");r&&i&&(t[r]=i)}return t}},203917:(e,t,r)=>{function i(){return a(["first_name","last_name","first_name_gen","last_name_gen","first_name_ins","last_name_ins","screen_name","name","is_member","is_closed","is_nft","is_nft_photo","photo_50","photo_100","friend_status","verified","sex"])}function a(e){return e.join(",")}r.d(t,{getStoryOwnerFields:()=>i,makeOwnerFields:()=>a})},954130:(e,t,r)=>{r.d(t,{transformClickableStickers:()=>S});var i=r(659397),a=r(304244),o=r(123573),s=r(416569),n=r(764646),c=r(696812),d=r(50173),l=r(446735),p=r(93473);const _={hashtag:p.StickerTypes.hashtag,mention:p.StickerTypes.mention,question:p.StickerTypes.question,place:p.StickerTypes.place,music:p.StickerTypes.music,story_reply:p.StickerTypes.storyReply,owner:p.StickerTypes.owner,link:p.StickerTypes.link,market_item:p.StickerTypes.marketItem,post:p.StickerTypes.post,poll:p.StickerTypes.poll,sticker:p.StickerTypes.sticker,app:p.StickerTypes.app,situational_theme:p.StickerTypes.situationalTheme,playlist:p.StickerTypes.playlist,clip:p.StickerTypes.videoButton},u={transparent:1,blue_gradient:2,red_gradient:3,underline:4,blue:5,green:6,white:7,question_reply:8,light:9,impressive:10,dark:11,accent_background:12,accent_text:13,dark_unique:14,light_unique:15,light_text:18,dark_text:19,black:20,dark_without_bg:21,light_without_bg:22},f=(e,t=6)=>isNaN(e)?NaN:Number(e.toFixed(t)),v=/^\[(id|club)(\d+)\|(.*)]$/;function S(e,t=[],r=[],S){var m,g,E;const h=null==(m=e)?void 0:m.clickable_stickers;if(!(h&&Object.values(h).length&&h.original_width&&h.original_height))return{original_width:0,original_height:0,stickers:[]};let y=h.original_width,k=h.original_height;Number((k/y).toFixed(2))>1.78&&(k=1.78*y);const A=(h.original_height-k)/2,w=y/100,T=k/100;return{original_width:y,original_height:k,stickers:(null==(E=h)||null==(g=E.clickable_stickers)?void 0:g.length)?h.clickable_stickers.reduce(((m,g)=>{if(!g)return m;const{clickable_area:E=[]}=g;if(E.length<4)return m;const h=Math.sqrt(Math.pow(E[1].x-E[0].x,2)+Math.pow(E[1].y-E[0].y,2)),y=Math.sqrt(Math.pow(E[1].x-E[2].x,2)+Math.pow(E[1].y-E[2].y,2));if(!h||!y)return m;const k=E[1].x-E[0].x;let I=180*Math.acos(k/h)/Math.PI;isNaN(I)&&(I=0),E[1].y<E[0].y&&(I=-I);const b=_[g.type],N={id:g.id,type:b,top:f((E[0].y-A)/T/100),left:f(E[0].x/w/100),width:f(h/w/100),height:f(y/T/100),rotate:f(I)};g.style&&(N.style=u[g.style]);let R=!1;switch(b){case p.StickerTypes.hashtag:g.hashtag?N.hashtag=g.hashtag:R=!0;break;case p.StickerTypes.mention:{var O,F,x;const e=null==(O=g.mention)?void 0:O.match(v),i=null==(F=e)?void 0:F[1],o=Number(null==(x=e)?void 0:x[2]);if(!o||isNaN(o)){R=!0;break}const s="id"===i&&t.find((({id:e})=>e===o)),n=!s&&"club"===i&&r.find((({id:e})=>e===o));s?(N.mentionedPhotoUrl=s.photo_100||s.photo_50||"",N.mentionedOwnerHref=(0,a.getOwnerHref)(s),N.mentionedText=(0,a.getOwnerFullName)(s)):n?(N.mentionedText=n.name||"",N.mentionedPhotoUrl=n.photo_100||n.photo_50||"",N.mentionedOwnerHref=(0,a.getOwnerHref)(n)):R=!0;break}case p.StickerTypes.question:N.question=g.question||"";break;case p.StickerTypes.place:g.place_id?N.placeId=g.place_id:R=!0;break;case p.StickerTypes.music:if(!g.audio){R=!0;break}var P,G,D;if(N.audioId=`${g.audio.owner_id}_${g.audio.id}`,N.audioData=JSON.stringify((0,s.apiAudioToAudioTuple)(g.audio)),g.audio_restrictions)N.audioRestriction={code:g.audio_restrictions.id,title:g.audio_restrictions.title,buttonText:(null==(P=g.audio_restrictions.button)?void 0:P.title)||"",buttonUrl:(null==(D=g.audio_restrictions.button)||null==(G=D.action)?void 0:G.url)||""};break;case p.StickerTypes.playlist:if(!g.playlist){R=!0;break}N.playlistOwnerId=g.playlist.owner_id,N.playlistId=g.playlist.id,N.playlistFollowed=Boolean(g.playlist.followed);break;case p.StickerTypes.storyReply:g.owner_id&&(N.ownerId=g.owner_id),N.link=(0,a.getOwnerHref)((0,d.findOwnerById)(g.owner_id,t,r)),g.story_id?N.storyId=g.story_id:N.isExpired=!0;break;case p.StickerTypes.owner:g.owner_id&&(N.ownerId=g.owner_id),N.link=(0,a.getOwnerHref)((0,d.findOwnerById)(g.owner_id,t,r));break;case p.StickerTypes.link:g.link_object?(N.link=g.link_object.url?(0,l.wrapAwayIfExternal)(g.link_object.url):"",N.tooltipText=g.tooltip_text||""):R=!0;break;case p.StickerTypes.marketItem:var L;if(g.subtype===p.StoryStickerSubtype.aliexpress)N.link=(null==(L=g.link_object)?void 0:L.url)?(0,l.wrapAwayIfExternal)(g.link_object.url):"",N.photoUrl=g.link_object&&(0,c.getPhotoSize)(g.link_object.photo,50*devicePixelRatio)||"";else if(g.subtype===p.StoryStickerSubtype.market&&g.market_item){var V;if(N.photoUrl=g.market_item.thumb&&(null==(V=(0,i.getPhotoSize)(g.market_item.thumb,50*devicePixelRatio))?void 0:V.url)||"",N.isRestricted=!1,S)N.link=`/product${g.market_item.owner_id}_${g.market_item.id}`;else{const e=(0,a.getOwnerHref)((0,d.findOwnerById)(g.market_item.owner_id,t,r));N.link=`${e}?w=product${g.market_item.owner_id}_${g.market_item.id}`}}else R=!0;break;case p.StickerTypes.post:g.post_owner_id&&(N.postOwnerId=g.post_owner_id),g.post_id?N.postId=g.post_id:R=!0;break;case p.StickerTypes.poll:g.poll?(N.pollId=g.poll.id,N.pollOwnerId=g.poll.owner_id):R=!0;break;case p.StickerTypes.app:if(g.app){N.appId=g.app.id,N.hasNewInteractions=Boolean(g.has_new_interactions);const t=[e.owner_id,e.id,"story",g.id];g.app_context&&t.push(btoa(g.app_context)),N.appRef=`story${t.join("_")}`}else R=!0;break;case p.StickerTypes.sticker:g.sticker_pack_id?(N.stickerPackId=g.sticker_pack_id,g.sticker_id&&(N.stickerId=g.sticker_id),N.tooltipText=n.getLang("stories_view_sticker_pack")):R=!0;break;case p.StickerTypes.situationalTheme:g.situational_theme_id?(N.situationalAppId=o.SITPOSTING_APP_ID,N.situationalThemeId=g.situational_theme_id):R=!0;break;case p.StickerTypes.videoButton:g.clip_id?(g.owner_id&&(N.videoOwnerId=g.owner_id),N.videoId=g.clip_id,N.videoType=g.type,N.tooltipText=n.getLang("stories_link_attach_clip")):R=!0;break;default:R=!0}return R||m.push(N),m}),[]):[]}}},742525:(e,t,r)=>{r.d(t,{transformDetailedStatsData:()=>p,transformPoll:()=>l,transformStoryQuestions:()=>d});var i=r(764646),a=r(659397),o=r(304244),s=r(93473);const n=(e="",t="")=>e&&t?`${e} ${t}`:e||t,c=(e,t=32)=>(0,a.getPhotoSize)(null!=e?e:[],t*window.devicePixelRatio),d=(e,t,r=0,i=0)=>(0,a.isArray)(e)&&(0,a.isArray)(t)?e.map((({id:e,is_anonymous:a,question:s,is_owner_blocked:c,is_published:d,owner_id:l})=>{var p,_,u,f,v,S,m;const g=!a&&window.vk.id!=l,E=!a&&window.vk.id!=l,h=null==(p=t)?void 0:p.find((e=>{var t;return(null==(t=e)?void 0:t.id)===l}));return{author:h?{link:(0,o.getOwnerHref)(h),name:(0,o.getOwnerFullName)(h),nameDat:n(null==(_=h)?void 0:_.first_name_dat,null==(u=h)?void 0:u.last_name_dat),nameGen:n(null==(f=h)?void 0:f.first_name_gen,null==(v=h)?void 0:v.last_name_gen),nameIns:n(null==(S=h)?void 0:S.first_name_ins,null==(m=h)?void 0:m.last_name_ins)}:{},canAnswer:g,canBlocked:E,id:e,isAnonymous:a,isOwnerBlocked:c,isPublished:d,ownerId:l,storyId:i,storyOwnerId:r,text:s}})):[],l=e=>{if(!e)return null;const{votes:t,id:r,owner_id:a,question:o,photo:n,background:d,can_vote:l}=e;return{ownerId:a,pollId:r,question:o,votersCountText:t?i.getLang("voting_N_voted",t):i.getLang("voting_nobody_voted"),background:n?{type:s.StoryPollBackgroundType.photo,photoUrl:(null==(_=c(null==(u=n)?void 0:u.images))?void 0:_.url)||"",backgroundColor:(null==(f=n)?void 0:f.color)||""}:"gradient"===(null==(p=d)?void 0:p.type)?{type:s.StoryPollBackgroundType.gradient,angle:d.angle||0,color:d.color||"",points:d.points||[]}:{type:s.StoryPollBackgroundType.default},needShowResults:!l};var p,_,u,f},p=e=>{var t,r;return e?{preview:e.preview||"",achievement:e.achievement||"",achievementSubtitle:e.achievement_subtitle||"",categories:(null==(t=e.categories)?void 0:t.map((e=>({title:e.header,lines:e.lines.map((e=>({name:e.name||"",counter:e.is_unavailable?i.getLang("stories_stat_off"):String(null!=(r=e.counter)?r:""),unavailable:e.is_unavailable})))}))))||[]}:null}},31195:(e,t,r)=>{r.d(t,{transformDetailedStatsData:()=>a.transformDetailedStatsData,transformNarrativeGetApiResponseToLegacyFormat:()=>i.transformNarrativeGetApiResponseToLegacyFormat,transformPoll:()=>a.transformPoll,transformStoriesToLegacy:()=>i.transformStoriesToLegacy,transformStoryGetApiResponseToLegacyFormat:()=>i.transformStoryGetApiResponseToLegacyFormat,transformStoryQuestions:()=>a.transformStoryQuestions});r(954130),r(205227),r(13312);var i=r(301445),a=r(742525)},301445:(e,t,r)=>{r.d(t,{getVideoSize:()=>T,transformNarrativeGetApiResponseToLegacyFormat:()=>v,transformStoriesToLegacy:()=>E,transformStoryGetApiResponseToLegacyFormat:()=>f});var i=r(652047),a=r(172045),o=r(304244),s=r(552248),n=r(93473),c=r(764646),d=r(659397),l=r(577686),p=r(50173),_=r(954130),u=r(205227);function f(e,t,r){const{items:i,profiles:o=[],groups:s=[]}=e,c=i.map((e=>{var i,c,d,l,_;const u=e.owner_id||(null==(c=e.stories)||null==(i=c[0])?void 0:i.owner_id)||0,v=(0,p.findOwnerById)(u,o,s)||{id:u},E=(null==(d=e.stories)?void 0:d.filter(Boolean))||[],h=t===n.StoryListName.feed||t===n.StoryListName.discover||t===n.StoryListName.apps,y={id:e.id||(0,a.default)(),author:m(v,o,null==(l=E[0])?void 0:l.also_subscribed),has_unseen:e.has_unseen,items:E.map((e=>g(e,v,o,s,r,t))),track_code:e.track_code,can_blacklist:h,app:e.app&&S(e.app),type:e.type,send_mask_hash:"",remove_from_blacklist_hash:"",is_narrative:!1,is_apps:e.type===n.StoryBlockType.appGroupedStories,next_from:""};if((null==(_=e.grouped)?void 0:_.length)&&(y.grouped=f({items:e.grouped,profiles:o,groups:s},t,r)),r){const i=function(e,t,r,i,a,o){var s;const n=null==(s=e.stories)?void 0:s[0],c=e.app;if("app_grouped_stories"!==e.type||!n)return;const d=g(n,t,r,i,a,o);d.raw_id=d.raw_id+"&meta",d.is_apps_meta_story=!0,c&&(d.app=S(c));return d}(e,v,o,s,r,t);i&&y.items.push(i)}return y}));return c}function v(e,t,r){const{items:i,profiles:o=[],groups:s=[]}=e;return i.map((e=>{var i,c,d,l;const _=e.owner_id||(null==(c=e.stories)||null==(i=c[0])?void 0:i.owner_id)||0,f=(0,p.findOwnerById)(_,o,s)||{id:_},v=(null==(d=e.stories)?void 0:d.filter(Boolean))||[];return{id:(0,a.default)(),author:m(f,o,null==(l=v[0])?void 0:l.also_subscribed),items:v.map((e=>g(e,f,o,s,r,t))),can_blacklist:!1,type:n.StoryBlockType.stories,send_mask_hash:"",remove_from_blacklist_hash:"",is_apps:!1,next_from:"",is_narrative:!0,narrative:(0,u.transformNarrative)(e,f)}}))}function S(e){return{url:`/app${e.id}`,name:e.title,photoUrl:e.icon_139||e.icon_150||e.icon_75||""}}function m(e,t=[],r){const i=e.verified?'<div class="page_verified"></div>':"",a=function(e,t=[]){if(!e)return;const r=[],i=e.user_ids||[];return i.forEach((e=>{const i=t.find((t=>t.id===e));i&&r.push({photo_url:i.photo_50||i.photo_100||"",href:(0,o.getOwnerHref)(i),name:i.first_name||"",sex:i.sex||0})})),{total_count:e.count||0,owners:r}}(r,t);if((0,o.isOwnerUser)(e)){const t=e.id,r=e.first_name||"",s=e.last_name||"",n=e.first_name_gen||"",c=e.last_name_gen||"",l=e.first_name_ins||"",p=(0,o.getOwnerFullName)(e),_=s?`${n} ${c}`:n;return{id:t,name:(0,d.escape)(p),name_get:(0,d.escape)(_),firstName:(0,d.escape)(r),first_name_gen:(0,d.escape)(n),first_name_ins:(0,d.escape)(l),photo:e.photo_100||e.photo_50||"",href:(0,o.getOwnerHref)(e),verify:i,gender:e.sex||0,can_follow:y(e),nft:Boolean(e.is_nft),also_subscribed:a}}const s=-e.id,n=(0,d.escape)(e.name||"");return{id:s,name:n,name_get:n,firstName:n,first_name_gen:n,first_name_ins:n,photo:e.photo_100||e.photo_50||"",href:(0,o.getOwnerHref)(e),verify:i,gender:0,can_follow:y(e),nft:Boolean(e.is_nft_photo),also_subscribed:a}}function g(e,t,r,i,a,u){var f,v,S,m,g,E,y,b,N,R,O;let F,x;if(null==(f=e.mask)?void 0:f.owner_id){var P;const t=(0,p.findOwnerById)(null==(P=e.mask)?void 0:P.owner_id,r,i);t&&(F=t.screen_name,(0,o.isOwnerUser)(t)&&(x=t.sex))}const G=k(t,e),D=!G&&(u===n.StoryListName.feed||u===n.StoryListName.apps||u===n.StoryListName.discover);return{owner_id:e.owner_id,raw_id:`${e.owner_id}_${e.id}`,date:(0,c.getSmDate)(e.date||0),time:e.date||0,type:I(e),unread:!e.seen,canLike:Boolean(e.can_like),can_comment:Boolean(e.can_comment),can_share:Boolean(e.can_share),can_remove:A(e,t),can_manage:G,can_ask:Boolean(e.can_ask),can_ask_anonymous:Boolean(e.can_ask_anonymous),canAddToNarrative:e.can_use_in_narrative,stats:{follow:{event_type:"subscribe",rhash:""},url_view:{event_type:"url_view",rhash:""}},isLiked:Boolean(e.is_liked),likeHash:"",reaction_set_id:e.reaction_set_id||"",user_reaction_id:e.user_reaction_id||0,preview_url:"",needMute:Boolean(e.need_mute),muteReply:Boolean(e.mute_reply),isPromo:Boolean(e.is_promo),isProfileQuestion:Boolean(e.is_profile_question),promoCaption:e.is_promo&&e.caption||"",track_code:e.track_code||"",video:{owner_id:e.owner_id,video_id:(null==(v=e.video)?void 0:v.id)||0},link:e.link?{text:e.link.text||"",url:e.link.url||""}:void 0,isPartOfNarrative:Boolean(e.narratives_count),report_hash:"",maskOwnerDomain:F,maskOwnerSex:x,can_hide_reply:w(e,r,i),noSound:Boolean(e.no_sound),isNewQuestions:G&&Boolean(null==(S=e.questions)?void 0:S.new),views:Boolean(e.views)?(0,s.formatCount)(e.views||0):"",needShowEmptyStats:Boolean(e.need_show_empty_stats),is_expired:Boolean(e.is_expired),is_deleted:Boolean(e.is_deleted),is_private:!Boolean(e.can_see),isAds:Boolean(e.is_ads),isOneTime:Boolean(e.is_one_time),isOneTimeSeen:Boolean(e.is_one_time)&&!Boolean(e.can_see),seenProgress:0,replies:(null==(m=e.replies)?void 0:m.count)?(0,s.formatCount)(e.replies.count):"",replies_new_counter:(null==(g=e.replies)?void 0:g.new)||0,clickable_stickers:(0,_.transformClickableStickers)(e,r,i,a),askQuestionHash:"",canMarkNotInterested:D,photo_url:(null==(E=e.photo)?void 0:E.sizes)&&(null==(y=(0,d.getPhotoSize)(e.photo.sizes,(0,l.isRetina)()?1200:600))?void 0:y.url)||"",small_preview:h(e,a),video_url:(null==(b=e.video)?void 0:b.files)?T(e.video.files):"",first_frame:(null==(N=e.video)?void 0:N.first_frame)&&(null==(R=(0,d.getPhotoSize)(null==(O=e.video)?void 0:O.first_frame,800))?void 0:R.url)||"",is_apps_meta_story:!1,repliesCountText:"",authorId:0,isMusicCover:!1,is_authors_ads:e.is_authors_ads,advertiser_info_url:e.advertiser_info_url,ad_marker:e.ad_marker,caption:e.caption,is_best_friends_privacy:e.is_best_friends_privacy}}function E(e,t,r){var i,o;const{items:s,profiles:c,groups:d}=e,l=(null==(i=s[0])?void 0:i.owner_id)||0,_=(0,p.findOwnerById)(l,c,d)||{id:l},u=t===n.StoryListName.feed||t===n.StoryListName.discover||t===n.StoryListName.apps,f=s.some((e=>!e.seen));return[{id:(0,a.default)(),author:m(_,c,null==(o=s[0])?void 0:o.also_subscribed),has_unseen:f,items:s.map((e=>g(e,_,c,d,r,t))),track_code:"",can_blacklist:u,type:n.StoryBlockType.stories,send_mask_hash:"",remove_from_blacklist_hash:"",is_narrative:!1,is_apps:!1,next_from:""}]}function h(e,t=!1){var r,i;const a=null==(r=e.photo)?void 0:r.sizes;var o;if(a)return(null==(o=(0,d.getPhotoSize)(a,t?10:(0,l.isRetina)()?600:300))?void 0:o.url)||"";const s=null==(i=e.video)?void 0:i.first_frame;var n;return s&&(null==(n=(0,d.getPhotoSize)(s,t?10:320))?void 0:n.url)||""}function y(e){return(0,o.isOwnerUser)(e)?window.vk.id!==e.id&&(e.friend_status===i.FriendsFriendStatusStatusEnumNames.NOT_A_FRIEND||e.friend_status===i.FriendsFriendStatusStatusEnumNames.INCOMING_REQUEST):!e.is_member&&!e.is_closed}function k(e,t){return(0,o.isOwnerUser)(e)?t.owner_id===e.id&&window.vk.id===e.id:t.owner_id===-e.id&&(t.is_ads?Boolean(e.is_advertiser):Boolean(e.is_admin))}function A(e,t){return k(t,e)&&("photo"===e.type||"video"===e.type)&&!e.is_deleted}function w(e,t,r){if(!e.parent_story_owner_id||!e.parent_story_id)return!1;const i=window.vk.id,a=e.parent_story_owner_id;if(a===i)return!0;const s=(0,p.findOwnerById)(a,t,r);return!!(s&&(0,o.isOwnerGroup)(s)&&s.is_admin)}function T(e){const t=["mp4_2160","mp4_1440","mp4_1080","mp4_720","mp4_480","mp4_360","mp4_240","mp4_144"].find((t=>Boolean(e[t])));return t&&e[t]?String(e[t]):""}function I(e){return"photo"===e.type?n.StoryType.PHOTO:"video"===e.type?n.StoryType.VIDEO:"live_active"===e.type||"live_finished"===e.type?n.StoryType.LIVE:n.StoryType.PHOTO}},205227:(e,t,r)=>{r.d(t,{transformNarrative:()=>s});var i=r(659397),a=r(304244),o=(r(50173),r(13312));function s(e,t){var r,s;const n=`${e.owner_id}_${e.id}`,c=(0,a.isOwnerGroup)(t),d=c&&Boolean(t.is_closed),l={id:e.id,rawId:n,ownerId:e.owner_id,ownerName:(0,i.escape)((c?t.name:(0,a.getOwnerFullName)(t))||""),ownerShortName:(0,i.escape)((c?t.name:(0,a.getOwnerShortName)(t))||""),ownerUrl:(0,a.getOwnerHref)(t),ownerPath:`${c?"club":"id"}${e.owner_id}`,ownerAvatarUrl:t.photo_100||t.photo_50||"",title:(0,i.escape)(e.title),isBookmarked:e.is_favorite,bookmarkHash:"",reportHash:"",canEdit:Boolean(e.can_delete),editHash:"",canView:e.can_see,storiesCount:(null==(r=e.story_ids)?void 0:r.length)||0,isOwnerClosedGroup:d,isGroupEditor:d&&Boolean(t.is_admin),url:`${window.location.origin}/narrative${n}`,stories:(null==(s=e.stories)?void 0:s.map(o.transformStoryArchive))||[],isDeleted:e.is_delete,date:"",coverUrl:""};if(e.cover){var p;Object.assign(l,{coverUrl:e.cover.cropped_sizes&&(null==(p=(0,i.getPhotoSize)(e.cover.cropped_sizes,300))?void 0:p.url)||"",coverCrop:{x:e.cover.crop_x||0,y:e.cover.crop_y||0,width:e.cover.crop_width||0,height:e.cover.crop_height||0}}),e.cover.custom_photo&&(l.customCover=function(e,t=[]){var r,a,o,s;if(!e)return;return{photoId:e.id,originalPhotoUrl:(null==(r=e.orig_photo)?void 0:r.url)||e.sizes&&(null==(a=(0,i.getPhotoSize)(e.sizes,600))?void 0:a.url)||"",previewUrl:t&&(null==(o=(0,i.getPhotoSize)(t,300))?void 0:o.url)||e.sizes&&(null==(s=(0,i.getPhotoSize)(e.sizes,300))?void 0:s.url)||""}}(e.cover.custom_photo,e.cover.cropped_sizes));const t=e.cover.cover_story_id;if(t){var _;Object.assign(l,{coverStoryId:t,coverStoryRawId:`${e.owner_id}_${t}`});const r=null==(_=e.stories)?void 0:_.find((e=>{var r;return(null==(r=e)?void 0:r.id)===t}));r&&(l.coverStory=(0,o.transformStoryArchive)(r))}}return l}},13312:(e,t,r)=>{r.d(t,{transformStoryArchive:()=>n});var i=r(659397),a=r(760474),o=r(301445),s=r(446735);function n(e){var t,r,n,c;const d=Math.max(e.date?Math.ceil(new Date(1e3*e.date).setUTCHours(0,0,0,0)/1e3):0,a.STORIES_ARCHIVE_START_TIME),l=(null==(t=e.photo)?void 0:t.sizes)||(null==(r=e.video)?void 0:r.image),p={id:e.id,rawId:`${e.owner_id}_${e.id}`,listId:`archive${e.owner_id}_${d}`,time:Number(e.date),preview:l&&(null==(n=(0,i.getPhotoSize)(l,350))?void 0:n.url)||"",originalPreviewUrl:l&&(null==(c=(0,i.getPhotoSize)(l,600))?void 0:c.url)||""};return"video"===e.type&&e.video&&Object.assign(p,{videoUrl:e.video.files&&(0,o.getVideoSize)(e.video.files)||"",duration:e.video.duration}),e.link&&Object.assign(p,{linkUrl:(0,s.wrapAwayIfExternal)(e.link.url)||"",linkText:e.link.text||"",linkType:""}),p}},711669:(e,t,r)=>{r.d(t,{createStoriesService:()=>n});var i=r(798116),a=r(299891),o=r(749926),s=r(541870);const n=({domain:e})=>{const t=e.createEvent("fire/storiesGet"),r=e.createEvent("fire/storiesGetById"),n=e.createEvent("fire/storiesGetArchive"),c=e.createEvent("fire/storiesGetViewers"),d=e.createEvent("fire/storiesGetReplies"),l=e.createEvent("fire/storiesGetQuestions"),p=e.createEvent("fire/storiesGetStats"),_=e.createEvent("fire/storiesGetDetailedStats"),u=e.createEvent("fire/storiesMarkSkipped"),f=e.createEvent("fire/storiesMarkNotInterested"),v=e.createEvent("fire/storiesMarkSeen"),S=e.createEvent("fire/storiesHidePrivacyBlock"),m=e.createEvent("fire/storiesDelete"),g=e.createEvent("fire/storiesAskQuestion"),E=e.createEvent("fire/storiesDeleteQuestion"),h=e.createEvent("fire/storiesBanQuestionAuthor"),y=e.createEvent("fire/storiesUnbanQuestionAuthor"),k=e.createEvent("fire/storiesMarkAppNotificationsSeen"),A=e.createEvent("fire/storiesSubscribeUserToApp"),w=e.createEvent("fire/storiesGetPhotoUploadServer"),T=e.createEvent("fire/storiesGetVideoUploadServer"),I=e.createEvent("fire/storiesSave"),b=e.createEvent("fire/storiesSearch"),N=e.createEvent("fire/storiesUnbanOwner"),R=e.createEvent("fire/storiesBanOwner"),O=e.createEvent("fire/storiesSetDiscoverVisible"),F=e.createEvent("fire/storiesHideReply"),x=e.createEvent("fire/storieHideAllReplies"),P=e.createEffect("fx/storiesGet"),G=e.createEffect("fx/storiesGetById"),D=e.createEffect("fx/storiesGetArchive"),L=e.createEffect("fx/storiesGetViewers"),V=e.createEffect("fx/storiesGetReplies"),B=e.createEffect("fx/storiesGetQuestions"),C=e.createEffect("fx/storiesGetStats"),M=e.createEffect("fx/storiesGetDetailedStats"),U=e.createEffect("fx/storiesMarkSkipped"),W=e.createEffect("fx/storiesMarkNotInterested"),K=e.createEffect("fx/storiesMarkSeen"),H=e.createEffect("fx/storiesHidePrivacyBlock"),Y=e.createEffect("fx/storiesDelete"),$=e.createEffect("fx/storiesAskQuestion"),Q=e.createEffect("fx/storiesDeleteQuestion"),z=e.createEffect("fx/storiesBanQuestionAuthor"),j=e.createEffect("fx/storiesUnbanQuestionAuthor"),q=e.createEffect("fx/storiesMarkAppNotificationsSeen"),X=e.createEffect("fx/storiesSubscribeUserToApp"),J=e.createEffect("fx/storiesGetPhotoUploadServer"),Z=e.createEffect("fx/storiesGetVideoUploadServer"),ee=e.createEffect("fx/storiesSave"),te=e.createEffect("fx/storiesSearch"),re=e.createEffect("fx/storiesUnbanOwner"),ie=e.createEffect("fx/storiesBanOwner"),ae=e.createEffect("fx/storiesSetDiscoverVisible"),oe=e.createEffect("fx/storiesHideReply"),se=e.createEffect("fx/storiesHideAllReplies"),ne=(0,o.createFriendsAddFx)({domain:e}),ce=(0,o.createFriendsDeleteFx)({domain:e}),de=(0,s.createGroupsJoinFx)({domain:e}),le=(0,s.createGroupsLeaveFx)({domain:e});return P.use(a.apiStoriesGet),G.use(a.apiStoriesGetById),D.use(a.apiStoriesGetArchive),L.use(a.apiStoriesGetViewers),V.use(a.apiStoriesGetReplies),B.use(a.apiStoriesGetQuestions),C.use(a.apiStoriesGetStats),M.use(a.apiStoriesGetDetailedStats),U.use(a.apiStoriesMarkSkipped),W.use(a.apiStoriesMarkNotInterested),K.use(a.apiStoriesMarkSeen),H.use(a.apiStoriesHidePrivacyBlock),Y.use(a.apiStoriesDelete),$.use(a.apiStoriesAskQuestion),Q.use(a.apiStoriesDeleteQuestion),z.use(a.apiStoriesBanQuestionAuthor),j.use(a.apiStoriesUnbanQuestionAuthor),q.use(a.apiStoriesMarkAppNotificationsSeen),X.use(a.apiStoriesSubscribeUserToApp),J.use(a.apiStoriesGetPhotoUploadServer),Z.use(a.apiStoriesGetVideoUploadServer),ee.use(a.apiStoriesSave),te.use(a.apiStoriesSearch),ie.use(a.apiStoriesBanOwner),re.use(a.apiStoriesUnbanOwner),ae.use(a.apiStoriesSetDiscoverVisible),oe.use(a.apiStoriesHideReply),se.use(a.apiStoriesHideAllReplies),(0,i.sample)({clock:t,target:P}),(0,i.sample)({clock:r,target:G}),(0,i.sample)({clock:n,target:D}),(0,i.sample)({clock:c,target:L}),(0,i.sample)({clock:d,target:V}),(0,i.sample)({clock:l,target:B}),(0,i.sample)({clock:p,target:C}),(0,i.sample)({clock:_,target:M}),(0,i.sample)({clock:u,target:U}),(0,i.sample)({clock:f,target:W}),(0,i.sample)({clock:v,target:K}),(0,i.sample)({clock:S,target:H}),(0,i.sample)({clock:m,target:Y}),(0,i.sample)({clock:g,target:$}),(0,i.sample)({clock:E,target:Q}),(0,i.sample)({clock:h,target:z}),(0,i.sample)({clock:y,target:j}),(0,i.sample)({clock:k,target:q}),(0,i.sample)({clock:A,target:X}),(0,i.sample)({clock:w,target:J}),(0,i.sample)({clock:T,target:Z}),(0,i.sample)({clock:I,target:ee}),(0,i.sample)({clock:b,target:te}),(0,i.sample)({clock:N,target:re}),(0,i.sample)({clock:R,target:ie}),(0,i.sample)({clock:O,target:ae}),(0,i.sample)({clock:F,target:oe}),(0,i.sample)({clock:x,target:se}),{fireGet:t,fireGetById:r,fireGetArchive:n,fireGetViewers:c,fireGetReplies:d,fireGetQuestions:l,fireGetStats:p,fireGetDetailedStats:_,fireMarkSkipped:u,fireMarkNotInterested:f,fireMarkSeen:v,fireHidePrivacyBlock:S,fireDelete:m,fireAskQuestion:g,fireDeleteQuestion:E,fireBanQuestionAuthor:h,fireUnbanQuestionAuthor:y,fireMarkAppNotificationsSeen:k,fireSubscribeUserToApp:A,fireGetPhotoUploadServer:w,fireGetVideoUploadServer:T,fireSave:I,fireSearch:b,fireUnbanOwner:N,fireBanOwner:R,fireSetDiscoverVisible:O,fireHideReply:F,fireHideAllReplies:x,getFx:P,getByIdFx:G,getArchiveFx:D,getViewersFx:L,getRepliesFx:V,getQuestionsFx:B,getStatsFx:C,getDetailedStatsFx:M,markSkippedFx:U,markNotInterestedFx:W,markSeenFx:K,hidePrivacyBlockFx:H,deleteFx:Y,askQuestionFx:$,deleteQuestionFx:Q,banQuestionAuthorFx:z,unbanQuestionAuthorFx:j,markAppNotificationsSeenFx:q,subscribeUserToAppFx:X,getPhotoUploadServerFx:J,getVideoUploadServerFx:Z,saveFx:ee,searchFx:te,unbanOwnerFx:re,banOwnerFx:ie,setDiscoverVisibleFx:ae,hideReplyFx:oe,hideAllRepliesFx:se,friendsAddFx:ne,friendsDeleteFx:ce,groupsJoinFx:de,groupsLeaveFx:le}}},156079:(e,t,r)=>{r.d(t,{faveService:()=>S,narrativesService:()=>v,pollsService:()=>m,statsService:()=>f,storiesDomain:()=>_,storiesService:()=>u,userService:()=>g});var i=r(798116),a=r(760474),o=r(639636),s=r(383719),n=r(509902),c=r(404625),d=r(735825),l=r(49661),p=r(330253);const _=(0,i.createDomain)("stories"),u=(0,a.createStoriesService)({domain:_}),f=(0,o.createStatsService)({domain:_}),v=(0,s.createNarrativesService)({domain:_}),S=((0,n.createLikesService)({domain:_}),(0,c.createMessagesService)({domain:_}),(0,d.createFaveService)({domain:_})),m=(0,l.createPollsService)({domain:_}),g=(0,p.createUserService)({domain:_})},388676:(e,t,r)=>{function i(e){var t,r;return(null!=(r=null==(t=e)?void 0:t.split("_"))?r:[]).map(Number)}function a(e,t="windows-1251"){return new TextDecoder(t).decode(function(e){const t=atob(e);return Uint8Array.from(t,(e=>e.codePointAt(0)||0))}(e))}r.d(t,{decodeBase64:()=>a,splitStoryRawId:()=>i})},5002:(e,t,r)=>{r.d(t,{ADMIN_STORY_VIEW_MODULE:()=>o,BOX_ITEM_DRAGGABLE_CLASS:()=>_,EMOJI_REACTIONS_ARR:()=>s,INIT_MAX_FEEDBACK_STORIES_COUNT:()=>d,LONG_PRESS_DELAY_MS:()=>a,MAX_FEEDBACK_STORIES_SLICE_COUNT:()=>c,MAX_NARRATIVE_STORIES:()=>l,NARRATIVE_MAX_TITLE_LENGTH:()=>p,QUESTION_SELECT_MODE:()=>n,SCROLL_LOADING_MORE_GAP:()=>f,SCROLL_THROTTLE_DELAY:()=>u,STORIES_MANAGE_MODULE:()=>i});const i="stories_manage",a=200,o="admin_story_view",s=[{code:"f09f9882",name:"face_with_tears_of_happiness"},{code:"f09f988d",name:"smiling_face_with_heart_eyes"},{code:"f09f918df09f8fbf",name:"thumbs_up"},{code:"f09f98ad",name:"loud_crying_face"},{code:"f09f98b1",name:"face_screaming_in_fear"},{code:"e298ba",name:"smiling_face"}],n={PUBLIC:0,AUTHOR_ONLY:1,ANONYMOUS:3},c=50,d=10,l=100,p=23,_="NarrativeBox__draggable",u=34,f=400},162350:(e,t,r)=>{r.d(t,{createUserStackMaskIfNeeded:()=>h,fetchDiscover:()=>m,getGroupStoryManageRemoveData:()=>k,getStoryBlockKey:()=>E,getStoryList:()=>f,getVolume:()=>_,isDiscoverLoading:()=>g,isNewDesignEnabled:()=>y,preloadDiscoverList:()=>S,removeStoryList:()=>v,setVolume:()=>u});var i=r(93473),a=r(538248),o=r(414126),s=r(448180),n=r(971106),c=r(856728),d=r(214266),l=r(5002),p=r(764646);function _(){const e=window.ls.get("video_volume");return"number"==typeof e?Math.min(1,Math.max(0,e)):1}function u(e){window.ls.set("video_volume",e)}function f(e){return window.cur[`stories_list_${e}`]}function v(e){delete window.cur[`stories_list_${e}`]}function S(e=!1){if(window.cur.storiesDiscoverFetchingPromise)return window.cur.storiesDiscoverFetchingPromise;let t,r;const a=f(i.StoryListName.feed);return a&&(r=a.find((e=>e.type===i.StoryBlockType.discover)),r&&(t=r.track_code)),window.cur.storiesDiscoverFetchingPromise=m("",t,e).then((([e,t])=>(r&&(r.grouped=e,r.next_from=t),e))).finally((()=>{delete window.cur.storiesDiscoverFetchingPromise})),window.cur.storiesDiscoverFetchingPromise}function m(e="",t="",r=!1,a=15){if((0,n.isApiForVKCOMViewerEnabled)()){const o={count:a,startFrom:e,trackCode:t};return r&&(0,d.showBoxLoader)(),(0,c.fetchList)(i.StoryListName.discover,o).then((({list:e,nextFrom:t})=>[e,t])).finally((()=>{r&&(0,d.hideBoxLoader)()}))}return new Promise(((i,o)=>{window.ajax.post("al_stories.php",{act:"get_discover",start_from:e,count:a,track_code:t},{loader:r,onDone:(e,t)=>{i([e,t])},onFail:e=>(o(e),!0)})}))}function g(){return Boolean(window.cur.storiesDiscoverFetchingPromise)}function E(e){var t,r,i,a,o;return(null==(r=e)||null==(t=r.author)?void 0:t.id)&&(null==(a=e)||null==(i=a.narrative)?void 0:i.id)?`${e.author.id}narrative${null==(o=e.narrative)?void 0:o.id}`:`${e.id}`}function h(){const e="users_stack_stories_mask";let t=document.getElementById(e);t||(t=(0,a.se)(`\n        <svg width="0" height="0">\n          <defs>\n            <clipPath id="${e}">\n              <path transform="translate(1.5 0)" d="M1.20772 8C1.20772 6.32671 0.768742 4.75626 0 3.39821C1.44342 1.34278 3.8277 0 6.52463 0C10.9293 0 14.5 3.58172 14.5 8C14.5 12.4183 10.9293 16 6.52463 16C3.8277 16 1.44342 14.6572 0 12.6018C0.768742 11.2437 1.20772 9.6733 1.20772 8Z"></path>\n            </clipPath>\n          </defs>  \n        </svg>  \n      `),t&&(document.body.appendChild(t),(0,s.pushNavDestroy)((()=>{var e;null==(e=t)||e.remove()}))))}function y(){return(0,o.partConfigEnabled)("story_reactions_sending_feature_web")}function k(e){if(e&&e.can_manage&&window.cur.module===l.STORIES_MANAGE_MODULE){const t=Math.floor(Date.now()/1e3);return{rawId:e.raw_id,deleter:window.vk.id,deletionDate:t,deletionDateString:(0,p.getSmDate)(t)}}}},971106:(e,t,r)=>{r.d(t,{isActsToApi2ForVKCOMViewerEnabled:()=>s,isActsToApiFirstForVKCOMViewerEnabled:()=>o,isApiForVKCOMViewerEnabled:()=>a});var i=r(414126);function a(){return(0,i.partConfigEnabled)("stories_web_api")}function o(){return(0,i.partConfigEnabled)("stories_web_acts_to_api_1")}function s(){return(0,i.partConfigEnabled)("stories_web_acts_to_api_2")}}}]);try{stManager.done("dist/web/chunks/aee1802d.46a55b6b.js")}catch(e){}