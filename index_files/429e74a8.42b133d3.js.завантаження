"use strict";(self.webpackChunkvkweb=self.webpackChunkvkweb||[]).push([[74606],{581595:(e,t,i)=>{function n(){return{icon:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16"><path fill="#fff" d="m6.55 5.05 4.77 2.64a.35.35 0 0 1 0 .62l-4.77 2.64a.37.37 0 0 1-.5-.13.34.34 0 0 1-.05-.17v-5.3A.36.36 0 0 1 6.37 5c.06 0 .12.02.18.05Z"/></svg>',name:"play_marusia_foreground_16"}}i.d(t,{getIcon16PlayMarusiaForeground:()=>n})},519555:(e,t,i)=>{function n(){return{icon:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16"><path fill="#fff" d="M5 7.4c0-.84 0-1.26.16-1.58a1.5 1.5 0 0 1 .66-.66C6.14 5 6.56 5 7.4 5h1.2c.84 0 1.26 0 1.58.16a1.5 1.5 0 0 1 .66.66c.16.32.16.74.16 1.58v1.2c0 .84 0 1.26-.16 1.58a1.5 1.5 0 0 1-.66.66c-.32.16-.74.16-1.58.16H7.4c-.84 0-1.26 0-1.58-.16a1.5 1.5 0 0 1-.66-.66C5 9.86 5 9.44 5 8.6V7.4Z"/></svg>',name:"stop_marusia_foreground_16"}}i.d(t,{getIcon16StopMarusiaForeground:()=>n})},955962:(e,t,i)=>{function n(e,t,i,n){const o=t?"article.php":"al_articles.php";ajax.post(o,{act:"tts",article_owner_id:e.owner_id,article_id:e.id,hash:e.tts_hash,support_streaming:i?1:0},{onDone:e=>{n(e)}})}i.d(t,{loadArticle:()=>n})},673056:(e,t,i)=>{i.d(t,{ArticleTts:()=>_});var n=i(199682),o=i(698143),r=i(239051),a=i(161371),s=i(643907),d=i(604742),l=i(660210),c=i(955962);class _{static load(e,t,i,n){this.loadingArticleRawId=e.raw_id,(0,c.loadArticle)(e,t,i,(e=>{this.loadingArticleRawId=null,n(e)}))}static getAudio(e,t,i){const n=[],r=JSON.stringify({articleTts:!0,articleId:e,articleOwnerId:t,externalStream:!0});return n[o.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_ID]=`${t}${e}`,n[o.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_OWNER_ID]=t,n[o.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_URL]=i.url,n[o.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_TITLE]=i.title,n[o.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_PERFORMER]=i.artist,n[o.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_DURATION]=i.duration,n[o.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_AUTHOR_LINK]="",n[o.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_LYRICS]=0,n[o.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_FLAGS]=0,n[o.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_CONTEXT]="",n[o.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_EXTRA]=r,n[o.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_HASHES]="",n[o.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_COVER_URL]="",n[o.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_ADS]={},n[o.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_SUBTITLE]="",n[o.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_MAIN_ARTISTS]="",n[o.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_FEAT_ARTISTS]="",n[o.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_ALBUM]=!1,n[o.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_TRACK_CODE]="",n[o.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_RESTRICTION]=0,n[o.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_ALBUM_PART]=0,n[o.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_ACCESS_KEY]="",n[o.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_CHART_INFO_INDEX]=!1,n}static play(e,t,i,o){this.onArticleTtsExpire=o,this.statsHandlersInitialized||(this._audioPlayer().subscribe(a.AudioPlayerEventType.PLAY,(()=>{if(this.isAnyArticleInPlayer()){const e=this._audioPlayer().getCurrentProgress()>0?n.ArticleTtsActionType.CONTINUE:n.ArticleTtsActionType.START;this.sendStats(e)}})),this._audioPlayer().subscribe(a.AudioPlayerEventType.PAUSE,(()=>{this.isAnyArticleInPlayer()&&this.sendStats(n.ArticleTtsActionType.PAUSE)})),this._audioPlayer().subscribe(a.AudioPlayerEventType.ENDED,(()=>{if(this.isAnyArticleInPlayer()){var e,t,i;let o=this._audioPlayer();if((null==(e=o._impl)?void 0:e._hlsError)||(null==(i=o._impl)||null==(t=i._currentAudioEl)?void 0:t.error)){o._impl&&(o._impl._hlsError=void 0);const e=(0,l.getAudioExtra)(o.getCurrentAudio());o.deleteCurrentPlaylist(),_.retryCount<3&&(_.retryCount+=1,setTimeout((()=>{var t;null==(t=this.onArticleTtsExpire)||t.call(this,e)}),_.RETRY_TIMEOUT))}this.sendStats(n.ArticleTtsActionType.P100)}})),this.statsHandlersInitialized=!0);const r=this.getAudio(e,t,i),s=this._audioPlayer().getPlaylist(d.AudioPlaylist.TYPE_ARTICLE_TTS,t,e);s.mergeWith({list:[r]}),this._audioPlayer().play(r,s)}static _audioPlayer(){return window.getAudioPlayer()}static _audioExtra(){const e=this._audioPlayer().getCurrentAudio();var t;return null!=(t=(0,l.getAudioExtra)(e))?t:{}}static isLoadingArticle(e){return this.loadingArticleRawId===e.raw_id}static isArticleInPlayer(e){return e.owner_id===this._audioExtra().articleOwnerId&&e.id===this._audioExtra().articleId}static isAnyArticleInPlayer(){return(0,r.isArticleTts)(this._audioPlayer().getCurrentAudio())}static sendStats(e){var t;const{articleId:i,articleOwnerId:o}=this._audioExtra();var r;n.articleTtsActionStatController.logEvent({action:e,nav_screen:"article_read",article_id:i,owner_id:o,audio_length:null!=(r=null==(t=(0,s.audioTupleToAudioObject)(this._audioPlayer().getCurrentAudio()))?void 0:t.duration)?r:0,speed:Math.round(100*AudioPlayer.podcastGetPlaybackRate()),volume:Math.round(100*this._audioPlayer().getVolume())})}}_.statsHandlersInitialized=!1,_.retryCount=0,_.RETRY_TIMEOUT=1e3},710970:(e,t,i)=>{i.d(t,{ON_BOARDING_BG_RECT_ID:()=>d,default:()=>_});var n=i(538248),o=i(975969),r=i(314502),a=i(956840),s=i(534488);const d="onboarding_bg_rect",l="page_header_cont",c="onboarding";class _{initOnboardingBG(){if(!window.onboardingBG){let e='\n<div id="onboarding_layout">\n  <svg id="onboarding_bg_header" width="100%" height="49px">\n    <rect id="onboarding_bg_rect" class="GroupOnboardingBg" x="0" y="0" width="100%" height="100%" fill-opacity="0.8" fill="#000"></rect>\n  </svg>\n  <svg id="onboarding_bg" width="100%" height="100%">\n  <defs>\n    <mask id="mask" x="0" y="0" width="100%" height="100%">\n      <rect x="0" y="0" width="100%" height="100%" fill="#fff"></rect>\n      <rect id="onboarding_bg_clip" class="GroupOnboardingBgClip" x="0" y="0" width="0" height="0" fill="#000" rx="8" ry="8"></rect>\n    </mask>\n  </defs>\n  <rect id="onboarding_bg_rect" class="GroupOnboardingBg" x="0" y="42" width="100%" height="100%" mask="url(#mask)" fill-opacity="0.8"></rect>\n  </svg>\n</div>\n      ',t=(0,n.se)(e);(0,n.domInsertBefore)(t,window.layerBG),window.onboardingBGHeader=(0,n.ge)("onboarding_bg_header"),window.onboardingBG=(0,n.ge)("onboarding_bg"),window.onboardingBGRect=(0,n.ge)(d),window.onboardingBGClip=(0,n.ge)("onboarding_bg_clip"),window.cur.destroy.push((()=>{(0,n.hide)(window.onboardingBG),(0,n.hide)(window.onboardingBGHeader),(0,n.removeClass)((0,n.ge)(l),c),this.hideDarkness=!0,this.hideTT(),delete window.onboardingBG,delete window.onboardingBGHeader,delete window.onboardingBGRect,delete window.onboardingBGClip,this.opts.onBGClick&&(0,o.removeEvent)(window.onboardingBG,"click",this.opts.onBGClick)}))}this.opts.onBGClick&&(0,o.addEvent)(window.onboardingBG,"click",this.opts.onBGClick)}showTT(){const[,e]=(0,n.getXY)(this.el);this.tt=new s.ElementTooltip(this.el,this.ttParams),this.opts.highlight&&(this.addDarkness(),this.addHighlight()),this.tt.show();const t=this.tt.getContent();(0,a.isElementInViewport)(this.el)&&(0,a.isElementInViewport)(t)||(0,r.scrollToY)(e-42-this.ttParams.scrollOffset)}hideTT(){this.tt&&(this.tt.destroy(),this.removeDarkens(),this.hideDarkness&&((0,o.removeEvent)(window,"scroll"),(0,o.removeEvent)(window,"resize")),this.opts.onBGClick&&window.onboardingBG&&(0,o.removeEvent)(window.onboardingBG,"click",this.opts.onBGClick),this.opts.onHide&&this.opts.onHide())}addHighlight(){window.onboardingBGClip&&(this.highlightElement(),(0,o.addEvent)(window,"scroll",this.onScrollTT.bind(this)),(0,o.addEvent)(window,"resize",this.onResizeTT.bind(this)))}highlightElement(){let e=this.el.offsetWidth,t=this.el.offsetHeight,i=(0,n.getXY)(this.el);(0,n.attr)(window.onboardingBGClip,"width",e+this.border[1]+this.border[3]),(0,n.attr)(window.onboardingBGClip,"height",t+this.border[0]+this.border[2]),(0,n.attr)(window.onboardingBGClip,"x",i[0]-this.border[1]),(0,n.attr)(window.onboardingBGClip,"y",i[1]-this.border[0])}onResizeTT(){this.setDartToFullWidth(),this.highlightElement()}onScrollTT(){let e=this.getPageHeight();window.onboardingBG.height!=e&&this.setDartToFullHeight()}setDartToFullHeight(){(0,n.attr)(window.onboardingBG,"height",this.getPageHeight())}setDartToFullWidth(){(0,n.attr)(window.onboardingBG,"width",this.getPageWidth()),(0,n.attr)(window.onboardingBGHeader,"width",this.getPageWidth())}addDarkness(){(0,n.isVisible)(window.onboardingBG)||(this.setDartToFullHeight(),this.setDartToFullWidth(),(0,n.show)(window.onboardingBG),(0,n.isVisible)(window.onboardingBGHeader)||((0,n.show)(window.onboardingBGHeader),(0,n.addClass)((0,n.ge)(l),c)))}removeDarkens(){this.hideDarkness&&((0,n.hide)(window.onboardingBG),(0,n.hide)(window.onboardingBGHeader),(0,n.removeClass)((0,n.ge)(l),c))}ttOnHide(){this.hideTT()}show(){setTimeout(this.showTT.bind(this),1e3)}getPageWidth(){const e=document.documentElement,t=document.body;return Math.max(t.scrollWidth,e.scrollWidth,t.offsetWidth,e.offsetWidth,t.clientWidth,e.clientWidth)}getPageHeight(){const e=document.documentElement,t=document.body;return Math.max(t.scrollHeight,e.scrollHeight,t.offsetHeight,e.offsetHeight,t.clientHeight,e.clientHeight)}constructor(e,t,i={}){this.el=e,this.text=t,this.hideDarkness=!0,this.oldColor=!1;var n;let o={autoShow:!1,noAutoHideOnWindowClick:null==(n=i.noAutoHideOnWindowClick)||n,content:t instanceof HTMLElement?t:`${t}`,cls:`feature_intro_tt tutorial_tip_tt ${(()=>{var e;const t=null!=(e=i.class)?e:"";return i.tooltipWhite?t:t+" feature_intro_blue_tt"})()}`,appendToParent:!0,onHide:this.ttOnHide.bind(this),scrollOffset:i.scrollOffset||0,align:i.align||s.ElementTooltip.ALIGN_CENTER};i.side&&(o.forceSide=i.side),i.offset&&(o.offset=i.offset),i.width&&(o.width=i.width),i.shift&&(o.centerShift=i.shift),i.border?this.border=i.border:this.border=[10,10,10,10],i.ttOnHide&&(o.onHide=i.ttOnHide),i.withCloseButton&&(o.withCloseButton=i.withCloseButton,o.onCloseButtonClick=i.onCloseButtonClick),i.align&&(o.align=i.align),this.ttParams=o,this.opts=i,this.initOnboardingBG()}}},956840:(e,t,i)=>{function n(e){const t=e.getBoundingClientRect();return t.top>=0&&t.left>=0&&t.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&t.right<=(window.innerWidth||document.documentElement.clientWidth)}i.d(t,{isElementInViewport:()=>n})},141312:(e,t,i)=>{i.d(t,{ANALYTICS_SCREEN_OTHER:()=>r,ANALYTICS_SCREEN_SETTINGS:()=>o,GroupAdminLevel:()=>n});const n={USER:0,MODERATOR:1,EDITOR:2,ADMINISTRATOR:3,HOST:4,EVENT_CREATOR:5,CREATOR:6,PSEUDO_LEVEL_ADVERTISER:100},o="settings",r="other"},199682:(e,t,i)=>{i.d(t,{ArticleTtsActionType:()=>n,articleTtsActionStatController:()=>r});var n,o=i(725927);!function(e){e.START="start",e.PAUSE="pause",e.CONTINUE="continue",e.SEEK="seek",e.CLOSE="close",e.P10="10p",e.P25="25p",e.P50="50p",e.P75="75p",e.P95="95p",e.P99="99p",e.P100="100p"}(n||(n={}));const r=new class{logEvent(e,t){const i={type:"type_marusia_reading_item",type_marusia_reading_item:e};this.actionStatCollector.logEvent(i,t)}constructor(){this.productStatCollector=new o.ProductionStatCollector,this.actionStatCollector=new o.ActionStatCollector(this.productStatCollector)}}},237415:(e,t,i)=>{i.d(t,{HIDE_TOOLTIP_TIMEOUT:()=>n,OPENED_REACTED_USERS_DEFAULT_REACTION_ID:()=>c,REACTION_ID_DEFAULT:()=>r,REACTION_ID_MAX:()=>a,REACTION_ID_MIN:()=>s,REACTION_ID_UNSET:()=>d,REACTION_SET_ITEMS_MIN_COUNT:()=>l,SHOW_TOOLTIP_TIMEOUT:()=>o});const n=600,o=140,r=0,a=7,s=0,d=void 0,l=2,c=r},414892:(e,t,i)=>{i.d(t,{isDebugEnabled:()=>r});var n=i(755909);let o;const r=()=>(void 0!==o||(o=!!n.ls.get("reactions.debug_enabled")),o)},635819:(e,t,i)=>{i.d(t,{reactionCountsBrandUnwrap:()=>o,reactionCountsBrandWrap:()=>r});var n=i(494045);const o=e=>(0,n.unwrap)(e),r=e=>(0,n.wrap)(e)},201144:(e,t,i)=>{i.d(t,{reactionLogError:()=>r});var n=i(661291);const o="reactions";function r({error:e,reportError:t=!1}){t&&(0,n.logError)(e,{environment:o}),console.error(e)}},428833:(e,t,i)=>{i.d(t,{areCountersEqual:()=>b,calcCounters:()=>T,calcCountersSum:()=>A,calcCountersWeightedSum:()=>S,counterForReactionId:()=>R,getDefaultReaction:()=>l,getDefaultReactionTitle:()=>c,getReaction:()=>d,hasReactionsForCounts:()=>f,isReactionIdSet:()=>u,isReactionIdUnset:()=>g,isUnknownObject:()=>s,isValidReactionId:()=>E,parseReactionId:()=>p,parseReactionIdOrUnset:()=>w,parseReactionMenuConfig:()=>m,prepareReactionMenuSet:()=>h,validateReactionSetPayloaditems:()=>I});var n=i(237415),o=i(635819),r=i(659397);const a=Number.isInteger||(e=>"number"==typeof e&&isFinite(e)&&Math.floor(e)===e),s=e=>null!==e&&"object"==typeof e,d=(e,t)=>e.itemsById[t],l=e=>d(e,n.REACTION_ID_DEFAULT),c=e=>{var t;return null==(t=l(e))?void 0:t.title},_=(e,t)=>0===e.length?"":((e,t,i=!0)=>e.reduce(((e,n)=>{const o=t(n),r=t(e);return r===o?i?e:n:r<o?e:n})))(e,(e=>Math.pow(t.width-e.width,2)+Math.pow(t.height-e.height,2)),!1).url,h=(e,t,i)=>{const n=t.map((({asset:e,color_sets:t,id:n,score:o,title:r})=>{var a,s;return{animationURL:e.animation_url||void 0,backgroundColor:null==(a=t)?void 0:a.background,id:n,imageMenuURL:_(e.images,i.imageMenuSize),imagePreviewURL:"imagePreviewSize"in i?_(e.images,i.imagePreviewSize):void 0,imageStoryPanelURL:"imageStoryPanelSize"in i?_(e.images,i.imageStoryPanelSize):void 0,imageStoryPreviewURL:"imageStoryPreviewSize"in i?_(e.images,i.imageStoryPreviewSize):void 0,score:o,title:r,titleColor:null==(s=t)?void 0:s.foreground}})),o={};return n.forEach((e=>{o[e.id]=e})),{id:e,items:n,itemsById:o}},u=e=>e!==n.REACTION_ID_UNSET,g=e=>e===n.REACTION_ID_UNSET,E=e=>a(e)&&e>=n.REACTION_ID_MIN&&e<=n.REACTION_ID_MAX,p=e=>{const t=parseInt(e,10);return E(t)?{isValid:!0,value:t}:{isValid:!1}},w=e=>{const t=p(e);return t.isValid?t.value:n.REACTION_ID_UNSET},I=(e,t)=>{if(e.length<n.REACTION_SET_ITEMS_MIN_COUNT)return{error:new Error(`Invalid reactions items count in set '${t}': ${e.length}`)}},m=e=>{if(!s(e))return;const t={},{animationShowStaticAfterEnd:i,menuShowDelay:o,openedDefaultReactionId:r,reportJsErrors:a}=e;return"number"!=typeof o&&void 0!==o||(t.menuShowDelay=o),"boolean"==typeof i&&(t.animationShowStaticAfterEnd=i),"boolean"==typeof a&&(t.reportJsErrors=a),"number"==typeof r||null===r?null===r?t.openedDefaultReactionId=void 0:E(r)&&(t.openedDefaultReactionId=r):t.openedDefaultReactionId=n.OPENED_REACTED_USERS_DEFAULT_REACTION_ID,t},T=(e,t)=>{const i=(0,o.reactionCountsBrandWrap)({});return Object.entries((0,o.reactionCountsBrandUnwrap)(e)).forEach((([e,n])=>{var o,r,a;const s=e;var d;const l=null!=(d=null==(a=t)||null==(r=a.itemsById)||null==(o=r[s])?void 0:o.score)?d:1;i[s]=l*(n||0)})),i},A=e=>Object.values((0,o.reactionCountsBrandUnwrap)(e)).reduce(((e,t)=>e+(t||0)),0),S=e=>A((0,o.reactionCountsBrandWrap)(e)),f=e=>A(e)>0;var v;const R=(e,t)=>null!=(v=e[t])?v:void 0,b=(e,t)=>e&&t?(0,r.isEqual)(e,t):e===t},494045:(e,t,i)=>{i.d(t,{unwrap:()=>n,wrap:()=>o});const n=e=>e,o=e=>e},604195:(e,t,i)=>{i.d(t,{DEFAULT_CACHE:()=>d,ORDER_ERRORS:()=>c,ORDER_ITEM_ERRORS:()=>_,SAMPLE_RECIPIENT_ID:()=>l,STICKER_ANIMATION:()=>s,STICKER_IMAGE:()=>a,STICKER_PACK_ICON:()=>o,STICKER_PACK_THUMB:()=>r});var n=i(82530);const o={square_png:{id:"square.png",width:104,height:104},square_15x_png:{id:"square_1.5x.png",width:156,height:156},square_2x_png:{id:"square_2x.png",width:208,height:208},square_3x_png:{id:"square_3x.png",width:312,height:312},square_4x_png:{id:"square_4x.png",width:416,height:416}},r={"102_png":{id:"102.png",width:102,height:102,theme:n.Theme.LIGHT},"51_png":{id:"51.png",width:51,height:51,theme:n.Theme.LIGHT},"68_png":{id:"68.png",width:68,height:68,theme:n.Theme.LIGHT},"34_png":{id:"34.png",width:34,height:34,theme:n.Theme.LIGHT},"60_png":{id:"60.png",width:60,height:60,theme:n.Theme.LIGHT},"30_png":{id:"30.png",width:30,height:30,theme:n.Theme.LIGHT},"102b_png":{id:"102b.png",width:102,height:102,theme:n.Theme.DARK},"51b_png":{id:"51b.png",width:51,height:51,theme:n.Theme.DARK},"68b_png":{id:"68b.png",width:68,height:68,theme:n.Theme.DARK},"34b_png":{id:"34b.png",width:34,height:34,theme:n.Theme.DARK},"60b_png":{id:"60b.png",width:60,height:60,theme:n.Theme.DARK},"30b_png":{id:"30b.png",width:30,height:30,theme:n.Theme.DARK},"44_png":{id:"44.png",width:44,height:44},"22_png":{id:"22.png",width:22,height:22}},a={"64_png":{id:"64.png",width:64,height:64,theme:n.Theme.LIGHT},"128_png":{id:"128.png",width:128,height:128,theme:n.Theme.LIGHT},"256_png":{id:"256.png",width:256,height:256,theme:n.Theme.LIGHT},"352_png":{id:"352.png",width:352,height:352,theme:n.Theme.LIGHT},"512_png":{id:"512.png",width:512,height:512,theme:n.Theme.LIGHT},"64b_png":{id:"64b.png",width:64,height:64,theme:n.Theme.DARK},"128b_png":{id:"128b.png",width:128,height:128,theme:n.Theme.DARK},"256b_png":{id:"256b.png",width:256,height:256,theme:n.Theme.DARK},"352b_png":{id:"352b.png",width:352,height:352,theme:n.Theme.DARK},"512b_png":{id:"512b.png",width:512,height:512,theme:n.Theme.DARK}},s={[n.Theme.LIGHT]:"animation.json",[n.Theme.DARK]:"animation.b.json"},d={products:(0,n.createProductsMap)([]),productIdsQueue:new Set,productsPromise:void 0,productPromises:new Map,stickers:new Map},l=-1;var c,_;!function(e){e.NOT_SIGNED_IN="not_signed_in",e.NO_VALID_ITEMS="no_valid_items"}(c||(c={})),function(e){e.DUPLICATE_PRODUCT="duplicate_product"}(_||(_={}))},82530:(e,t,i)=>{var n;i.d(t,{ProductsByType:()=>h,Theme:()=>n,UserProductStateKey:()=>s,createProductsMap:()=>a,imageSizeCache:()=>r,imageSizesIndex:()=>o,isBasePack:()=>d,isPackProduct:()=>c,isStyleProduct:()=>l}),function(e){e.LIGHT="light",e.DARK="dark",e.DEFAULT="light"}(n||(n={}));const o=Symbol(),r=Symbol(),a=e=>new Map(e);var s;!function(e){e.IsNew="is_new"}(s||(s={}));const d=e=>void 0!==e.sticker_ids,l=e=>void 0!==e.base_id,c=e=>d(e)&&!l(e);var _;!function(e){e.Pack="pack",e.Style="style"}(_||(_={}));class h{add(e){e&&(c(e)?this.pack.add(e):l(e)&&this.style.add(e))}getPack(){return this.pack.values().next().value}getStyles(){return Array.from(this.style.values())}getCount(){return this.pack.size+this.style.size}constructor(e=[]){this.pack=new Set,this.style=new Set,e.forEach((e=>this.add(e)))}}},673153:(e,t,i)=>{i.d(t,{getStickerAnimationUrl:()=>c,getStickerImageUrl:()=>l,getStickerPackIconUrl:()=>_,isSampleOrderItem:()=>h,logStickersError:()=>u});var n=i(82530),o=i(604195),r=i(661291);const a=(e,t,i,o=n.Theme.DEFAULT)=>{const r=window.devicePixelRatio,a=[t*=r,i*=r,o].toString();let s=e[n.imageSizeCache];if(s&&s.has(a)){const e=s.get(a);if(e)return e}s||(s=new Map,e[n.imageSizeCache]=s);const d=(e=>{let t=e[n.imageSizesIndex];return t||(t=Object.values(e).sort(((e,t)=>e.width-t.width||e.height-t.height)),e[n.imageSizesIndex]=t),t})(e).filter((e=>!e.theme||e.theme===o)),l=d.find((e=>e.width>=t&&e.height>=i))||d[d.length-1];return s.set(a,l),l},s=(e,t,i=n.Theme.DEFAULT)=>a(o.STICKER_IMAGE,e,t,i),d=(e,t)=>e.image.base_url+"/"+t.id+(e.image.version?`?${e.image.version}`:"");function l(e,t,i,o=n.Theme.DEFAULT){var r;if(null==(r=e.render)?void 0:r.images){const{images:n}=e.render;let r;n.sort(((e,t)=>e.width-t.width||e.height-t.height));for(const e of n)if(e.width>=t&&e.height>=i){if(e.theme===o)return e.url;r=e}if(r)return r.url}return d(e,s(t,i,o))}const c=(e,t=n.Theme.DEFAULT)=>e.animation?e.animation.base_url+"/"+o.STICKER_ANIMATION[t]+(e.animation.version?`?${e.animation.version}`:""):"",_=(e,t,i,r=n.Theme.DEFAULT)=>((e,t)=>e.icon.base_url+"/"+t.id+(e.thumb.version?`?${e.thumb.version}`:""))(e,((e,t,i=n.Theme.DEFAULT)=>a(o.STICKER_PACK_ICON,e,t,i))(t,i,r)),h=e=>e.recipient_id===o.SAMPLE_RECIPIENT_ID,u=e=>{(0,r.logError)(new Error(`Stickers: ${e}`),{environment:"stickers"})}},131158:(e,t,i)=>{i.d(t,{BADGES_BOX_WIDTH:()=>n,BADGES_RESTRICTED_CLASS_SELECTOR_FOR_POST:()=>I,BADGE_COMMENT_SELECTOR:()=>l,BADGE_IMAGE_SIZE_100:()=>u,BADGE_IMAGE_SIZE_128:()=>h,BADGE_IMAGE_SIZE_20:()=>w,BADGE_IMAGE_SIZE_28:()=>p,BADGE_IMAGE_SIZE_64:()=>E,BADGE_IMAGE_SIZE_96:()=>g,BadgesEventName:()=>s,BadgesEventRef:()=>a,BadgesObjectType:()=>d,DONUT_BADGE_ID:()=>_,ERRORS:()=>r,LINK_TO_HELP_FOR_AUTHORS:()=>o,LoadingStatus:()=>c});const n=640,o="/@authors-badges";var r;!function(e){e[e.ERROR_PARAM=100]="ERROR_PARAM",e[e.NEED_CONFIRMATION=24]="NEED_CONFIRMATION",e[e.BALANCE=504]="BALANCE"}(r||(r={}));const a={TAB:"tab",SENDER_LIST:"sender_list",POST_BTN:"post_btn",COLLECTION_BLOCK:"collection_block",COLLECTON_ALL:"collecton_all",NOTIFICATION:"notification",PUSH:"push",PIN:"pin",COMMENT_IMG:"comment_img",COMMENT_LINK:"comment_link",PROFILE_DETAILS:"profile_details"},s={OPEN_BADGE:"open_badge",OPEN_BADGES_ALL:"open_badges_all"};var d;!function(e){e[e.WALL=11]="WALL"}(d||(d={}));const l="BadgeComment";var c;!function(e){e[e.pending=0]="pending",e[e.loaded=1]="loaded",e[e.failed=2]="failed"}(c||(c={}));const _=38,h=128,u=100,g=96,E=64,p=28,w=20,I="post--badgesRestricted"},774503:(e,t,i)=>{i.d(t,{generateLatinizedName:()=>_,isPublishNameCorrect:()=>d,updateArticleSnippetsFromQueueByPost:()=>s});i(11010);var n=i(661291),o=i(577686),r=i(414126);i(673056),i(168578),i(519555),i(581595),i(971858),i(161371),i(977041),i(764646);const a="article_snippet";function s(e){if(!window.vk.id)return;if(!(0,r.partConfigEnabled)("update_private_snippets_by_queue"))return;const t=Array.from(e.querySelectorAll(`.${a}`));if(!t.length)return;const i=[];t.forEach((e=>{if(!window.vk.id||!e.dataset.needUpdate)return;const t=e.dataset.articleRawId;t&&i.push({article_raw_id:t,post_raw_id:e.dataset.postId,is_mini_snippet:(0,o.intval)(e.dataset.isMiniSnippet)})})),i.length&&window.ajax.post("al_articles.php",{act:"get_snippets",article_snippets:JSON.stringify(i)},{onDone:e=>{t.forEach((t=>{t.dataset.articleRawId&&e[t.dataset.articleRawId]&&(t.outerHTML=e[t.dataset.articleRawId])}))},onFail:()=>((0,n.logError)(new Error("Fail: updateArticleSnippetsFromQueueByPost")),!0)})}function d(e){return!!/^[a-z0-9\-]+$/.test(e)&&(!e.includes("--")&&(!e.startsWith("-")&&!e.endsWith("-")&&!(e.length>60)))}const l=[{to:"a",from:"[ÀÁÂÃÄÅÆĀĂĄẠẢẤẦẨẪẬẮẰẲẴẶ]"},{to:"c",from:"[ÇĆĈČ]"},{to:"d",from:"[ÐĎĐÞ]"},{to:"e",from:"[ÈÉÊËĒĔĖĘĚẸẺẼẾỀỂỄỆ]"},{to:"g",from:"[ĜĞĢǴ]"},{to:"h",from:"[ĤḦ]"},{to:"i",from:"[ÌÍÎÏĨĪĮİỈỊ]"},{to:"j",from:"[Ĵ]"},{to:"ij",from:"[Ĳ]"},{to:"k",from:"[Ķ]"},{to:"l",from:"[ĹĻĽŁ]"},{to:"m",from:"[Ḿ]"},{to:"n",from:"[ÑŃŅŇ]"},{to:"o",from:"[ÒÓÔÕÖØŌŎŐỌỎỐỒỔỖỘỚỜỞỠỢǪǬƠ]"},{to:"oe",from:"[Œ]"},{to:"p",from:"[ṕ]"},{to:"r",from:"[ŔŖŘ]"},{to:"s",from:"[ßŚŜŞŠ]"},{to:"t",from:"[ŢŤ]"},{to:"u",from:"[ÙÚÛÜŨŪŬŮŰŲỤỦỨỪỬỮỰƯ]"},{to:"w",from:"[ẂŴẀẄ]"},{to:"x",from:"[ẍ]"},{to:"y",from:"[ÝŶŸỲỴỶỸ]"},{to:"z",from:"[ŹŻŽ]"}],c={1072:"a",1073:"b",1074:"v",1075:"g",1076:"d",1077:"e",1105:"e",1078:"zh",1079:"z",1080:"i",1081:"i",1082:"k",1083:"l",1084:"m",1085:"n",1086:"o",1087:"p",1088:"r",1089:"s",1090:"t",1091:"u",1092:"f",1093:"h",1094:"c",1095:"ch",1096:"sh",1097:"sch",1099:"y",1101:"e",1102:"u",1103:"ya"};function _(e,t){e=e.toLowerCase();let i="",n=!1;const o="-qwertyuiopasdfghjklzxcvbnm0123456789".split("");l.forEach((t=>{e=e.replace(new RegExp(t.from,"gi"),t.to)}));for(let t=0;t<e.length;t++)if(/\s/.test(e[t]))n||(i+="-",n=!0);else if(o.includes(e[t]))i+=e[t],n=!1;else{let o=c[e.charCodeAt(t)];o&&(i+=o,n=!1)}return i=i.substr(0,t),i=i.replace(/-*$/,"").replace(/^-*/,"").replace(/-+/g,"-"),i}},531388:(e,t,i)=>{i.d(t,{highlightModule:()=>c});var n=i(710970),o=i(584841),r=i(314502),a=i(538248),s=i(448180);let d,l;function c(e){const t=document.getElementById(e.module);if(!t||!t.classList.contains("module"))return;window.cur.__narrowBarForceNotFixed=!0;const i=e.speed?e.speed:300;(0,r.scrollToY)((0,a.getXY)(t)[1]-100,i);const c=()=>{d&&(d.hideTT(),(0,r.enableBodyScroll)(),delete window.cur.__narrowBarForceNotFixed,(0,o.updateNarrow)(),e.onClose&&e.onClose())};d=new n.default(t,e.text,{highlight:!0,width:250,offset:[0,-17],side:"bottom",withCloseButton:!0,onBGClick:c,onCloseButtonClick:c}),d.show(),(0,r.disableBodyScroll)(),e.autoCancelDelay&&(l=setTimeout((()=>{c(),l=null}),e.autoCancelDelay),(0,s.pushNavDestroy)((()=>{l&&clearTimeout(l)})))}},953807:(e,t,i)=>{i.d(t,{PROFILE_MEDIA_NARROW_BLOCK_ID:()=>n});const n="profile_media_narrow_block"},672101:(e,t,i)=>{i.d(t,{REACTIONS_COUNTS_RESPONSE_FIELD:()=>d,SIZE_128:()=>s,SIZE_32:()=>o,SIZE_40:()=>r,SIZE_96:()=>a,SUPPORTED_OBJECT_TYPES:()=>n,WK_SECTION_PREFIX_REACTIONS:()=>l});const n={wall:"wall",wall_reply:"wall_reply"},o={width:32,height:32},r={width:40,height:40},a={width:96,height:96},s={width:128,height:128},d="reactions_counts",l="reactions"},563670:(e,t,i)=>{i.d(t,{ENABLED_IN_POST_REPLY:()=>o,isDebugEnabled:()=>n.isDebugEnabled});var n=i(414892);const o=!1},580446:(e,t,i)=>{i.d(t,{reactionLogError:()=>r});var n=i(201144),o=i(312766);const r=({error:e})=>{var t;var i;const r=null!=(i=null==(t=(0,o.getReactionConfig)())?void 0:t.reportJsErrors)&&i;(0,n.reactionLogError)({error:e,reportError:r})}},312766:(e,t,i)=>{i.d(t,{getReactionConfig:()=>E,getReactionSet:()=>u,storageAddSets:()=>h,storageSetConfig:()=>g});var n=i(434788),o=i(659397),r=i(428833),a=i(83414),s=i(580446),d=i(672101),l=i(563670);const c=(0,a.makeSharedState)("reactions-storage",(()=>new Map),{version:0}),_=(0,a.makeSharedState)("reactions-config",(()=>({config:void 0})),{version:0}),h=e=>{(0,l.isDebugEnabled)()&&console.log(e),Object.entries(e).forEach((([e,t])=>{const i=(0,r.validateReactionSetPayloaditems)(t,e);if(i)return void(0,s.reactionLogError)({error:i.error});const a=t.map((e=>(0,n._)({},e,{title:(0,o.decodeHTMLEntities)(e.title)})));c().set(e,(0,r.prepareReactionMenuSet)(e,a,{imageMenuSize:d.SIZE_96,imagePreviewSize:d.SIZE_32,imageStoryPanelSize:d.SIZE_128,imageStoryPreviewSize:d.SIZE_40}))}))},u=e=>{const t=c().get(e);if(t)return t;{const t=new Error(`Reaction set not found: ${e}`);(0,s.reactionLogError)({error:t})}},g=e=>{(0,l.isDebugEnabled)()&&console.log(e);const t=(0,r.parseReactionMenuConfig)(e);t?_().config=t:console.warn("Reactions: invalid menu config passed",e)},E=()=>{var e;return null==(e=_())?void 0:e.config}},299526:(e,t,i)=>{i.d(t,{getReactionsButtonPostTemplate:()=>u,getReactionsButtonReplyTemplate:()=>g,likeDataReactionsFields:()=>w});var n=i(414126),o=i(538248),r=i(672101),a=i(312766),s=i(428833),d=i(635819),l=i(131158);const c=(e,t,i)=>{var n,r,d;const c=null==(n=(e=>{try{const t=JSON.parse(e);if(null!==t&&"object"!=typeof t)return;return t}catch(e){return}})(e))?void 0:n.set_id,_="string"==typeof c?c:void 0;if(!t||!_)return;const h=(0,a.getReactionSet)(_);return h?{likeClassName:"like_btn--hidden PostBottomAction--hidden",template:(0,o.rs)(t,{reactions_button_title:(0,s.getDefaultReactionTitle)(h)||"",reactions_set_id:_,badges_object_type:l.BadgesObjectType.WALL,badges_object_owner_id:(null==(r=i)?void 0:r.objectOwnerId)||0,badges_object_id:(null==(d=i)?void 0:d.objectId)||0,badges_ref:l.BadgesEventRef.POST_BTN})}:void 0},_=(e,t)=>t.length>e,h=e=>{const t=e[2],[i,n]=t.split("_");return{objectOwnerId:Number(i),objectId:Number(n)}},u=(e,t)=>{var i,n;const o=h(e),r=null==(n=t)||null==(i=n.wallTpl)?void 0:i.post_likes_reactions,a=_(14,e)?e[14]:void 0;if("string"==typeof a)return c(a,r,o)},g=(e,t)=>{var i,o;const r=h(e),a=null==(o=t)||null==(i=o.wallTpl)?void 0:i.reply_likes_reactions;if(!(0,n.partConfigEnabled)("reactions_enabled_post_replies"))return;const s=_(14,e)?e[14]:void 0;return"string"==typeof s?c(s,a,r):void 0},E=e=>{let t=JSON.parse(e);if(null===t||"object"==typeof t||Array.isArray(t)){if(Array.isArray(t)){t=(0,d.reactionCountsBrandWrap)((i=t,Object.assign({},i)))}var i;return t}},p=e=>{const t=_(5,e)?e[5]:void 0;if("string"!=typeof t)return;const i=(e=>{const t=e.indexOf(";"),i=e.substr(0,t),n=e.substr(t+1);if("1"===i)return E(n)})(t);return i?{counts:i}:void 0},w=e=>{var t;const i=p(e);return{[r.REACTIONS_COUNTS_RESPONSE_FIELD]:null==(t=i)?void 0:t.counts}}},47928:(e,t,i)=>{var n;i.d(t,{REGULAR_SIZES:()=>r,SIZE_512:()=>o,STICKER_ROW_CLASS:()=>a,StickerSize:()=>n}),function(e){e[e.SMALL=128]="SMALL",e[e.MIDDLE=168]="MIDDLE",e[e.BIG=208]="BIG"}(n||(n={}));const o=512,r=[64,128,256,352,o],a="sticker_row"},207656:(e,t,i)=>{i.d(t,{findClosestStickerSize:()=>I,getBoxLayerWrap:()=>h,getLangCode:()=>w,getPurchaseResult:()=>E,hideLoader:()=>g,showLoader:()=>u,updateStickersFromQueue:()=>p});var n=i(313979),o=i(764646),r=i(136633),a=i(538248),s=i(214266),d=i(82530),l=i(47928),c=i(673153);function _(){return document.querySelector("#box_loader")}function h(){return document.querySelector("#box_layer_wrap")}function u(){const e=_();(0,s.refreshBoxLoaderCoords)(),(0,a.show)(e),(0,a.show)(h())}function g(){(0,a.hide)(_())}function E(e){const t=new d.ProductsByType(e.items.filter((e=>!e.error)).map((e=>e.product))),i=t.getPack(),r=t.getStyles();if(i)return r.length?(0,n.langStr)(o.getLang("purchases_stickers_purchase_result_pack_and_styles",r.length),"pack_title",i.title,"n",r.length):(0,n.langStr)(o.getLang("purchases_stickers_purchase_result_pack"),"title",i.title);if(r.length)switch(r.length){case 1:return(0,n.langStr)(o.getLang("purchases_stickers_purchase_result_1_style"),"title",r[0].title);case 2:return(0,n.langStr)(o.getLang("purchases_stickers_purchase_result_2_styles"),"title1",r[0].title,"title2",r[1].title);case 3:return(0,n.langStr)(o.getLang("purchases_stickers_purchase_result_3_styles"),"title1",r[0].title,"title2",r[1].title,"title3",r[2].title);case 4:return(0,n.langStr)(o.getLang("purchases_stickers_purchase_result_3_styles_and_1_more"),"title1",r[0].title,"title2",r[1].title,"title3",r[2].title);default:const e=r.length-3;return(0,n.langStr)(o.getLang("purchases_stickers_purchase_result_3_styles_and_n_more",e),"title1",r[0].title,"title2",r[1].title,"title3",r[2].title,"n",e)}return null}function p(e){!function(e){const t=r.colorScheme.isDarkScheme()?"data-src-dark":"data-src-light";e.querySelectorAll(`.sticker_img[${t}]`).forEach((e=>{const i=e.getAttribute(t);i&&(e.src=i)}))}(e)}const w=()=>window.vk.lang||"ru",I=e=>e>l.SIZE_512?((0,c.logStickersError)("Нет размера стикера больше 512px"),l.SIZE_512):l.REGULAR_SIZES.find((t=>t>=e))},586210:(e,t,i)=>{i.d(t,{highlightNarrativeBlock:()=>p,prepareStoriesForPublishing:()=>g,updateNarrativeBlock:()=>E,updateNarrativeSnippetsFromQueueByPost:()=>w});var n=i(538248),o=i(214266),r=i(531388),a=i(764646),s=i(577686),d=i(953807),l=i(162350),c=i(661291),_=i(414126),h=i(547142);const u="NarrativeSnippet";function g(e){return e.map((e=>e.id)).join(",")}function E(e=!1){const t=(0,s.intval)(window.cur.oid);if(window.cur.narrativeBlock)window.ajax.post("al_stories.php",{act:"get_narrative_block",owner_id:t},{onDone:e=>{const t=(0,s.intval)(window.cur.oid),i=document.getElementById(`narratives_module${t}_wrapper`);if(i)if(e)(0,n.domReplaceEl)(i,e),window.cur.narrativeBlock&&window.cur.narrativeBlock.destroy(),window.NarrativeBlock&&(window.cur.narrativeBlock=new window.NarrativeBlock);else{var o,r;const e=i.parentElement;var a;if((null==(o=e)?void 0:o.children.length)&&(null==(r=e)?void 0:r.children.length)>1)i.remove();else null==(a=e)||a.remove();window.cur.narrativeBlock&&window.cur.narrativeBlock.destroy(),delete window.cur.narrativeBlock}(0,l.removeStoryList)(`narratives${t}`)}});else if(h.Ranges.isUserId(t)&&"profile"===window.cur.module){const e=document.getElementById(d.PROFILE_MEDIA_NARROW_BLOCK_ID),i=!e;window.ajax.post("al_stories.php",{act:"get_narrative_block",owner_id:t,need_wrap_block:(0,s.intval)(i)},{onDone:i=>{if(e)e.insertAdjacentHTML("afterbegin",i);else{const e=document.getElementById("narrow_column");if(!e)return;e.insertAdjacentHTML("beforeend",i)}window.cur.narrativeBlock&&window.cur.narrativeBlock.destroy(),window.NarrativeBlock&&(window.cur.narrativeBlock=new window.NarrativeBlock,window.cur.narrativeBlock.showOnboardTooltipIfNeeded()),(0,l.removeStoryList)(`narratives${t}`)}})}else e&&function(e){window.boxQueue.hideAll();const t=document.querySelector("#box_layer_wrap"),i=document.querySelector("#box_loader");window.nav.reload({onDone:()=>{e&&e()},showProgress:()=>{(0,n.show)(t),(0,n.show)(i),(0,o.refreshBoxLoaderCoords)()},hideProgress:()=>{(0,n.hide)(t),(0,n.hide)(i)}})}((()=>{window.cur.needNarrativeOnboard=!0}))}function p(e){if(!e)return;const t=`narratives_module${window.vk.id}`;(0,r.highlightModule)({module:t,text:a.getLang("stories_narrative_block_onboarding_text"),onClose:()=>{delete window.cur.needNarrativeOnboard,window.ajax.post("al_index.php",{act:"hide_feature_tt",hash:e,type:"profile_narrative"})},autoCancelDelay:1e4,speed:600})}function w(e){if(!window.vk.id)return;if(!(0,_.partConfigEnabled)("update_private_snippets_by_queue"))return;const t=Array.from(e.querySelectorAll(`.${u}`));if(!t.length)return;const i=[];t.forEach((e=>{if(!window.vk.id||!e.dataset.needUpdate)return;const t=e.dataset.narrativeRawId;t&&i.push({narrative_raw_id:t,snippet_type:e.dataset.snippetType,from:e.dataset.from})})),i.length&&window.ajax.post("al_stories.php",{act:"get_narrative_snippets",narrative_snippets:JSON.stringify(i)},{onDone:e=>{t.forEach((t=>{t.dataset.narrativeRawId&&e[t.dataset.narrativeRawId]&&(t.outerHTML=e[t.dataset.narrativeRawId])}))},onFail:()=>((0,c.logError)(new Error("Fail: updateNarrativeSnippetFromQueueByPost")),!0)})}},233434:(e,t,i)=>{i.d(t,{highlightUpdatedPost:()=>o,highlightUpdatedPostContent:()=>r});var n=i(948578);const o=e=>{(0,n.triggerAnimationClass)(e,"post_highlight_updated",3e3)},r=e=>{(0,n.triggerAnimationClass)(e,"post_highlight_updated_content",3e3)}},537811:(e,t,i)=>{i.d(t,{getFixedReplyField:()=>r,initCommentsHandlers:()=>s,replyBoxOwnerIsNftFromAttr:()=>a});var n=i(581378),o=i(651460);const r=()=>{var e,t;return window.cur.wallLayer?null!=(e=document.getElementById("wl_reply_form"))?e:void 0:"full"===window.cur.wallType&&null!=(t=document.querySelector(`#reply_box_wrap${window.cur.oid}_${window.cur.pid} .reply_box_inner_wrap`))?t:void 0},a=e=>"1"===e;function s(){(0,n.tq)().setInteractiveHandler("PostBottomAction/comment",(e=>{var t,i;const n=e.payload.target;if(!n)return;const r=(0,o.getPostElemByChildEl)(n),a=null==(t=r)?void 0:t.getAttribute("data-post-id");if(!a)return;!function(e,t){const i=e.match(/^(-?\d+)_(wall)?(\d+)$/);if(!i)return;const n=`wall${i[1]}_${i[3]}`;window.Wall.postFull(n,!1,{isPostCommentsDisabled:t.isPostCommentsDisabled})}(a,{isPostCommentsDisabled:"true"===(null==(i=r)?void 0:i.getAttribute("data-post-comments-disabled"))})}))}},971858:(e,t,i)=>{e.exports=i.p+"icons/d7ccdb168db391d6a891.png"}}]);try{stManager.done("dist/web/chunks/429e74a8.42b133d3.js")}catch(e){}